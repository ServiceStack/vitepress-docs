import{_ as a,r as t,c as e,b as p,d as o,a as n,o as c}from"./app.14440598.js";const b='{"title":"Routing","description":"","frontmatter":{"slug":"routing","title":"Routing"},"headers":[{"level":2,"title":"Pre-defined Routes","slug":"pre-defined-routes"},{"level":3,"title":"SOAP Web Service urls","slug":"soap-web-service-urls"},{"level":2,"title":"Custom Routes","slug":"custom-routes"},{"level":3,"title":"Variable place-holders","slug":"variable-place-holders"},{"level":3,"title":"Wildcard paths","slug":"wildcard-paths"},{"level":3,"title":"Fallback Route","slug":"fallback-route"},{"level":3,"title":"Limiting to HTTP Verbs","slug":"limiting-to-http-verbs"},{"level":3,"title":"Matching ignored paths","slug":"matching-ignored-paths"},{"level":3,"title":"Fluent API","slug":"fluent-api"},{"level":2,"title":"Content Negotiation","slug":"content-negotiation"},{"level":3,"title":"Simulate alternative HTTP Methods","slug":"simulate-alternative-http-methods"},{"level":3,"title":"Custom Rules","slug":"custom-rules"},{"level":3,"title":"HTTP Verb Interface Markers","slug":"http-verb-interface-markers"},{"level":2,"title":"Auto Route Generation Strategies","slug":"auto-route-generation-strategies"},{"level":3,"title":"Dynamically adding Route Attributes","slug":"dynamically-adding-route-attributes"},{"level":3,"title":"Customizing Defined Routes","slug":"customizing-defined-routes"},{"level":3,"title":"Uploading Files","slug":"uploading-files"},{"level":3,"title":"Reading directly from the Request Stream","slug":"reading-directly-from-the-request-stream"},{"level":3,"title":"Pluralize and Singularize","slug":"pluralize-and-singularize"},{"level":2,"title":"Routing Resolution Order","slug":"routing-resolution-order"},{"level":3,"title":"Route weighting example","slug":"route-weighting-example"},{"level":3,"title":"Content-Type Specific Service Implementations","slug":"content-type-specific-service-implementations"},{"level":3,"title":"Reverse Routing","slug":"reverse-routing"},{"level":3,"title":"Populating Complex Type Properties on QueryString","slug":"populating-complex-type-properties-on-querystring"},{"level":3,"title":"Customize urls used with IUrlFilter","slug":"customize-urls-used-with-iurlfilter"},{"level":2,"title":"Routing Metadata","slug":"routing-metadata"},{"level":3,"title":"Great Performance","slug":"great-performance"},{"level":3,"title":"Consider \\"pretty-urls\\" for public pages","slug":"consider-pretty-urls-for-public-pages"}],"relativePath":"routing.md","lastUpdated":1634495308446}',l={},u=n(`__VP_STATIC_START__<h2 id="pre-defined-routes" tabindex="-1">Pre-defined Routes <a class="header-anchor" href="#pre-defined-routes" aria-hidden="true">#</a></h2><p>Without any configuration required, ServiceStack already includes <a href="/routing.html#pre-defined-routes">pre-defined routes</a> for all services in the format:</p><pre><code>/api?/[xml|json|html|jsv|csv]/[reply|oneway]/[servicename]
</code></pre><blockquote><p>servicename is the name of the Request DTO</p></blockquote><p>e.g. the pre-defined url to call a JSON &#39;Hello&#39; Service is:</p><div class="language-"><pre><code>/json/reply/hello
</code></pre></div><h4 id="auto-batched-requests" tabindex="-1"><a href="/auto-batched-requests.html">Auto Batched Requests</a> <a class="header-anchor" href="#auto-batched-requests" aria-hidden="true">#</a></h4><div class="language-"><pre><code>/json/reply/Hello[]
</code></pre></div><h3 id="soap-web-service-urls" tabindex="-1">SOAP Web Service urls <a class="header-anchor" href="#soap-web-service-urls" aria-hidden="true">#</a></h3><div class="language-"><pre><code>/api?/[soap11|soap12]
</code></pre></div><h2 id="custom-routes" tabindex="-1">Custom Routes <a class="header-anchor" href="#custom-routes" aria-hidden="true">#</a></h2><p>In its most basic form, a Route is just any string literal attributed on your Request DTO:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><p>which matches:</p><div class="language-"><pre><code>/hello
/hello?Name=XXX
</code></pre></div><h3 id="variable-place-holders" tabindex="-1">Variable place-holders <a class="header-anchor" href="#variable-place-holders" aria-hidden="true">#</a></h3><p>Routes can also have variable place-holders:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/hello/{Name}&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
</code></pre></div><p>matches:</p><div class="language-"><pre><code>/hello/foo
</code></pre></div><p>And will populate the public property <strong>Name</strong> on the Request DTO with <strong>foo</strong>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The QueryString, FormData and HTTP Request Body isn&#39;t apart of the Route (i.e. only the /path/info is) but they can all be used in addition to every web service call to further populate the Request DTO.</p></div><h3 id="wildcard-paths" tabindex="-1">Wildcard paths <a class="header-anchor" href="#wildcard-paths" aria-hidden="true">#</a></h3><p>Using a route with a wild card path like:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/hello/{Name*}&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
</code></pre></div><p>matches any number of variable paths:</p><div class="language-"><pre><code>/hello
/hello/name
/hello/my/name/is/ServiceStack    //Name = my/name/is/ServiceStack
</code></pre></div><p><a href="http://stackoverflow.com/questions/7780157/multiple-optional-parameters-with-servicestack-net" target="_blank" rel="noopener noreferrer">Another good use-case for when to use wildcard routes</a>.</p><h3 id="fallback-route" tabindex="-1">Fallback Route <a class="header-anchor" href="#fallback-route" aria-hidden="true">#</a></h3><p>Use the <code>FallbackRoute</code> attribute to specify a fallback route starting from the root path, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FallbackRoute</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/{Path}&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Fallback</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Path <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This will match any unmatched route from the root path (e.g. <code>/foo</code> but not <code>/foo/bar</code>) that&#39;s not handled by CatchAll Handler or matches a static file. You can also specify a wildcard path e.g. <code>[FallbackRoute(&quot;/{Path*}&quot;)]</code> which will handle every unmatched route (inc. <code>/foo/bar</code>). Only 1 fallback route is allowed.</p><p>The Fallback route is useful for HTML5 Single Page App websites handling server requests of HTML5 pushState pretty urls, e.g. All <a href="/templates-single-page-apps.html">Single Page Apps Templates</a> use the <code>[FallbackRoute]</code> to return the home page for all HTML Requests that do not have Server Routes, e.g <a href="https://github.com/NetCoreTemplates/vue-spa/blob/master/MyApp.ServiceInterface/MyServices.cs" target="_blank" rel="noopener noreferrer">MyServices.cs</a>:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FallbackRoute</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/{PathInfo*}&quot;</span><span class="token punctuation">,</span> Matches<span class="token operator">=</span><span class="token string">&quot;AcceptsHtml&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FallbackForClientRoutes</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> PathInfo <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServices</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">//Return index.html for unmatched requests so routing is handled on client</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token class-name">FallbackForClientRoutes</span> request<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Request<span class="token punctuation">.</span><span class="token function">GetPageResult</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Which will returns the the default <code>index.html</code> page using <a href="https://sharpscript.net/docs/sharp-pages" target="_blank" rel="noopener noreferrer">#Script Pages</a>.</p><h4 id="spa-fallback" tabindex="-1">SPA Fallback <a class="header-anchor" href="#spa-fallback" aria-hidden="true">#</a></h4><p>This popular behavior is also available using the more convenient configuration (used in all <a href="/dotnet-new.html">SPA Project Templates</a>) with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SharpPagesFeature</span> <span class="token punctuation">{</span>
    EnableSpaFallback <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><h4 id="other-fallback-examples" tabindex="-1">Other Fallback Examples <a class="header-anchor" href="#other-fallback-examples" aria-hidden="true">#</a></h4><p>Examples of other HTML Fallback Response:</p><div class="language-csharp"><pre><code><span class="token comment">//Return static HTML file</span>
<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HttpResult</span><span class="token punctuation">(</span>VirtualFileSources<span class="token punctuation">.</span><span class="token function">GetFile</span><span class="token punctuation">(</span><span class="token string">&quot;index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Return HTML String</span>
<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HttpResult</span><span class="token punctuation">(</span>VirtualFileSources<span class="token punctuation">.</span><span class="token function">GetFile</span><span class="token punctuation">(</span><span class="token string">&quot;index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ReadAllText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Return ServiceStack.Razor View</span>
<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HttpResult</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    View <span class="token operator">=</span> <span class="token string">&quot;/default.cshtml&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="limiting-to-http-verbs" tabindex="-1">Limiting to HTTP Verbs <a class="header-anchor" href="#limiting-to-http-verbs" aria-hidden="true">#</a></h3><p>If not specified Routes will match <strong>All</strong> HTTP Verbs. You can also limit Routes to individual Verbs, this lets you route the same path to different services, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/contacts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/contacts/{Id}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetContacts</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/contacts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;POST PUT&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/contacts/{Id}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;POST PUT&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UpdateContact</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/contacts/{Id}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;DELETE&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeleteContact</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="matching-ignored-paths" tabindex="-1">Matching ignored paths <a class="header-anchor" href="#matching-ignored-paths" aria-hidden="true">#</a></h3><p>You can use the <code>{ignore}</code> variable placeholder to match a Route definition that doesn&#39;t map to a Request DTO property, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/contacts/{Id}/{ignore}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetContacts</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><p>Will match on <code>/contacts/1/john-doe</code> request and not require your Request DTO to have an <strong>ignore</strong> property</p><h3 id="fluent-api" tabindex="-1">Fluent API <a class="header-anchor" href="#fluent-api" aria-hidden="true">#</a></h3><p>You can also use a Fluent API to register ServiceStack Routes by adding them in your <code>AppHost.Configure()</code>:</p><div class="language-csharp"><pre><code>Routes
    <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Hello<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Hello<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;/hello/{Name}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>and to match only <strong>GET</strong> request for <code>/Customers?Key=Value</code> and <code>/Customers/{Id}</code>:</p><div class="language-csharp"><pre><code>Routes
    <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>GetContact<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;/Contacts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Add</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>GetContact<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;/Contacts/{ContactId}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="content-negotiation" tabindex="-1">Content Negotiation <a class="header-anchor" href="#content-negotiation" aria-hidden="true">#</a></h2><p>In addition to using the standard <code>Accept</code> HTTP Header to retrieve the response a different format, you can also request an alternative Content-Type by appending <strong>?format=ext</strong> to the query string, e.g:</p><ul><li><a href="http://razor.servicestack.net/rockstars?format=xml" target="_blank" rel="noopener noreferrer">/rockstars?format=xml</a></li><li><a href="http://razor.servicestack.net/rockstars/1?format=json" target="_blank" rel="noopener noreferrer">/rockstars/1?format=json</a></li></ul><p>Or by appending the format <strong>.ext</strong> to the end of the route, e.g:</p><ul><li><a href="http://razor.servicestack.net/rockstars.xml" target="_blank" rel="noopener noreferrer">/rockstars.xml</a></li><li><a href="http://razor.servicestack.net/rockstars/1.json" target="_blank" rel="noopener noreferrer">/rockstars/1.json</a></li><li><a href="http://razor.servicestack.net/rockstars.html?id=1" target="_blank" rel="noopener noreferrer">/rockstars.html?id=1</a></li></ul><p>This is enabled on all custom routes and works for all built-in and user-registered formats. It can be disabled by setting:</p><div class="language-cs"><pre><code>Config<span class="token punctuation">.</span>AllowRouteContentTypeExtensions <span class="token operator">=</span> <span class="token boolean">false</span>
</code></pre></div><h3 id="simulate-alternative-http-methods" tabindex="-1">Simulate alternative HTTP Methods <a class="header-anchor" href="#simulate-alternative-http-methods" aria-hidden="true">#</a></h3><p>Some environments prohibit or inhibit sending alternative HTTP Methods like HTML Forms which only allow <strong>GET</strong> or <strong>POST</strong> but you can simulate an alternative HTTP Method with the <code>X-Http-Method-Override</code>, e.g. we can simulate a <strong>PATCH</strong> request with:</p><div class="language-"><pre><code>X-Http-Method-Override: PATCH
</code></pre></div><p>Or in a HTML Form with a hidden input, e.g:</p><div class="language-html"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-Http-Method-Override<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>PATCH<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>This header is also available in the <code>HttpHeaders.XHttpMethodOverride</code> constant if needing to use it in C#/.NET Clients, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">JsonServiceClient</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    RequestFilter <span class="token operator">=</span> req <span class="token operator">=&gt;</span> req<span class="token punctuation">.</span>Headers<span class="token punctuation">[</span>HttpHeaders<span class="token punctuation">.</span>XHttpMethodOverride<span class="token punctuation">]</span> <span class="token operator">=</span> HttpMethods<span class="token punctuation">.</span>Patch
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="custom-rules" tabindex="-1">Custom Rules <a class="header-anchor" href="#custom-rules" aria-hidden="true">#</a></h3><p>The <code>Matches</code> property on <code>[Route]</code> and <code>[FallbackRoute]</code> attributes lets you specify an additional custom Rule that requests need to match. This feature is used in all <a href="https://docs.servicestack.net/templates-single-page-apps" target="_blank" rel="noopener noreferrer">SPA project templates</a> to specify that the <code>[FallbackRoute]</code> should only return the SPA <code>index.html</code> for unmatched requests which explicitly requests HTML, i.e:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FallbackRoute</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/{PathInfo*}&quot;</span><span class="token punctuation">,</span> Matches<span class="token operator">=</span><span class="token string">&quot;AcceptsHtml&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FallbackForClientRoutes</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> PathInfo <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This works by matching the <code>AcceptsHtml</code> built-in <code>RequestRules</code> below where the Route will only match the Request if it includes the explicit <code>text/html</code> MimeType in the HTTP Request <code>Accept</code> Header. The <code>AcceptsHtml</code> rule prevents the home page from being returned for missing resource requests like <strong>favicon</strong> which returns a <code>404</code> instead.</p><p>The implementation of all built-in Request Rules:</p><div class="language-csharp"><pre><code><span class="token function">SetConfig</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">HostConfig</span> <span class="token punctuation">{</span>
  RequestRules <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">{</span><span class="token string">&quot;AcceptsHtml&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> req<span class="token punctuation">.</span>Accept<span class="token punctuation">?.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span>MimeTypes<span class="token punctuation">.</span>Html<span class="token punctuation">,</span> StringComparison<span class="token punctuation">.</span>Ordinal<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;AcceptsJson&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> req<span class="token punctuation">.</span>Accept<span class="token punctuation">?.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span>MimeTypes<span class="token punctuation">.</span>Json<span class="token punctuation">,</span> StringComparison<span class="token punctuation">.</span>Ordinal<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;AcceptsXml&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> req<span class="token punctuation">.</span>Accept<span class="token punctuation">?.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span>MimeTypes<span class="token punctuation">.</span>Xml<span class="token punctuation">,</span> StringComparison<span class="token punctuation">.</span>Ordinal<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;AcceptsJsv&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> req<span class="token punctuation">.</span>Accept<span class="token punctuation">?.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span>MimeTypes<span class="token punctuation">.</span>Jsv<span class="token punctuation">,</span> StringComparison<span class="token punctuation">.</span>Ordinal<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;AcceptsCsv&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> req<span class="token punctuation">.</span>Accept<span class="token punctuation">?.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span>MimeTypes<span class="token punctuation">.</span>Csv<span class="token punctuation">,</span> StringComparison<span class="token punctuation">.</span>Ordinal<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;IsAuthenticated&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> req<span class="token punctuation">.</span><span class="token function">IsAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;IsMobile&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> Instance<span class="token punctuation">.</span>IsMobileRegex<span class="token punctuation">.</span><span class="token function">IsMatch</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>UserAgent<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;{int}/**&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>PathInfo<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">LeftPart</span><span class="token punctuation">(</span><span class="token string character">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">out</span> _<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;path/{int}/**&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> afterFirst <span class="token operator">=</span> req<span class="token punctuation">.</span>PathInfo<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RightPart</span><span class="token punctuation">(</span><span class="token string character">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>afterFirst<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>afterFirst<span class="token punctuation">.</span><span class="token function">LeftPart</span><span class="token punctuation">(</span><span class="token string character">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">out</span> _<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;**/{int}&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>PathInfo<span class="token punctuation">.</span><span class="token function">LastRightPart</span><span class="token punctuation">(</span><span class="token string character">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">out</span> _<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;**/{int}/path&quot;</span><span class="token punctuation">,</span> req <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> beforeLast <span class="token operator">=</span> req<span class="token punctuation">.</span>PathInfo<span class="token punctuation">.</span><span class="token function">LastLeftPart</span><span class="token punctuation">(</span><span class="token string character">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> beforeLast <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>beforeLast<span class="token punctuation">.</span><span class="token function">LastRightPart</span><span class="token punctuation">(</span><span class="token string character">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">out</span> _<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Routes that contain a <code>Matches</code> rule have a higher precedence then Routes without. We can use this to define multiple idential matching routes to call different Service depending on whether the Path Segment is an integer or not, e.g:</p><div class="language-csharp"><pre><code><span class="token comment">// matches /users/1</span>
<span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;/users/{Id}&quot;</span><span class="token punctuation">,</span> Matches <span class="token operator">=</span> <span class="token string">&quot;**/{int}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetUser</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// matches /users/username</span>
<span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;/users/{Slug}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetUserBySlug</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Slug <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Other examples utilizing <code>{int}</code> Request Rules:</p><div class="language-csharp"><pre><code><span class="token comment">// matches /1/profile</span>
<span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;/{UserId}/profile&quot;</span><span class="token punctuation">,</span> Matches <span class="token operator">=</span> <span class="token string">@&quot;{int}/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetProfile</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token comment">// matches /username/profile</span>
<span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;/{Slug}/profile&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetProfileBySlug</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token comment">// matches /users/1/profile/avatar</span>
<span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;/users/{UserId}/profile/avatar&quot;</span><span class="token punctuation">,</span> Matches <span class="token operator">=</span> <span class="token string">@&quot;path/{int}/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetProfileAvatar</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token comment">// matches /users/username/profile/avatar</span>
<span class="token punctuation">[</span><span class="token function">Route</span><span class="token punctuation">(</span><span class="token string">&quot;/users/{Slug}/profile/avatar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetProfileAvatarBySlug</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><p>Another popular use-case is to call different services depending on whether a Request is from an Authenticated User or not:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/feed&quot;</span><span class="token punctuation">,</span> Matches <span class="token operator">=</span> <span class="token string">&quot;IsAuthenticated&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ViewCustomizedUserFeed</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/feed&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ViewPublicFeed</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><p>This can also be used to call different Services depending if the Request is from a Mobile browser or not:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/search&quot;</span><span class="token punctuation">,</span> Matches <span class="token operator">=</span> <span class="token string">&quot;IsMobile&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MobileSearch</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/search&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DesktopSearch</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><p>Instead of matching on a pre-configured RequestRule you can instead specify a Regular Expression using the format:</p><div class="language-"><pre><code>{Property} =~ {RegEx}
</code></pre></div><p>Where <code>{Property}</code> is an <code>IHttpRequest</code> property, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/users/{Id}&quot;</span><span class="token punctuation">,</span> Matches <span class="token operator">=</span> <span class="token string">@&quot;PathInfo =~ \\/[0-9]+$&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetUser</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><p>An exact match takes the format:</p><div class="language-"><pre><code>{Property} = {Value}
</code></pre></div><p>Which you could use to provide a tailored feed for specific clients:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/feed&quot;</span><span class="token punctuation">,</span> Matches <span class="token operator">=</span> <span class="token string">@&quot;UserAgent = specific-client&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomFeedView</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="http-verb-interface-markers" tabindex="-1">HTTP Verb Interface Markers <a class="header-anchor" href="#http-verb-interface-markers" aria-hidden="true">#</a></h3><p>You can decorate your Request DTO&#39;s using the <code>IGet</code>, <code>IPost</code>, <code>IPut</code>, <code>IDelete</code> and <code>IPatch</code> interface markers and the <code>Send</code> and <code>SendAsync</code> API&#39;s will use it to automatically send the Request using the selected HTTP Method. E.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloByGet</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IGet</span><span class="token punctuation">,</span> <span class="token class-name">IReturn<span class="token punctuation">&lt;</span>HelloResponse<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloByPut</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IPut</span><span class="token punctuation">,</span> <span class="token class-name">IReturn<span class="token punctuation">&lt;</span>HelloResponse<span class="token punctuation">&gt;</span></span></span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">HelloByGet</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;World&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// GET</span>

<span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">SendAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">HelloByPut</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;World&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// PUT</span>
</code></pre></div><p>Interface markers is supported in all .NET Service Clients, they&#39;re also included in the generated <a href="/add-servicestack-reference.html">Add ServiceStack Reference</a> DTO&#39;s.</p><h2 id="auto-route-generation-strategies" tabindex="-1">Auto Route Generation Strategies <a class="header-anchor" href="#auto-route-generation-strategies" aria-hidden="true">#</a></h2><p>Also related to this is registering Auto routes via the <a href="https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/ServiceRoutesExtensions.cs#L23" target="_blank" rel="noopener noreferrer">Routes.AddFromAssembly</a> extension method, where this single call:</p><div class="language-cs"><pre><code>Routes<span class="token punctuation">.</span><span class="token function">AddFromAssembly</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">FooService</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span>
</code></pre></div><p>Goes through and scans all your services (in the Assemblies specified) and registers convention-based routes based on all the HTTP methods you have implemented.</p><p>The default convention registers routes based on the Request DTO Name, whether it has an <strong>Id</strong> property and what actions were implemented. These conventions are configurable where you can now adjust/remove the existing rules or add your own to the <strong>pre-defined</strong> rules in <code>Config.RouteNamingConventions</code>:</p><div class="language-csharp"><pre><code>RouteNamingConventions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>RouteNamingConventionDelegate<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    RouteNamingConvention<span class="token punctuation">.</span>WithRequestDtoName<span class="token punctuation">,</span>
    RouteNamingConvention<span class="token punctuation">.</span>WithMatchingAttributes<span class="token punctuation">,</span>     <span class="token comment">// defaults: PrimaryKeyAttrubute</span>
    RouteNamingConvention<span class="token punctuation">.</span>WithMatchingPropertyNames<span class="token punctuation">,</span>  <span class="token comment">// defaults: Id, IDs</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The existing rules can be further customized by modifying the related static properties, e.g:</p><div class="language-csharp"><pre><code>RouteNamingConvention<span class="token punctuation">.</span>PropertyNamesToMatch<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;UniqueId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
RouteNamingConvention<span class="token punctuation">.</span>AttributeNamesToMatch<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;DefaultIdAttribute&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Which will make these request DTOs:</p><div class="language-csharp"><pre><code><span class="token keyword">class</span> <span class="token class-name">MyRequest1</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> UniqueId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyRequest2</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DefaultId</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> CustomId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Generate the following routes:</p><div class="language-"><pre><code>/myrequest1
/myrequest1/{UniqueId}
/myrequest2
/myrequest2/{CustomId}
</code></pre></div><p>See the implementation of <a href="https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/Host/RouteNamingConvention.cs" target="_blank" rel="noopener noreferrer">RouteNamingConvention</a> for examples of how to add your own auto-generated route conventions.</p><h3 id="dynamically-adding-route-attributes" tabindex="-1">Dynamically adding Route Attributes <a class="header-anchor" href="#dynamically-adding-route-attributes" aria-hidden="true">#</a></h3><p>Routes attributes can also be added dynamically but as Services are auto-registered before <code>AppHost.Configure()</code> runs, Route attributes need to be added before this happens like in the AppHost Constructor or before <code>new AppHost().Init()</code>, i.e:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppHostBase</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyRequest</span><span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token function">AddAttributes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RouteAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;/myrequest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token function">AddAttributes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RouteAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;/myrequest/{UniqueId}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="customizing-defined-routes" tabindex="-1">Customizing Defined Routes <a class="header-anchor" href="#customizing-defined-routes" aria-hidden="true">#</a></h3><p>You can customize existing routes by overriding <code>GetRouteAttributes()</code> in your AppHost, the example below adds a <code>/api</code> prefix to all existing routes:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppHostBase</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">//...</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name">RouteAttribute<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token function">GetRouteAttributes</span><span class="token punctuation">(</span><span class="token class-name">Type</span> requestType<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> routes <span class="token operator">=</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">GetRouteAttributes</span><span class="token punctuation">(</span>requestType<span class="token punctuation">)</span><span class="token punctuation">;</span>
        routes<span class="token punctuation">.</span><span class="token function">Each</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Path <span class="token operator">=</span> <span class="token string">&quot;/api&quot;</span> <span class="token operator">+</span> x<span class="token punctuation">.</span>Path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> routes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="uploading-files" tabindex="-1">Uploading Files <a class="header-anchor" href="#uploading-files" aria-hidden="true">#</a></h3><p>You can access uploaded files independently of the Request DTO using <code>Request.Files</code>. e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token class-name">MyFileUpload</span> request<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Request<span class="token punctuation">.</span>Files<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> uploadedFile <span class="token operator">=</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">.</span>Files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        uploadedFile<span class="token punctuation">.</span><span class="token function">SaveTo</span><span class="token punctuation">(</span>MyUploadsDirPath<span class="token punctuation">.</span><span class="token function">CombineWith</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>FileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> HttpResult<span class="token punctuation">.</span><span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ServiceStack&#39;s <a href="http://imgur.servicestack.net" target="_blank" rel="noopener noreferrer">imgur.servicestack.net</a> example shows how to access the <a href="https://github.com/ServiceStackApps/Imgur/blob/master/src/Imgur/Global.asax.cs#L62" target="_blank" rel="noopener noreferrer">byte stream of multiple uploaded files</a>, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token class-name">Upload</span> request<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> uploadedFile <span class="token keyword">in</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">.</span>Files
       <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>uploadedFile <span class="token operator">=&gt;</span> uploadedFile<span class="token punctuation">.</span>ContentLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> ms <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MemoryStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            uploadedFile<span class="token punctuation">.</span><span class="token function">WriteTo</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">WriteImage</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> HttpResult<span class="token punctuation">.</span><span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="reading-directly-from-the-request-stream" tabindex="-1">Reading directly from the Request Stream <a class="header-anchor" href="#reading-directly-from-the-request-stream" aria-hidden="true">#</a></h3><p>Instead of registering a custom binder you can skip the serialization of the request DTO, you can add the <a href="https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Interfaces/Web/IRequiresRequestStream.cs" target="_blank" rel="noopener noreferrer">IRequiresRequestStream</a> interface to directly retrieve the stream without populating the request DTO.</p><div class="language-csharp"><pre><code><span class="token comment">//Request DTO</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RawBytes</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IRequiresRequestStream</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">/// &lt;summary&gt;</span>
    <span class="token comment">/// The raw Http Request Input Stream</span>
    <span class="token comment">/// &lt;/summary&gt;</span>
    <span class="token return-type class-name">Stream</span> RequestStream <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Which tells ServiceStack to skip trying to deserialize the request so you can read in the raw HTTP Request body yourself, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token class-name">RawBytes</span> request<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> bytes <span class="token operator">=</span> request<span class="token punctuation">.</span>RequestStream<span class="token punctuation">.</span><span class="token function">ReadFully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">string</span></span> text <span class="token operator">=</span> bytes<span class="token punctuation">.</span><span class="token function">FromUtf8Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//if text was sent</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="pluralize-and-singularize" tabindex="-1">Pluralize and Singularize <a class="header-anchor" href="#pluralize-and-singularize" aria-hidden="true">#</a></h3><p>In order to use optimal user-friendly routes in <a href="/autoquery-autogen.html">AutoGen AutoQuery Services</a>, an interned version of <a href="http://andrewpeters.net/inflectornet/" target="_blank" rel="noopener noreferrer">Andrew Peters port of Rails Inflector</a> is available under the <code>Words</code> static class that you can use to <code>Pluralize</code> or <code>Singularize</code> routes:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> plural <span class="token operator">=</span> Words<span class="token punctuation">.</span><span class="token function">Pluralize</span><span class="token punctuation">(</span><span class="token string">&quot;customer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//= customers</span>
<span class="token class-name"><span class="token keyword">var</span></span> singular <span class="token operator">=</span> Words<span class="token punctuation">.</span><span class="token function">Singularize</span><span class="token punctuation">(</span><span class="token string">&quot;customers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//= customer</span>
</code></pre></div><h2 id="routing-resolution-order" tabindex="-1">Routing Resolution Order <a class="header-anchor" href="#routing-resolution-order" aria-hidden="true">#</a></h2><p>This is described in more detail on the <a href="/api-design.html">New API Design wiki</a> but the weighting used to select a route is based on:</p><ol><li>Any exact Literal Matches are used first</li><li>Exact Verb match is preferred over All Verbs</li><li>The more variables in your route the less weighting it has</li><li>Routes with wildcard variables have the lowest precedence</li><li>When Routes have the same weight, the order is determined by the position of the Action in the service or Order of Registration (FIFO)</li></ol><h3 id="route-weighting-example" tabindex="-1">Route weighting example <a class="header-anchor" href="#route-weighting-example" aria-hidden="true">#</a></h3><p>The following HTTP Request:</p><div class="language-"><pre><code>GET /content/v1/literal/slug
</code></pre></div><p>Will match the following Route definitions in order from highest precedence to lowest:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/content/v1/literal/slug&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/content/v1/literal/slug&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/content/v1/literal/{ignore}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/content/{ignore}/literal/{ignore}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/content/{Version*}/literal/{Slug*}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/content/{Version*}/literal/{Slug*}&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/content/{Slug*}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/content/{Slug*}&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
</code></pre></div><p>See the <a href="https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.ServiceHost.Tests/RestPathTests.cs" target="_blank" rel="noopener noreferrer">RestPathTests.cs</a> and <a href="/api-design.html">Smart Routing</a> section on the wiki for more examples.</p><h3 id="content-type-specific-service-implementations" tabindex="-1">Content-Type Specific Service Implementations <a class="header-anchor" href="#content-type-specific-service-implementations" aria-hidden="true">#</a></h3><p>Service implementations can use <code>Verb{Format}</code> method names to provide a different implementation for handling a specific Content-Type, e.g. the Service below defines several different implementation for handling the same Request:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/my-request&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRequest</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ContentTypeServices</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// Handles all other unspecified Verbs/Formats to /my-request</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token class-name">MyRequest</span> request<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">;</span>

    <span class="token comment">// Handles GET /my-request for JSON responses</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">GetJson</span><span class="token punctuation">(</span><span class="token class-name">MyRequest</span> request<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token range operator">..</span><span class="token punctuation">;</span> 

    <span class="token comment">// Handles POST/PUT/DELETE/etc /my-request for HTML Responses</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">AnyHtml</span><span class="token punctuation">(</span><span class="token class-name">MyRequest</span> request<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>  
        <span class="token interpolation-string"><span class="token string">$@&quot;&lt;html&gt;
            &lt;body&gt;
                &lt;h1&gt;AnyHtml </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">request<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">&lt;/h1&gt;
            &lt;/body&gt;
        &lt;/html&gt;&quot;</span></span><span class="token punctuation">;</span>

    <span class="token comment">// Handles GET /my-request for HTML Responses</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">GetHtml</span><span class="token punctuation">(</span><span class="token class-name">MyRequest</span> request<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>   
        <span class="token interpolation-string"><span class="token string">$@&quot;&lt;html&gt;
            &lt;body&gt;
                &lt;h1&gt;GetHtml </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">request<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">&lt;/h1&gt;
            &lt;/body&gt;
        &lt;/html&gt;&quot;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This convention can be used for any of the formats listed in <code>ContentTypes.KnownFormats</code>, which by default includes:</p><ul><li>json</li><li>xml</li><li>jsv</li><li>csv</li><li>html</li><li>protobuf</li><li>msgpack</li><li>wire</li></ul><h3 id="reverse-routing" tabindex="-1">Reverse Routing <a class="header-anchor" href="#reverse-routing" aria-hidden="true">#</a></h3><p>If you use <code>[Route]</code> metadata attributes (as opposed to the Fluent API) you will be able to generate strong-typed URI&#39;s using just the DTOs, letting you create urls outside of ServiceStack web framework as done with <a href="/csharp-client.html">.NET Service Clients</a> using the <code>ToUrl(HttpMethod)</code> and <code>ToAbsoluteUri(HttpMethod)</code>, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/reqstars/search&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/reqstars/aged/{Age}&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SearchReqstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IReturn<span class="token punctuation">&lt;</span>ReqstarsResponse<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name"><span class="token keyword">var</span></span> relativeUrl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SearchReqstars</span> <span class="token punctuation">{</span> Age <span class="token operator">=</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">ToGetUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> absoluteUrl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SearchReqstars</span> <span class="token punctuation">{</span> Age <span class="token operator">=</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">ToAbsoluteUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

relativeUrl<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//=  /reqstars/aged/20</span>
absoluteUrl<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//=  http://www.myhost.com/reqstars/aged/20</span>
</code></pre></div><p>The <a href="https://github.com/ServiceStack/EmailContacts/" target="_blank" rel="noopener noreferrer">Email Contacts demo</a> shows an example of using the above Reverse Routing extension methods to <a href="https://github.com/ServiceStack/EmailContacts/#bootstrap-forms" target="_blank" rel="noopener noreferrer">populate routes for HTML Forms and Links in Razor Views</a>.</p><h4 id="other-reverse-routing-extension-methods" tabindex="-1">Other Reverse Routing Extension methods <a class="header-anchor" href="#other-reverse-routing-extension-methods" aria-hidden="true">#</a></h4><div class="language-csharp"><pre><code><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RequestDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToPostUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name">RequestDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToPutUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name">RequestDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToDeleteUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name">RequestDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToOneWayUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name">RequestDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToReplyUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="populating-complex-type-properties-on-querystring" tabindex="-1">Populating Complex Type Properties on QueryString <a class="header-anchor" href="#populating-complex-type-properties-on-querystring" aria-hidden="true">#</a></h3><p>ServiceStack uses the <a href="/jsv-format.html">JSV-Format</a> (JSON without quotes) to parse QueryStrings.</p><p>JSV lets you embed deep object graphs in QueryString as seen <a href="http://test.servicestack.net/json/reply/StoreLogs?Loggers=%5B%7BId:786,Devices:%5B%7BId:5955,Type:Panel,TimeStamp:1199303309,Channels:%5B%7BName:Temperature,Value:58%7D,%7BName:Status,Value:On%7D%5D%7D,%7BId:5956,Type:Tank,TimeStamp:1199303309,Channels:%5B%7BName:Volume,Value:10035%7D,%7BName:Status,Value:Full%7D%5D%7D%5D%7D%5D" target="_blank" rel="noopener noreferrer">this example url</a>:</p><div class="language-"><pre><code>http://test.servicestack.net/json/reply/StoreLogs?Loggers=[{Id:786,Devices:[{Id:5955,Type:Panel,
Channels:[{Name:Temperature,Value:58},{Name:Status,Value:On}]},
{Id:5956,Type:Tank,TimeStamp:1199303309,
Channels:[{Name:Volume,Value:10035},{Name:Status,Value:Full}]}]}]
</code></pre></div><h3 id="customize-urls-used-with-iurlfilter" tabindex="-1">Customize urls used with <code>IUrlFilter</code> <a class="header-anchor" href="#customize-urls-used-with-iurlfilter" aria-hidden="true">#</a></h3><p>Request DTO&#39;s can customize urls used in Service Clients or any libraries using ServiceStack&#39;s typed <a href="/routing.html#reverse-routing">Reverse Routing</a> by having Request DTO&#39;s implement <a href="https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Interfaces/IUrlFilter.cs" target="_blank" rel="noopener noreferrer">IUrlFilter</a>.</p><p>ServiceStack&#39;s <a href="https://github.com/ServiceStack/Stripe" target="_blank" rel="noopener noreferrer">Stripe Gateway</a> takes advantage of ServiceStack&#39;s typed Routing feature to implement its <a href="https://github.com/ServiceStack/Stripe#open-ended-declarative-message-based-apis" target="_blank" rel="noopener noreferrer">Open-Ended, Declarative Message-based APIs</a> with minimal effort.</p><p>In order to match Stripe&#39;s unconventional syntax for specifying arrays on the QueryString of their 3rd party REST API we use <code>IUrlFilter</code> to customize the url that&#39;s used. E.g. we need to specify <code>include[]</code> in order for the Stripe API to return any optional fields like <strong>total_count</strong>.</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/customers&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetStripeCustomers</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IGet</span><span class="token punctuation">,</span> <span class="token class-name">IReturn<span class="token punctuation">&lt;</span>StripeCollection<span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">IUrlFilter</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">GetStripeCustomers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        Include <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;total_count&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">IgnoreDataMember</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> Include <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToUrl</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> absoluteUrl<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Include <span class="token operator">!=</span> <span class="token keyword">null</span> 
        <span class="token punctuation">?</span> absoluteUrl<span class="token punctuation">.</span><span class="token function">AddQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;include[]&quot;</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> Include<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        <span class="token punctuation">:</span> absoluteUrl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><code>[IgnoreDataMember]</code> is used to hide the property being emitted using the default convention</p></blockquote><p>Which when sending the Request DTO:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetStripeCustomers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Generates and sends the relative url:</p><div class="language-"><pre><code>/customers?include[]=total_count
</code></pre></div><p>Which has the effect of populating the <code>TotalCount</code> property in the typed <code>StripeCollection&lt;StripeCustomer&gt;</code> response.</p><h2 id="routing-metadata" tabindex="-1">Routing Metadata <a class="header-anchor" href="#routing-metadata" aria-hidden="true">#</a></h2><p>Most of the metadata ServiceStack knows about your services are accessible internally via <code>HostContext.Config.Metadata</code> from within ServiceStack and externally via the <code>/operations/metadata</code> route. A link to the <strong>Operations Metadata</strong> page is displayed at the bottom of the /metadata when in ServiceStack is in <code>DebugMode</code>.</p><h3 id="great-performance" tabindex="-1">Great Performance <a class="header-anchor" href="#great-performance" aria-hidden="true">#</a></h3><p>Since <a href="http://samsaffron.com/archive/2011/10/13/optimising-asp-net-mvc3-routing" target="_blank" rel="noopener noreferrer">Routing in ASP.NET MVC can be slow</a> when you have a large number of Routes, it&#39;s worthwhile pointing out ServiceStack&#39;s Routing implementation is implemented with hash lookups so doesn&#39;t suffer the linear performance regression issues you might have had with MVC. So you don&#39;t have to worry about degraded performance when registering a large number of Routes.</p><h3 id="consider-pretty-urls-for-public-pages" tabindex="-1">Consider &quot;pretty-urls&quot; for public pages <a class="header-anchor" href="#consider-pretty-urls-for-public-pages" aria-hidden="true">#</a></h3><p>A constant eyesore that hurts my aesthetic eye when surfing the web is how you can immediately tell that a Website is written in <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> by its <code>/{Controller}/{Action}</code> routing convention or <code>.aspx</code> suffix. This forces URL abnormalities where instead of choosing the ideal identifier for your public resource, the path tends to adopt internal method and class names that typically makes more sense to its developers than to external users. These dictated conventions also results in the <code>?queryString</code> becoming a data bag of params that should otherwise be hidden or included as part of its public URI identifier.</p><h4 id="permalinks-important-for-seo-usability-and-refactorability" tabindex="-1">Permalinks important for SEO, usability and refactorability <a class="header-anchor" href="#permalinks-important-for-seo-usability-and-refactorability" aria-hidden="true">#</a></h4><p>In general it&#39;s not a good idea to let a technology to dictate what your public routes end up being. Ideally your external routes should be regarded as permalinks and decoupled from their internal implementations as you don&#39;t want internal refactors to cause link rot, break existing inbound navigation or lose any SEO weight they&#39;ve accumulated.</p><p>If you adopt the ideal URL from the start, you&#39;ll never have a reason to change it and the decoupling frees you from being able to refactor it&#39;s mapped implementation or even replacing the underlying technology completely as the ideal routes are already at what they should be that&#39;s free from any technology bias.</p><p>Pretty URLs or <a href="https://en.wikipedia.org/wiki/Clean_URL" target="_blank" rel="noopener noreferrer">Clean URLs</a> also provide important usability and accessibility benefits to non technical users where their prominent location in browsers is a valuable opportunity to add meaningful context on where they are in your Website.</p><h4 id="pre-defined-routes-are-optimal-for-machines" tabindex="-1">Pre-defined Routes are optimal for machines <a class="header-anchor" href="#pre-defined-routes-are-optimal-for-machines" aria-hidden="true">#</a></h4><p>In ServiceStack all Services are automatically available using the <a href="/routing.html#pre-defined-routes">pre-defined routes</a> which is optimal for automated tooling and machinery as they can be predicted without requiring any server meta information.</p><h4 id="optimize-custom-routes-for-humans" tabindex="-1">Optimize Custom Routes for humans <a class="header-anchor" href="#optimize-custom-routes-for-humans" aria-hidden="true">#</a></h4><p>Use <a href="/routing.html#custom-routes">Custom Routes</a> to also make your <strong>Services</strong> available at the optimal Clean URLs for humans. For <strong>Content Pages</strong> you can take advantage of <strong>Page Based Routing</strong> in both <strong>Sharp Pages</strong> and now in <strong>Razor</strong> to specify the ideal route for your page which in addition to requiring less effort to define (as they&#39;re implicitly defined) they&#39;re also less effort to implement as <strong>no Controller or Service</strong> are needed. They also benefit from being immediately inferrible by looking at the intuitively mapped directory and file names alone which works equally well in reverse where the page for a route will be exactly where you think it will be.</p><h4 id="designing-clean-urls" tabindex="-1">Designing Clean URLs <a class="header-anchor" href="#designing-clean-urls" aria-hidden="true">#</a></h4><p>Some great references on designing RESTful Pretty URLs are the <a href="https://en.wikipedia.org/wiki/Clean_URL#Structure" target="_blank" rel="noopener noreferrer">Clean URL examples in Wikipedia</a>:</p>__VP_STATIC_END__`,176),i=n('',4);function r(k,d,h,g,m,y){const s=t("cleanUrlsMd");return c(),e("div",null,[u,p("p",null,[o(s)]),i])}var v=a(l,[["render",r]]);export{b as __pageData,v as default};
