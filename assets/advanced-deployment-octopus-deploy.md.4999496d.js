import{_ as t,c as a,o as s,a as n}from"./app.14440598.js";const k='{"title":"Advanced Deployments with Octopus Deploy","description":"","frontmatter":{"slug":"advanced-deployment-octopus-deploy","title":"Advanced Deployments with Octopus Deploy"},"headers":[{"level":2,"title":"Deploying and Installing SSL certificates with Octopus Deploy","slug":"deploying-and-installing-ssl-certificates-with-octopus-deploy"},{"level":2,"title":"Getting started","slug":"getting-started"},{"level":3,"title":"TeamCity Steps","slug":"teamcity-steps"},{"level":2,"title":"Octopus Deploy process steps","slug":"octopus-deploy-process-steps"},{"level":2,"title":"Publish settings package","slug":"publish-settings-package"},{"level":2,"title":"Install SSL If Required","slug":"install-ssl-if-required"},{"level":2,"title":"Copy Production Settings and License","slug":"copy-production-settings-and-license"},{"level":2,"title":"Using the SSL binding","slug":"using-the-ssl-binding"},{"level":2,"title":"HTTP binding redirect","slug":"http-binding-redirect"},{"level":3,"title":"Managing settings files yourself vs Octopus Deploy variables","slug":"managing-settings-files-yourself-vs-octopus-deploy-variables"}],"relativePath":"advanced-deployment-octopus-deploy.md","lastUpdated":1634495307606}',e={},o=n(`<p><em>by <a href="https://twitter.com/layoric" target="_blank" rel="noopener noreferrer">Darren Reid</a></em></p><h2 id="deploying-and-installing-ssl-certificates-with-octopus-deploy" tabindex="-1">Deploying and Installing SSL certificates with Octopus Deploy <a class="header-anchor" href="#deploying-and-installing-ssl-certificates-with-octopus-deploy" aria-hidden="true">#</a></h2><p>There&#39;s a good chance at some stage you&#39;re going to want to have sensitive environment specific information that you don&#39;t to want to store in source control, especially if your project is open source. This could be SSL certificates, license information or Production AppSettings like private database passwords, production connection strings or anything else you need to run your application.</p><p>One solution is to package all application settings and other dependencies on the build server. Using <a href="http://www.jetbrains.com/teamcity/" target="_blank" rel="noopener noreferrer">TeamCity</a> and <a href="https://octopusdeploy.com/" target="_blank" rel="noopener noreferrer">Octopus Deploy</a>, packaging these settings up and deploying along with the application is easy to manage, flexible process that can streamline and automate even complicated application deployments.</p><p>Whilst the installation of SSL certificates, IIS bindings and other tasks here aren&#39;t time consuming to do manually, being able to get a new server up and running quickly by automating as much as possible has many benefits including consistent, replay-able deployments and not being tied to a particular infrastructure provider allowing you to easily switch to better valued hosting providers like <a href="http://www.hetzner.de/en/" target="_blank" rel="noopener noreferrer">Hetzner</a> should you wish to in future.</p><h2 id="getting-started" tabindex="-1">Getting started <a class="header-anchor" href="#getting-started" aria-hidden="true">#</a></h2><p>This example is going to be an extension on the pattern used in the <a href="/deploy-multiple-sites-to-aws.html">Deploy multiple sites to a single AWS instance deployment guide</a>, but with an additional TeamCity step and a few extra process steps for Octopus Deploy to deploy an application with additional components and configuration.</p><ol><li><strong>Settings</strong> file read by ServiceStack application</li><li>ServiceStack <strong>license file</strong></li><li><strong>SSL certificate</strong> for HTTPs binding</li></ol><p>As an overview, the TeamCity steps for building and deploying a <strong>simple application</strong> goes something like:</p><h3 id="teamcity-steps" tabindex="-1"><a href="/deploy-multiple-sites-to-aws.html#teamcity-installation-and-setup">TeamCity Steps</a> <a class="header-anchor" href="#teamcity-steps" aria-hidden="true">#</a></h3><h4 id="build-application" tabindex="-1">Build application <a class="header-anchor" href="#build-application" aria-hidden="true">#</a></h4><ol><li>Restore NuGet dependencies</li><li>Package application into .nupkg</li></ol><h4 id="deploy-application" tabindex="-1">Deploy application <a class="header-anchor" href="#deploy-application" aria-hidden="true">#</a></h4><ol><li>Notify Octopus Deploy of new version available from TeamCity NuGet feed</li></ol><p>With the added settings package, we are adding an additional step to the Build application list above.</p><ol><li><strong>Package settings and other required environment files into .nupkg</strong></li><li>Restore NuGet dependencies</li><li>Package application into .nupkg</li></ol><h4 id="creating-the-nuget-package" tabindex="-1">Creating the NuGet package <a class="header-anchor" href="#creating-the-nuget-package" aria-hidden="true">#</a></h4><p>To package the files into a NuGet package we will need to create a <strong>nuspec</strong> file. A .nuspec file is a <a href="http://docs.nuget.org/docs/reference/nuspec-reference" target="_blank" rel="noopener noreferrer">package specification</a> that contains a list of files to include in the package, and this is where we have to specify the 3 files above, e.g:</p><div class="language-xml"><pre><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>metadata</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>BenchmarkAnalyzerSettings<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>authors</span><span class="token punctuation">&gt;</span></span>ServiceStack<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>authors</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>requireLicenseAcceptance</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>requireLicenseAcceptance</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Settings for the Benchmark Analyzer project<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>metadata</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>files</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>appsettings.license.txt<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>appsettings.txt<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>httpbenchmarks.pfx<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>files</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Once we have created a valid .nuspec file, we can get TeamCity to create a NuGet package using the <strong>NuGet Pack runner type</strong>. The main settings you will need for this configuration is the path where TeamCity can find the .nuspec file.</p><p>If you are hosting your own TeamCity instance, this is just a local directory. However, if you are hosting a TeamCity instance separately, eg on a dedicated build server, you will need to copy these files local to the build server to package them or use another VCS that is secure for application settings.</p><p>In this example, we will be packing the files from a known path on build server.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you are having issues with this step, check the file/folder permissions to the .nuspec and included files</p></div><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/tc-nuget-pack.png" alt=""></p><p><strong>Output directory</strong> is the same as the <strong>Artifact paths</strong> in the <strong>General Settings</strong> of the build configuration for building the application package:</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/tc-build-config-paths.png" alt=""></p><p>So now our build steps for our application build and packaging steps looks like:</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/tc-build-config.png" alt=""></p><p>If everything is building correctly, you should get two <strong>nupkg</strong> files as artifacts from the build configuration, your application and settings package:</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/tc-project-output.png" alt=""></p><p>If you are using TeamCity\u2019s built in NuGet server, these packages are published are available to use from Octopus Deploy.</p><h2 id="octopus-deploy-process-steps" tabindex="-1"><a href="/deploy-multiple-sites-to-aws.html#octopus-deploy-installation-and-initial-setup">Octopus Deploy process steps</a> <a class="header-anchor" href="#octopus-deploy-process-steps" aria-hidden="true">#</a></h2><p>For a <a href="/deploy-multiple-sites-to-aws.html#setting-up-octopus-deploy-projects">simple application</a> with no application settings or SSL certificate to install we only have 2 steps for Octopus Deploy.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/od-simple-example.png" alt=""></p><p>However, due to the need to automate the installation of all the projects dependencies, we have to add at least another 3 steps. We will need the following list of steps to happen before our newly published application is being hosted with the right settings, license and SSL binding.</p><ol><li><strong>Publish settings package</strong></li><li><strong>Install SSL if required</strong></li><li>Deploy Application Package</li><li><strong>Copy Production Settings and License</strong></li><li>Update permissions</li></ol><h2 id="publish-settings-package" tabindex="-1">Publish settings package <a class="header-anchor" href="#publish-settings-package" aria-hidden="true">#</a></h2><p>Publish settings is a &quot;<strong>Deploy Package</strong>&quot; process step looking at the TeamCity NuGet feed and using the new &quot;BenchmarkAnalyzerSettings&quot; package.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/od-publish-settings.png" alt="Publish settings configuration"></p><blockquote><p>If you can\u2019t see the <a href="/deploy-multiple-sites-to-aws.html#octopus-deploy-installation-and-initial-setup">NuGet feed from TeamCity</a>, you need to <a href="http://docs.octopusdeploy.com/display/OD/Package+repositories" target="_blank" rel="noopener noreferrer">set up a new NuGet feed</a> under Library in Octopus Deploy.</p></blockquote><h2 id="install-ssl-if-required" tabindex="-1">Install SSL If Required <a class="header-anchor" href="#install-ssl-if-required" aria-hidden="true">#</a></h2><p>Next we will need to install the SSL certificate if it is not already installed. To do this, we can add some PowerShell within the Octopus Deploy Library under <strong>Script Modules</strong>. A script module can be included in a process step, this gives you the chance to reuse some of the more common PowerShell between steps or projects. In this example, we are going to write some PowerShell to help us <strong>install the certificate</strong>.</p><div class="language-powershell"><pre><code><span class="token keyword">function</span> <span class="token function">Add-SSLCertificateToIIS</span><span class="token punctuation">{</span>
    <span class="token keyword">param</span><span class="token punctuation">(</span><span class="token namespace">[string]</span><span class="token variable">$certPath</span><span class="token punctuation">,</span><span class="token namespace">[string]</span><span class="token variable">$pfxPassword</span><span class="token punctuation">)</span>
    <span class="token function">Write-Output</span> <span class="token string">&quot;Importing certificate into ISS from <span class="token variable">$certPath</span>&quot;</span>
    <span class="token variable">$certMgr</span> = <span class="token function">New-Object</span> <span class="token operator">-</span>ComObject IIS<span class="token punctuation">.</span>CertObj <span class="token operator">-</span>ErrorAction SilentlyContinue    
    <span class="token variable">$certMgr</span><span class="token punctuation">.</span>ImportToCertStore<span class="token punctuation">(</span><span class="token variable">$certPath</span><span class="token punctuation">,</span><span class="token variable">$pfxPassword</span><span class="token punctuation">,</span><span class="token boolean">$true</span><span class="token punctuation">,</span><span class="token boolean">$true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This PowerShell function takes a path of a pfx file, a password and installs it to IIS to be used in a HTTPS binding.</p><p>Once we\u2019ve added this script to a new Script module, we can <strong>call the function from a process step</strong>. If we add a new process step of &quot;Install SSL If Required&quot; and run another script that utilizes our new function, we can install the certificate that was packaged in our settings NuGet package.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/od-ssl-step.png" alt=""></p><p>The script in the screenshot above uses a couple of Octopus Deploy variables, as well as results from previous &quot;Publish settings&quot; step.</p><div class="language-powershell"><pre><code><span class="token function">Write-Output</span> <span class="token string">&quot;Checking SSL certificate&quot;</span>
<span class="token variable">$cert</span> = <span class="token punctuation">(</span> <span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path cert:\\LocalMachine\\My<span class="token punctuation">|</span> ? <span class="token punctuation">{</span> <span class="token variable">$_</span><span class="token punctuation">.</span>subject <span class="token operator">-like</span> <span class="token string">&quot;*cn=<span class="token variable">$CertCn</span>*&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$cert</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Write-Output</span> <span class="token string">&quot;SSL certificate missing, installing...&quot;</span>
    <span class="token variable">$certDirPath</span> = <span class="token variable">$OctopusParameters</span><span class="token punctuation">[</span><span class="token string">&#39;Octopus.Action[Publish settings].Output.Package.InstallationDirectoryPath&#39;</span><span class="token punctuation">]</span>
    <span class="token function">Add-SSLCertificateToIIS</span> <span class="token string">&quot;<span class="token variable">$certDirPath</span>\\<span class="token variable">$CertFileName</span>&quot;</span> <span class="token variable">$SSLKey</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">Write-Output</span> <span class="token string">&quot;SSL present, skipping installation...&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>$SSLKey</code>, <code>$CertFileName</code> and <code>$CertCn</code> are all <strong>Octopus Deploy variables</strong> we have declared in the project variables section, we access them just like any declared PowerShell object.</p><p>The script itself is simply checking the <code>LocalMachine\\My certificate</code> store that contains a specific string in the <strong>subject</strong> property, if no certificate that matches the CN value is present, it installs the certificate from where it was published using an encrypted password stored within Octopus Deploy.</p><p>Generally, this will only install the certificate once on first install of the new virtual machine, but will reinstall it if for whatever reason it has to be manually removed.</p><h2 id="copy-production-settings-and-license" tabindex="-1">Copy Production Settings and License <a class="header-anchor" href="#copy-production-settings-and-license" aria-hidden="true">#</a></h2><p>The last new process step that is included is a straight forward copy from source location to a destination. This step happens <strong>after</strong> the deployment of the application as the destination is not yet known until this step has completed.</p><div class="language-powershell"><pre><code><span class="token variable">$src</span> = <span class="token variable">$OctopusParameters</span><span class="token punctuation">[</span><span class="token string">&#39;Octopus.Action[Publish settings].Output.Package.InstallationDirectoryPath&#39;</span><span class="token punctuation">]</span>
<span class="token variable">$dst</span> = <span class="token variable">$OctopusParameters</span><span class="token punctuation">[</span><span class="token string">&#39;Octopus.Action[Deploy Package].Output.Package.InstallationDirectoryPath&#39;</span><span class="token punctuation">]</span>
<span class="token function">Write-Output</span> <span class="token string">&quot;Copying environment files from <span class="token variable">$src</span> to <span class="token variable">$dst</span>&quot;</span>
<span class="token function">Get-ChildItem</span> <span class="token variable">$src</span> <span class="token punctuation">|</span> <span class="token function">Copy-Item</span> <span class="token operator">-</span>Destination <span class="token variable">$dst</span> <span class="token operator">-</span>Exclude <span class="token string">&quot;*.pfx&quot;</span>
</code></pre></div><p>The script also <strong>excludes copying the pfx certificate</strong> as this is not something we want to host in IIS application. Another step that can be added is one to delete the SSL certificate after step installation so this exclusion wouldn\u2019t be required. Thankfully, there are some templates for common tasks like deleting files are available to add to your Octopus Deploy instance from an <a href="https://github.com/OctopusDeploy/Library" target="_blank" rel="noopener noreferrer">open source project</a>.</p><p>Here is an example of the File System \u2013 Clean Directory template installed and used to clean pfx files from the output directory.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/od-clean-directory.png" alt="View of template once installed"></p><h2 id="using-the-ssl-binding" tabindex="-1">Using the SSL binding <a class="header-anchor" href="#using-the-ssl-binding" aria-hidden="true">#</a></h2><p>We can now set which binding to use in IIS in the Deploy Package step which deploys the main application. To use a specific SSL certificate you will need to provide the <strong>SSL Thumbprint</strong>. An easy way to find the Thumbprint of the certificate is to open the original <strong>.crt</strong> file, select the <strong>Details</strong> tab and select <strong>Properties Only</strong> from the <strong>Show</strong> drop down.</p><p>One you have this value, you will need to provide it in the Add binding menu when adding an IIS binding.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/od-add-binding-https.png" alt="Add HTTPS IIS binding in deployment step"></p><p>This thumbprint associates the binding with the newly installed certificate. Once installed, the certificate will show up in the IIS Management window under Server Certificates and the specified website will have the HTTPS binding associated with the installed certificate.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/iis-certificates.png" alt="IIS Manager after deployment"></p><h2 id="http-binding-redirect" tabindex="-1">HTTP binding redirect <a class="header-anchor" href="#http-binding-redirect" aria-hidden="true">#</a></h2><p>So far we have setup all we need for the HTTPS binding, but since the default protocol when navigating to a site directly is HTTP, we want to setup a URL rewrite so that any requested resource on HTTP is redirected to HTTPS. To so this we will need to add some configuration in the Web.Config.Release transformation.</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>system.webServer</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rewrite</span> <span class="token attr-name"><span class="token namespace">xdt:</span>Transform</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Insert<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rules</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Redirect to HTTPS<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stopProcessing</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>match</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(.*)<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>conditions</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{HTTPS}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>^OFF$<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>conditions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Redirect<span class="token punctuation">&quot;</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://{HTTP_HOST}/{R:1}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">redirectType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SeeOther<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rules</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rewrite</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>system.webServer</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>This configuration uses an IIS module that may or may not be installed on your server. It can be installed via the <a href="http://www.microsoft.com/web/downloads/platform.aspx" target="_blank" rel="noopener noreferrer">Web Platform Installer</a> or installed separately, see the <a href="http://www.iis.net/downloads/microsoft/url-rewrite" target="_blank" rel="noopener noreferrer">IIS site for more details</a>.</p><p>We will <strong>also need a HTTP binding</strong> so the redirects can take place. IIS configuration in Octopus Deploy allows multiple IIS bindings for a deployed package. To add a HTTP binding, it is the same the same as step above, but selecting HTTP from the Protocol drop down.</p><h3 id="managing-settings-files-yourself-vs-octopus-deploy-variables" tabindex="-1">Managing settings files yourself vs Octopus Deploy variables <a class="header-anchor" href="#managing-settings-files-yourself-vs-octopus-deploy-variables" aria-hidden="true">#</a></h3><p>In this example we are storing both the application SSL certificate (.pfx file) for use with IIS, application settings and license in text files we are managing ourselves. To import a certificate and install it onto a new virtual machine we can\u2019t get around the need to deploy the pfx file. However, there are many ways to handle application settings including the ServiceStack license.</p><p>Octopus Deploy has some really useful features when it comes to handling applications settings, even environment specific passwords etc. You could use this for storing the ServiceStack license itself as well as database credentials and other <a href="http://docs.octopusdeploy.com/display/OD/Security+and+encryption" target="_blank" rel="noopener noreferrer">sensitive information</a>.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/od-variables.png" alt="Octopus Deploy Variables"></p><p>Although not used in this example, Octopus Deploy variables can replace web.config <code>appSettings</code> values and then can feed to <a href="/appsettings.html#example-usage">ServiceStack\u2019s AppSettings and its more useful data-structures</a>.</p><p>To enable this functionality, remember to enable it in your application&#39;s deploy step.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/wikis/octopus-deploy-ssl/od-replace-app-settings.png" alt=""></p>`,75),p=[o];function i(l,c,r,u,d,g){return s(),a("div",null,p)}var f=t(e,[["render",i]]);export{k as __pageData,f as default};
