import{_ as a,c as t,o as e,a as s,b as n,e as p}from"./app.14440598.js";const b=`{"title":"AutoQuery RDBMS","description":"","frontmatter":{"slug":"autoquery-rdbms","title":"AutoQuery RDBMS"},"headers":[{"level":3,"title":"AutoQuery Services are ServiceStack Services","slug":"autoquery-services-are-servicestack-services"},{"level":3,"title":"Getting Started","slug":"getting-started"},{"level":3,"title":"Clients continue to benefit from a typed API","slug":"clients-continue-to-benefit-from-a-typed-api"},{"level":3,"title":"IQuery","slug":"iquery"},{"level":3,"title":"Custom AutoQuery Implementations","slug":"custom-autoquery-implementations"},{"level":2,"title":"Returning Custom Results","slug":"returning-custom-results"},{"level":2,"title":"Returning Nested Related Results","slug":"returning-nested-related-results"},{"level":2,"title":"Joining Tables","slug":"joining-tables"},{"level":3,"title":"Joining multiple tables","slug":"joining-multiple-tables"},{"level":3,"title":"Support for LEFT JOINS","slug":"support-for-left-joins"},{"level":2,"title":"Customizable Adhoc Queries","slug":"customizable-adhoc-queries"},{"level":3,"title":"Queries on Collections","slug":"queries-on-collections"},{"level":3,"title":"Customizable Operands","slug":"customizable-operands"},{"level":3,"title":"Customizable Templates","slug":"customizable-templates"},{"level":3,"title":"Formatting Values","slug":"formatting-values"},{"level":3,"title":"Specifying Multi Airity Queries","slug":"specifying-multi-airity-queries"},{"level":3,"title":"Changing Querying Behavior","slug":"changing-querying-behavior"},{"level":3,"title":"Dynamic Attributes","slug":"dynamic-attributes"},{"level":2,"title":"Implicit Conventions","slug":"implicit-conventions"},{"level":3,"title":"Advanced Conventions","slug":"advanced-conventions"},{"level":2,"title":"Explicit Conventions","slug":"explicit-conventions"},{"level":3,"title":"Preemptive client requests","slug":"preemptive-client-requests"},{"level":3,"title":"Advantages of well-defined Service Contracts","slug":"advantages-of-well-defined-service-contracts"},{"level":2,"title":"Raw SQL Filters","slug":"raw-sql-filters"},{"level":2,"title":"Custom Fields","slug":"custom-fields"},{"level":3,"title":"Wildcards","slug":"wildcards"},{"level":3,"title":"DISTINCT Custom Fields","slug":"distinct-custom-fields"},{"level":2,"title":"Paging and Ordering","slug":"paging-and-ordering"},{"level":3,"title":"Multiple OrderBy's","slug":"multiple-orderby-s"},{"level":3,"title":"OrderBy Random","slug":"orderby-random"},{"level":2,"title":"Service Clients Support","slug":"service-clients-support"},{"level":2,"title":"Mime Types and Content-Negotiation","slug":"mime-types-and-content-negotiation"},{"level":3,"title":"CsvFormat","slug":"csvformat"},{"level":2,"title":"Named Connection","slug":"named-connection"},{"level":2,"title":"Include Aggregates in AutoQuery","slug":"include-aggregates-in-autoquery"},{"level":3,"title":"Aggregate Query Usage","slug":"aggregate-query-usage"},{"level":3,"title":"Include Total","slug":"include-total"},{"level":3,"title":"Hybrid AutoQuery Services","slug":"hybrid-autoquery-services"},{"level":3,"title":"IAutoQueryDb API","slug":"iautoquerydb-api"},{"level":3,"title":"AutoQuery Response Filters","slug":"autoquery-response-filters"},{"level":3,"title":"Untyped SqlExpression","slug":"untyped-sqlexpression"},{"level":3,"title":"AutoQuery Property Mapping","slug":"autoquery-property-mapping"},{"level":2,"title":"Extensibility with QueryFilters","slug":"extensibility-with-queryfilters"},{"level":2,"title":"Intercept and Introspect Every Query","slug":"intercept-and-introspect-every-query"},{"level":2,"title":"Exclude AutoQuery Collections from being initialized","slug":"exclude-autoquery-collections-from-being-initialized"},{"level":2,"title":"AutoQuery CRUD Batch Requests","slug":"autoquery-crud-batch-requests"},{"level":2,"title":"AutoQuery Viewer","slug":"autoquery-viewer"},{"level":3,"title":"Live AutoQuery Viewer Examples","slug":"live-autoquery-viewer-examples"},{"level":2,"title":"Northwind","slug":"northwind"},{"level":2,"title":"StackApis","slug":"stackapis"},{"level":2,"title":"AutoQuery Viewer","slug":"autoquery-viewer-1"},{"level":2,"title":"TechStacks Cocoa OSX Desktop App","slug":"techstacks-cocoa-osx-desktop-app"}],"relativePath":"autoquery-rdbms.md","lastUpdated":1634495307610}`,o={},c=s(`__VP_STATIC_START__<p>AutoQuery RDBMS enables the rapid development of high-performance, fully-queryable typed RDBMS data-driven services with just a POCO Request DTO class definition and <a href="https://github.com/ServiceStack/ServiceStack.OrmLite#8-flavours-of-ormlite-is-on-nuget" target="_blank" rel="noopener noreferrer">supports most major RDBMS</a> courtesy of building on <a href="https://github.com/ServiceStack/ServiceStack.OrmLite" target="_blank" rel="noopener noreferrer">OrmLite&#39;s high-performance RDBMS-agnostic API&#39;s</a>.</p><h3 id="autoquery-services-are-servicestack-services" tabindex="-1">AutoQuery Services are ServiceStack Services <a class="header-anchor" href="#autoquery-services-are-servicestack-services" aria-hidden="true">#</a></h3><p>An important point to highlight is that AutoQuery Services are just normal ServiceStack Services, utilizing the same <a href="/order-of-operations.html">Request Pipeline</a>, which can be mapped to any <a href="/routing.html">user-defined route</a>, is available in all <a href="/formats.html">registered formats</a> and can be <a href="/clients-overview.html">consumed from existing typed Service Clients</a>.</p><p>In addition to leveraging ServiceStack&#39;s existing functionality, maximizing re-use in this way reduces the cognitive overhead required for developers who can re-use their existing knowledge in implementing, customizing, introspecting and consuming ServiceStack services.</p><h3 id="getting-started" tabindex="-1">Getting Started <a class="header-anchor" href="#getting-started" aria-hidden="true">#</a></h3><p>Like ServiceStack&#39;s <a href="/plugins.html">other composable features</a>, the AutoQuery Feature is enabled by registering a Plugin, e.g:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span> MaxLimit <span class="token operator">=</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Which is all that&#39;s needed to enable the AutoQuery feature. The AutoQueryFeature is inside <a href="https://servicestack.net/download#get-started" target="_blank" rel="noopener noreferrer">ServiceStack.Server</a> NuGet package which contains value-added features that utilize either OrmLite and Redis which can be added to your project with:</p>__VP_STATIC_END__`,8),u=n("div",{class:"package-reference-box"},[n("div",{class:"flex"},[n("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[n("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[n("p",null,[n("code",null,'<PackageReference Include="ServiceStack.Server" Version="5.*" />')]),p(`
`)])]),n("div",{class:"flex-shrink"},[n("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),n("b")])]),n("div",{class:"copy-text w-full text-right h-6"})],-1),l=s(`__VP_STATIC_START__<p>If you don&#39;t have OrmLite configured it can be registered with a 1-liner by specifying your preferred DialectProvider and Connection String:</p><div class="language-csharp"><pre><code>container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OrmLiteConnectionFactory</span><span class="token punctuation">(</span><span class="token string">&quot;:memory:&quot;</span><span class="token punctuation">,</span> SqliteDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The above config registers an In Memory Sqlite database although as the AutoQuery test suite works in all <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/#download" target="_blank" rel="noopener noreferrer">supported RDBMS providers</a> you&#39;re free to use your registered DB of choice.</p><p>The <code>MaxLimit</code> option ensures each query returns a maximum limit of <strong>100</strong> rows.</p><p>Now that everything&#39;s configured we can create our first service. To implement the ideal API for <a href="/why-not-odata.html">OData&#39;s movie ratings query</a> we just need to define the Request DTO for our service, i.e:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/movies&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FindMovies</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Movie<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> Ratings <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>That&#39;s all the code needed! Which we can now call using the ideal route:</p><div class="language-"><pre><code>/movies?ratings=G,PG-13
</code></pre></div><h3 id="clients-continue-to-benefit-from-a-typed-api" tabindex="-1">Clients continue to benefit from a typed API <a class="header-anchor" href="#clients-continue-to-benefit-from-a-typed-api" aria-hidden="true">#</a></h3><p>and because it&#39;s a just regular Request DTO, we also get an end-to-end typed API for free with:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> movies <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">FindMovies</span> <span class="token punctuation">{</span> Ratings <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;G&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;PG-13&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Whilst that gives us the ideal API we want, the minimum code required is to just declare a new Request DTO with the table you wish to query:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FindMovies</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Movie<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>Which just like other Request DTO&#39;s in ServiceStack falls back to using ServiceStack&#39;s <a href="/routing.html#pre-defined-routes">pre-defined routes</a></p><h3 id="iquery" tabindex="-1">IQuery <a class="header-anchor" href="#iquery" aria-hidden="true">#</a></h3><p><code>QueryDb&lt;T&gt;</code> is just an abstract class that implements <code>IQuery&lt;T&gt;</code> and returns a typed <code>QueryResponse&lt;T&gt;</code>:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb</span><span class="token punctuation">,</span> 
    <span class="token class-name">IQuery<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">IReturn<span class="token punctuation">&lt;</span>QueryResponse<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IQuery</span>
<span class="token punctuation">{</span>
    <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Skip <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>           <span class="token comment">// How many results to skip</span>
    <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Take <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>           <span class="token comment">// How many results to return</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> OrderBy <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>      <span class="token comment">// List of fields to sort by</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> OrderByDesc <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  <span class="token comment">// List of fields to sort by descending</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> Include <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>      <span class="token comment">// Aggregate queries to include</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> Fields <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>       <span class="token comment">// The fields to return</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>IQuery</code> interface includes shared features that all Queries support and acts as a interface marker telling ServiceStack to create query services for each Request DTO.</p><h3 id="custom-autoquery-implementations" tabindex="-1">Custom AutoQuery Implementations <a class="header-anchor" href="#custom-autoquery-implementations" aria-hidden="true">#</a></h3><p>The behavior of queries can be completely customized by simply providing your own Service implementation instead, e.g:</p><div class="language-csharp"><pre><code><span class="token comment">// Override with custom implementation</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyQueryServices</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">IAutoQueryDb</span> AutoQuery <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token comment">// Sync</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token class-name">FindMovies</span> query<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> <span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">GetDb</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateQuery</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">,</span> db<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> AutoQuery<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">,</span> db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Async</span>
    <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token class-name">QueryRockstars</span> query<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> <span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">GetDb</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateQuery</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">,</span> db<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">await</span> AutoQuery<span class="token punctuation">.</span><span class="token function">ExecuteAsync</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">,</span> db<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>    
<span class="token punctuation">}</span>
</code></pre></div><p>This is essentially what the AutoQuery feature generates for each <code>IQuery</code> Request DTO unless a Service for the Request DTO already exists, in which case it uses the existing implementation.</p><p>We can inspect each line to understand how AutoQuery works:</p><p>Resolve the DB Connection for this AutoQuery request:</p><div class="language-csharp"><pre><code><span class="token keyword">using</span> <span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">GetDb</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>By default this follows the <a href="/multitenancy.html">Multitenancy conventions</a> for resolving a DB connection, which you can override with your own custom resolution for this service.</p><p>Creating a populated type SqlExpression:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateQuery</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">,</span> db<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Is an equivalent short-hand version for:</p><div class="language-csharp"><pre><code><span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> queryArgs <span class="token operator">=</span> Request<span class="token punctuation">.</span><span class="token function">GetRequestParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateQuery</span><span class="token punctuation">(</span>dto<span class="token punctuation">,</span> queryArgs<span class="token punctuation">,</span> Request<span class="token punctuation">,</span> db<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Which constructs an <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/#examples" target="_blank" rel="noopener noreferrer">OrmLite SqlExpression</a> from typed properties on the Request DTO as well as any untyped key/value pairs on the HTTP Requests <strong>QueryString</strong> or <strong>FormData</strong>.</p><p>At this point you can inspect the SqlExpression that AutoQuery has constructed or append any additional custom criteria to limit the scope of the request like limiting results to the authenticated user.</p><p>After constructing the query from the Request all that&#39;s left is executing it:</p><div class="language-csharp"><pre><code><span class="token keyword">return</span> AutoQuery<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>dto<span class="token punctuation">,</span> q<span class="token punctuation">,</span> Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>As the implementation is trivial we can show the implementation inline:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name">QueryResponse<span class="token punctuation">&lt;</span>Into<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">Execute</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Into<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token class-name">IDbConnection</span> db<span class="token punctuation">,</span> <span class="token class-name">ISqlExpression</span> query<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> <span class="token punctuation">(</span>SqlExpression<span class="token operator">&lt;</span>From<span class="token operator">&gt;</span><span class="token punctuation">)</span>query<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryResponse<span class="token punctuation">&lt;</span>Into<span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">{</span>
        Offset <span class="token operator">=</span> q<span class="token punctuation">.</span>Offset<span class="token punctuation">.</span><span class="token function">GetValueOrDefault</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        Total <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>db<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span>
        Results <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">LoadSelect</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Into<span class="token punctuation">,</span> From<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Basically just returns the results in an <code>QueryResponse&lt;Into&gt;</code> Response DTO. We also see that each query makes 2 requests, 1 for retrieving the total count for the query and another for the actual results, either limited by the request&#39;s <code>Skip</code> or <code>Take</code> or the configured <code>AutoQueryFeature.MaxLimit</code>.</p><h2 id="returning-custom-results" tabindex="-1">Returning Custom Results <a class="header-anchor" href="#returning-custom-results" aria-hidden="true">#</a></h2><p>To specify returning results in a custom Response DTO you can inherit from the <code>QueryDb&lt;From, Into&gt;</code> convenience base class:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span> Into<span class="token punctuation">&gt;</span></span> 
    <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb</span><span class="token punctuation">,</span> <span class="token class-name">IQuery<span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span> Into<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">IReturn<span class="token punctuation">&lt;</span>QueryResponse<span class="token punctuation">&lt;</span>Into<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre></div><p>As we can tell from the class definition this tells AutoQuery you want to query against <code>From</code> but return results into the specified <code>Into</code> type. This allows being able to return a curated set of columns, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryCustomRockstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">,</span> CustomRockstar<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomRockstar</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> RockstarAlbumName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the example above we&#39;re returning only a subset of results. Unmatched properties like <code>RockstarAlbumName</code> are ignored enabling the re-use of custom DTO&#39;s for different queries.</p><h2 id="returning-nested-related-results" tabindex="-1">Returning Nested Related Results <a class="header-anchor" href="#returning-nested-related-results" aria-hidden="true">#</a></h2><p>AutoQuery also takes advantage of <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/#reference-support-poco-style" target="_blank" rel="noopener noreferrer">OrmLite&#39;s References Support</a> which lets you return related child records that are annotated with <code>[Reference]</code> attribute, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rockstar</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Reference</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span>RockstarAlbum<span class="token punctuation">&gt;</span></span> Albums <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre></div><h2 id="joining-tables" tabindex="-1">Joining Tables <a class="header-anchor" href="#joining-tables" aria-hidden="true">#</a></h2><p>AutoQuery lets us take advantage of OrmLite&#39;s recent <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/#typed-sqlexpression-support-for-joins" target="_blank" rel="noopener noreferrer">support for JOINs in typed SqlExpressions</a></p><p>We can tell AutoQuery to join on multiple tables using the <code>IJoin&lt;T1,T2&gt;</code> interface marker:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstarAlbums</span> 
  <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">,</span>CustomRockstar<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">IJoin<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">,</span>RockstarAlbum<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> RockstarAlbumName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above example tells AutoQuery to query against an <strong>INNER JOIN</strong> of the <code>Rockstar</code> and <code>RockstarAlbum</code> tables using <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/#reference-conventionst" target="_blank" rel="noopener noreferrer">OrmLite&#39;s reference conventions</a> that&#39;s implicit between both tables.</p><p>The Request DTO lets us query against fields across the joined tables where each field is matched with the <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/#selecting-multiple-columns-across-joined-tables" target="_blank" rel="noopener noreferrer">first table containing the field</a>. You can match against fields using the fully qualified <code>{Table}{Field}</code> convention, e.g. <code>RockstarAlbumName</code> queries against the <code>RockstarAlbum</code>.<code>Name</code> column.</p><p>This mapping of fields also applies to the Response DTO where now <code>RockstarAlbumName</code> from the above <code>CustomRockstar</code> type will be populated:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomRockstar</span>
<span class="token punctuation">{</span>
    <span class="token range operator">..</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> RockstarAlbumName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="joining-multiple-tables" tabindex="-1">Joining multiple tables <a class="header-anchor" href="#joining-multiple-tables" aria-hidden="true">#</a></h3><p>Use the appropriate <code>Join&lt;,&gt;</code> generic interface to specify JOINs across multiple tables. AutoQuery supports joining up to 5 tables with 1 <code>Join&lt;&gt;</code> interface, e.g:</p><div class="language-csharp"><pre><code>IJoin<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token punctuation">,</span> T3<span class="token punctuation">,</span> T4<span class="token punctuation">,</span> T5<span class="token operator">&gt;</span>
</code></pre></div><p>Or alternatively any number of tables can be joined together by annotating the Request DTO with multiple <code>IJoin&lt;&gt;</code> interfaces, e.g:</p><div class="language-csharp"><pre><code>IJoin<span class="token operator">&lt;</span>T1<span class="token punctuation">,</span>T2<span class="token operator">&gt;</span><span class="token punctuation">,</span>
IJoin<span class="token operator">&lt;</span>T2<span class="token punctuation">,</span>T3<span class="token operator">&gt;</span><span class="token punctuation">,</span>
IJoin<span class="token operator">&lt;</span>T3<span class="token punctuation">,</span>T4<span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token comment">//...</span>
</code></pre></div><h3 id="support-for-left-joins" tabindex="-1">Support for LEFT JOINS <a class="header-anchor" href="#support-for-left-joins" aria-hidden="true">#</a></h3><p>You can tell AutoQuery to use a <strong>LEFT JOIN</strong> by using the <code>ILeftJoin&lt;,&gt;</code> marker interface instead, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstarAlbumsLeftJoin</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">,</span> CustomRockstar<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> 
    <span class="token class-name">ILeftJoin<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">,</span> RockstarAlbum<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> AlbumName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="customizable-adhoc-queries" tabindex="-1">Customizable Adhoc Queries <a class="header-anchor" href="#customizable-adhoc-queries" aria-hidden="true">#</a></h2><p>The queries up to this point showcase the default behavior of Request DTO fields performing an <strong>Exact Match</strong> using the <code>=</code> operand to match fields on queried tables. Advanced queries are available via configurable attributes illustrated in the example below which uses explicit templates to enable custom querying, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token comment">//Defaults to &#39;AND FirstName = {Value}&#39;</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  

    <span class="token comment">//Collections defaults to &#39;FirstName IN ({Values})&#39;</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> FirstNames <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> 

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Operand <span class="token operator">=</span> <span class="token string">&quot;&gt;=&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Template <span class="token operator">=</span> <span class="token string">&quot;UPPER({Field}) LIKE UPPER({Value})&quot;</span><span class="token punctuation">,</span> 
                Field <span class="token operator">=</span> <span class="token string">&quot;FirstName&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstNameCaseInsensitive <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Template<span class="token operator">=</span><span class="token string">&quot;{Field} LIKE {Value}&quot;</span><span class="token punctuation">,</span> 
                Field<span class="token operator">=</span><span class="token string">&quot;FirstName&quot;</span><span class="token punctuation">,</span> ValueFormat<span class="token operator">=</span><span class="token string">&quot;{0}%&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstNameStartsWith <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Template<span class="token operator">=</span><span class="token string">&quot;{Field} LIKE {Value}&quot;</span><span class="token punctuation">,</span> 
                Field<span class="token operator">=</span><span class="token string">&quot;LastName&quot;</span><span class="token punctuation">,</span> ValueFormat<span class="token operator">=</span><span class="token string">&quot;%{0}&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastNameEndsWith <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Template <span class="token operator">=</span> <span class="token string">&quot;{Field} BETWEEN {Value1} AND {Value2}&quot;</span><span class="token punctuation">,</span> 
                Field<span class="token operator">=</span><span class="token string">&quot;FirstName&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> FirstNameBetween <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Term <span class="token operator">=</span> QueryTerm<span class="token punctuation">.</span>Or<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We&#39;ll go through each of the examples to give a better idea of the customizations available.</p><h3 id="queries-on-collections" tabindex="-1">Queries on Collections <a class="header-anchor" href="#queries-on-collections" aria-hidden="true">#</a></h3><p>ServiceStack properties are case-insensitive and allows populating a collection with comma-delimited syntax, so this query:</p><div class="language-"><pre><code>/rockstars?firstNames=A,B,C
</code></pre></div><p>Will populate the string array:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> FirstNames <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> 
</code></pre></div><p>That by default <code>IEnumerable</code> properties are queried using an SQL <code>{Field} IN ({Values})</code> template which will convert the string array into a quoted and escaped comma-delimited list of values suitable for use in SQL that looks like:</p><div class="language-sql"><pre><code><span class="token string">&quot;FirstName&quot;</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;C&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>The <code>{Field}</code> property is substituted according to the OrmLite FieldDefinition it matches, which for a Joined table with an <code>[Alias(&quot;FName&quot;)]</code> attribute would substitute to a fully-qualified name, e.g: <code>&quot;Table&quot;.&quot;FName&quot;</code></p><p>AutoQuerying also supports pluralized versions by trimming the <code>s</code> off Field names as a fall-back which is how <code>FirstNames</code> was able to match the <code>FirstName</code> table property.</p><h3 id="customizable-operands" tabindex="-1">Customizable Operands <a class="header-anchor" href="#customizable-operands" aria-hidden="true">#</a></h3><p>One of the easiest customization&#39;s available is changing the operand used in the query, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Operand <span class="token operator">=</span> <span class="token string">&quot;&gt;=&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>Will change how the Age is compared to:</p><div class="language-sql"><pre><code><span class="token string">&quot;Age&quot;</span> <span class="token operator">&gt;=</span> {<span class="token keyword">Value</span>}
</code></pre></div><h3 id="customizable-templates" tabindex="-1">Customizable Templates <a class="header-anchor" href="#customizable-templates" aria-hidden="true">#</a></h3><p>By providing a customized template even greater customization achieved and by sticking with TSQL compatible fragments will ensure it&#39;s supported by every RDBMS provider, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Template <span class="token operator">=</span> <span class="token string">&quot;UPPER({Field}) LIKE UPPER({Value})&quot;</span><span class="token punctuation">,</span>
            Field<span class="token operator">=</span><span class="token string">&quot;FirstName&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstNameCaseInsensitive <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>As noted above <code>{Field}</code> variable place holder is substituted with the qualified Table field whilst <code>{Value}</code> gets quoted and escaped to prevent SQL Injections.</p><p>The <code>Field=&quot;FirstName&quot;</code> tells AutoQuery to ignore the property name and use the specified field name.</p><h3 id="formatting-values" tabindex="-1">Formatting Values <a class="header-anchor" href="#formatting-values" aria-hidden="true">#</a></h3><p>You can use the <code>ValueFormat</code> modifier to insert custom characters within the quoted <code>{Value}</code> placeholder which we use to insert the <code>%</code> wildcard in with the quoted value enabling StartsWith and EndsWith queries, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Template<span class="token operator">=</span><span class="token string">&quot;{Field} LIKE {Value}&quot;</span><span class="token punctuation">,</span> 
            Field<span class="token operator">=</span><span class="token string">&quot;FirstName&quot;</span><span class="token punctuation">,</span> ValueFormat<span class="token operator">=</span><span class="token string">&quot;{0}%&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstNameStartsWith <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Template<span class="token operator">=</span><span class="token string">&quot;{Field} LIKE {Value}&quot;</span><span class="token punctuation">,</span> 
            Field<span class="token operator">=</span><span class="token string">&quot;LastName&quot;</span><span class="token punctuation">,</span> ValueFormat<span class="token operator">=</span><span class="token string">&quot;%{0}&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastNameEndsWith <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="specifying-multi-airity-queries" tabindex="-1">Specifying Multi Airity Queries <a class="header-anchor" href="#specifying-multi-airity-queries" aria-hidden="true">#</a></h3><p>An alternate way to format multiple values is to use <code>Value{N}</code> variable placeholders which allows supporting statements with multiple values like SQL&#39;s <strong>BETWEEN</strong> statement:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Template <span class="token operator">=</span> <span class="token string">&quot;{Field} BETWEEN {Value1} AND {Value2}&quot;</span><span class="token punctuation">,</span> 
            Field <span class="token operator">=</span> <span class="token string">&quot;FirstName&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> FirstNameBetween <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="changing-querying-behavior" tabindex="-1">Changing Querying Behavior <a class="header-anchor" href="#changing-querying-behavior" aria-hidden="true">#</a></h3><p>By default queries act like a filter and every condition is combined with <strong>AND</strong> boolean term to further filter the result-set. This can be changed to use an <strong>OR</strong> at the field-level by specifying <code>Term=QueryTerm.Or</code> modifier, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDbField</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Term<span class="token operator">=</span>QueryTerm<span class="token punctuation">.</span>Or<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>However as your API&#39;s should strive to <a href="http://stackoverflow.com/questions/15927475/servicestack-request-dto-design/15941229#15941229" target="_blank" rel="noopener noreferrer">retain the same behavior and call-semantics</a> the recommendation is to instead change the behavior at the API-level so that each property maintains consistent behavior, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">QueryDb</span><span class="token attribute-arguments"><span class="token punctuation">(</span>QueryTerm<span class="token punctuation">.</span>Or<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> Ids <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> Ages <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> FirstNames <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In this example each property is inclusive where every value specified is added to the returned result-set.</p><h3 id="dynamic-attributes" tabindex="-1">Dynamic Attributes <a class="header-anchor" href="#dynamic-attributes" aria-hidden="true">#</a></h3><p>Whilst .NET attributes are normally defined with the property they attribute, ServiceStack also allows attributes to be added dynamically allowing them to be defined elsewhere, detached from the DTO&#39;s, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">QueryRockstars</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">GetProperty</span><span class="token punctuation">(</span><span class="token string">&quot;Age&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddAttributes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryDbFieldAttribute</span> <span class="token punctuation">{</span> Operand <span class="token operator">=</span> <span class="token string">&quot;&gt;=&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="implicit-conventions" tabindex="-1">Implicit Conventions <a class="header-anchor" href="#implicit-conventions" aria-hidden="true">#</a></h2><p>The examples above show how we can define adhoc <strong>explicit</strong> queries on concrete properties using explicit attributes. Whilst this was necessary to understand how to create customized queries, the concrete properties and explicit attributes can be avoided entirely by utilizing the built-in conventions, configurable on the <code>AutoQueryFeature</code> plugin.</p><p>With implicit conventions we can get back to defining Request DTO&#39;s with an empty body:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>The built-in conventions allow using convention-based naming to query fields with expected behavior using self-describing properties. To explore this in more detail lets look at what built-in conventions are defined:</p><div class="language-csharp"><pre><code><span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> GreaterThanOrEqualFormat <span class="token operator">=</span> <span class="token string">&quot;{Field} &gt;= {Value}&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> GreaterThanFormat <span class="token operator">=</span>        <span class="token string">&quot;{Field} &gt;  {Value}&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> LessThanFormat <span class="token operator">=</span>           <span class="token string">&quot;{Field} &lt;  {Value}&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> LessThanOrEqualFormat <span class="token operator">=</span>    <span class="token string">&quot;{Field} &lt;= {Value}&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> NotEqualFormat <span class="token operator">=</span>           <span class="token string">&quot;{Field} &lt;&gt; {Value}&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> IsNull <span class="token operator">=</span>                   <span class="token string">&quot;{Field} IS NULL&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> IsNotNull <span class="token operator">=</span>                <span class="token string">&quot;{Field} IS NOT NULL&quot;</span><span class="token punctuation">;</span>

ImplicitConventions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> 
<span class="token punctuation">{</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Above%&quot;</span><span class="token punctuation">,</span>         GreaterThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;Begin%&quot;</span><span class="token punctuation">,</span>          GreaterThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Beyond%&quot;</span><span class="token punctuation">,</span>        GreaterThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Over%&quot;</span><span class="token punctuation">,</span>          GreaterThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%OlderThan&quot;</span><span class="token punctuation">,</span>      GreaterThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%After%&quot;</span><span class="token punctuation">,</span>         GreaterThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;OnOrAfter%&quot;</span><span class="token punctuation">,</span>      GreaterThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%From%&quot;</span><span class="token punctuation">,</span>          GreaterThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;Since%&quot;</span><span class="token punctuation">,</span>          GreaterThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;Start%&quot;</span><span class="token punctuation">,</span>          GreaterThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Higher%&quot;</span><span class="token punctuation">,</span>        GreaterThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;&gt;%&quot;</span><span class="token punctuation">,</span>              GreaterThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%&gt;&quot;</span><span class="token punctuation">,</span>              GreaterThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%!&quot;</span><span class="token punctuation">,</span>              NotEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;&lt;&gt;%&quot;</span><span class="token punctuation">,</span>             NotEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token punctuation">{</span><span class="token string">&quot;%GreaterThanOrEqualTo%&quot;</span><span class="token punctuation">,</span> GreaterThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%GreaterThan%&quot;</span><span class="token punctuation">,</span>          GreaterThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%LessThan%&quot;</span><span class="token punctuation">,</span>             LessThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%LessThanOrEqualTo%&quot;</span><span class="token punctuation">,</span>    LessThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%NotEqualTo&quot;</span><span class="token punctuation">,</span>            NotEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token punctuation">{</span><span class="token string">&quot;Behind%&quot;</span><span class="token punctuation">,</span>         LessThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Below%&quot;</span><span class="token punctuation">,</span>         LessThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Under%&quot;</span><span class="token punctuation">,</span>         LessThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Lower%&quot;</span><span class="token punctuation">,</span>         LessThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Before%&quot;</span><span class="token punctuation">,</span>        LessThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%YoungerThan&quot;</span><span class="token punctuation">,</span>    LessThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;OnOrBefore%&quot;</span><span class="token punctuation">,</span>     LessThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;End%&quot;</span><span class="token punctuation">,</span>            LessThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;Stop%&quot;</span><span class="token punctuation">,</span>           LessThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;To%&quot;</span><span class="token punctuation">,</span>             LessThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;Until%&quot;</span><span class="token punctuation">,</span>          LessThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%&lt;&quot;</span><span class="token punctuation">,</span>              LessThanOrEqualFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;&lt;%&quot;</span><span class="token punctuation">,</span>              LessThanFormat<span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token punctuation">{</span><span class="token string">&quot;Like%&quot;</span><span class="token punctuation">,</span>           <span class="token string">&quot;UPPER({Field}) LIKE UPPER({Value})&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%In&quot;</span><span class="token punctuation">,</span>             <span class="token string">&quot;{Field} IN ({Values})&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Ids&quot;</span><span class="token punctuation">,</span>            <span class="token string">&quot;{Field} IN ({Values})&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%Between%&quot;</span><span class="token punctuation">,</span>       <span class="token string">&quot;{Field} BETWEEN {Value1} AND {Value2}&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            
    <span class="token punctuation">{</span><span class="token string">&quot;%IsNull&quot;</span><span class="token punctuation">,</span>         IsNull<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;%IsNotNull&quot;</span><span class="token punctuation">,</span>      IsNotNull<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

EndsWithConventions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> QueryDbFieldAttribute<span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token punctuation">{</span> <span class="token string">&quot;StartsWith&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryDbFieldAttribute</span> <span class="token punctuation">{</span> 
          Template<span class="token operator">=</span> <span class="token string">&quot;UPPER({Field}) LIKE UPPER({Value})&quot;</span><span class="token punctuation">,</span> 
          ValueFormat<span class="token operator">=</span> <span class="token string">&quot;{0}%&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string">&quot;Contains&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryDbFieldAttribute</span> <span class="token punctuation">{</span> 
          Template<span class="token operator">=</span> <span class="token string">&quot;UPPER({Field}) LIKE UPPER({Value})&quot;</span><span class="token punctuation">,</span> 
          ValueFormat<span class="token operator">=</span> <span class="token string">&quot;%{0}%&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string">&quot;EndsWith&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryDbFieldAttribute</span> <span class="token punctuation">{</span> 
          Template<span class="token operator">=</span> <span class="token string">&quot;UPPER({Field}) LIKE UPPER({Value})&quot;</span><span class="token punctuation">,</span> 
          ValueFormat<span class="token operator">=</span> <span class="token string">&quot;%{0}&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The string key in the above dictionaries describe what property each rule maps to. We&#39;ll run through a few examples to see how we can make use of them:</p><p>The request below works as you would expect in returning all Rockstars older than 42 years of age.</p><div class="language-"><pre><code>/rockstars?AgeOlderThan=42
</code></pre></div><p>It works by matching on the rule since <code>AgeOlderThan</code> does indeed ends with <code>OlderThan</code>:</p><div class="language-csharp"><pre><code><span class="token punctuation">{</span><span class="token string">&quot;%OlderThan&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;{Field} &gt; {Value}&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>The <code>%</code> wildcard is a placeholder for the field name which resolves to <code>Age</code>. Now that it has a match it creates a query with the defined <code>{Field} &gt; {Value}</code> template to achieve the desired behavior.</p><p>If you instead wanted to use the inclusive <code>&gt;=</code> operand, we can just use a rule with the <code>&gt;=</code> template:</p><div class="language-"><pre><code>/rockstars?AgeGreaterThanOrEqualTo=42
</code></pre></div><p>Which matches the rule:</p><div class="language-csharp"><pre><code><span class="token punctuation">{</span><span class="token string">&quot;%GreaterThanOrEqualTo%&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;{Field} &gt;= {Value}&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>And when the wildcard is on both ends of the pattern:</p><div class="language-csharp"><pre><code><span class="token punctuation">{</span><span class="token string">&quot;%GreaterThan%&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;{Field} &gt; {Value}&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>So to can the field name, which matches both these rules:</p><div class="language-"><pre><code>/rockstars?AgeGreaterThan=42
/rockstars?GreaterThanAge=42
</code></pre></div><p>An alternative to using wordy suffixes are the built-in short-hand syntax:</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><strong>&gt;Age</strong></td><td><code>Age &gt;= {Value}</code></td></tr><tr><td><strong>Age&gt;</strong></td><td><code>Age &gt; {Value}</code></td></tr><tr><td><strong>&lt;Age</strong></td><td><code>Age &lt; {Value}</code></td></tr><tr><td><strong>Age&lt;</strong></td><td><code>Age &lt;= {Value}</code></td></tr></tbody></table><p>Which uses the appropriate operand based on whether the <code>&lt;</code> <code>&gt;</code> operators come before or after the field name:</p><div class="language-"><pre><code>/rockstars?&gt;Age=42
/rockstars?Age&gt;=42
/rockstars?&lt;Age=42
/rockstars?Age&lt;=42
</code></pre></div><p>The use of <code>{Values}</code> or the <code>Value{N}</code> formats specifies the query should be treated as a collection, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">{</span><span class="token string">&quot;%Ids&quot;</span><span class="token punctuation">,</span>       <span class="token string">&quot;{Field} IN ({Values})&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span><span class="token string">&quot;%In&quot;</span><span class="token punctuation">,</span>        <span class="token string">&quot;{Field} IN ({Values})&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span><span class="token string">&quot;%Between%&quot;</span><span class="token punctuation">,</span>  <span class="token string">&quot;{Field} BETWEEN {Value1} AND {Value2}&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>Which allows multiple values to be specified on the QueryString:</p><div class="language-"><pre><code>/rockstars?Ids=1,2,3
/rockstars?FirstNamesIn=Jim,Kurt
/rockstars?FirstNameBetween=A,F
</code></pre></div><h3 id="advanced-conventions" tabindex="-1">Advanced Conventions <a class="header-anchor" href="#advanced-conventions" aria-hidden="true">#</a></h3><p>More advanced conventions can be specified directly on the <code>StartsWithConventions</code> and <code>EndsWithConventions</code> dictionaries which allow customizations using the full <code>[QueryDbField]</code> attribute, e.g:</p><div class="language-csharp"><pre><code>EndsWithConventions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> QueryDbFieldAttribute<span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token punctuation">{</span> <span class="token string">&quot;StartsWith&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryDbFieldAttribute</span> <span class="token punctuation">{</span> 
          Template <span class="token operator">=</span> <span class="token string">&quot;UPPER({Field}) LIKE UPPER({Value})&quot;</span><span class="token punctuation">,</span> 
          ValueFormat <span class="token operator">=</span> <span class="token string">&quot;{0}%&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string">&quot;Contains&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryDbFieldAttribute</span> <span class="token punctuation">{</span> 
          Template <span class="token operator">=</span> <span class="token string">&quot;UPPER({Field}) LIKE UPPER({Value})&quot;</span><span class="token punctuation">,</span> 
          ValueFormat <span class="token operator">=</span> <span class="token string">&quot;%{0}%&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string">&quot;EndsWith&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryDbFieldAttribute</span> <span class="token punctuation">{</span> 
          Template <span class="token operator">=</span> <span class="token string">&quot;UPPER({Field}) LIKE UPPER({Value})&quot;</span><span class="token punctuation">,</span> 
          ValueFormat <span class="token operator">=</span> <span class="token string">&quot;%{0}&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>that can be called as normal:</p><div class="language-"><pre><code>/rockstars?FirstNameStartsWith=Jim
/rockstars?LastNameEndsWith=son
/rockstars?RockstarAlbumNameContains=e
</code></pre></div><p>This also shows that Implicit Conventions can also apply to joined table fields like <code>RockstarAlbumNameContains</code> using the fully qualified <code>{Table}{Field}</code> reference convention.</p><h2 id="explicit-conventions" tabindex="-1">Explicit Conventions <a class="header-anchor" href="#explicit-conventions" aria-hidden="true">#</a></h2><p>Whilst Implicit conventions can be called on an empty &quot;contract-less&quot; DTO, you&#39;re also able to specify the concrete properties for the conventions you end up using:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> AgeOlderThan <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> AgeGreaterThanOrEqualTo <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> AgeGreaterThan <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> GreaterThanAge <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstNameStartsWith <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastNameEndsWith <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastNameContains <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> RockstarAlbumNameContains <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> RockstarIdAfter <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> RockstarIdOnOrAfter <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="preemptive-client-requests" tabindex="-1">Preemptive client requests <a class="header-anchor" href="#preemptive-client-requests" aria-hidden="true">#</a></h3><p>A hidden gem in AutoQuery&#39;s approach that&#39;s not immediately obvious is how everything will still work when concrete properties are only added to client Request DTO&#39;s that the server doesn&#39;t even know about yet! This is possible as the service client generates the same HTTP Request that matches the implicit conventions, making it possible to perform new preemptive typed queries on the client without having to redeploy the server. Although unlikely to be a popular use-case given that in most cases the client and server shares the same DTOs, it&#39;s a nice surprise feature when needed.</p><h3 id="advantages-of-well-defined-service-contracts" tabindex="-1">Advantages of well-defined Service Contracts <a class="header-anchor" href="#advantages-of-well-defined-service-contracts" aria-hidden="true">#</a></h3><p>The advantages of formalizing the conventions you end up using is that they can be consumed with ServiceStack&#39;s <a href="/csharp-client.html">Typed Service Clients</a>:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryRockstars</span> <span class="token punctuation">{</span> AgeOlderThan <span class="token operator">=</span> <span class="token number">42</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>As well as making your API self-describing and gives you access to all of ServiceStack&#39;s metadata services including:</p><ul><li><a href="/metadata-page.html">Metadata pages</a></li><li><a href="/swagger-api.html">Swagger UI</a></li><li><a href="/postman.html">Postman Support</a></li></ul><p>Which is why we recommend formalizing your conventions you want to allow before deploying your API to production.</p><p>When publishing your API, you can also assert that only explicit conventions are ever used by disabling untyped implicit conventions support with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span> EnableUntypedQueries <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="raw-sql-filters" tabindex="-1">Raw SQL Filters <a class="header-anchor" href="#raw-sql-filters" aria-hidden="true">#</a></h2><p>It&#39;s also possible to specify Raw SQL Filters. Whilst offering greater flexibility they also suffer from many of the problems that OData&#39;s expressions have.</p><p>Raw SQL Filters also don&#39;t benefit from limiting matching to declared fields and auto-escaping and quoting of values although they&#39;re still validated against OrmLite&#39;s <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/blob/master/src/ServiceStack.OrmLite/OrmLiteUtilExtensions.cs#L172" target="_blank" rel="noopener noreferrer">IllegalSqlFragmentTokens</a> to protect against SQL Injection attacks. But as they still allow calling SQL Functions, Raw SqlFilters shouldn&#39;t be enabled when accessible by untrusted parties unless they&#39;ve been configured to use a <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/#multi-nested-database-connections" target="_blank" rel="noopener noreferrer">Named OrmLite DB Connection</a> which is read-only and locked-down so that it only has access to what it&#39;s allowed to.</p><p>If safe to do so, RawSqlFilters can be enabled with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span> 
    EnableRawSqlFilters <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    UseNamedConnection <span class="token operator">=</span> <span class="token string">&quot;readonly&quot;</span><span class="token punctuation">,</span>
    IllegalSqlFragmentTokens <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;ProtectedSqlFunction&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Once enabled you can use the <code>_select</code>, <code>_from</code>, <code>_where</code> modifiers to append custom SQL Fragments, e.g:</p><div class="language-"><pre><code>/rockstars?_select=FirstName,LastName

/rockstars?_where=Age &gt; 42
/rockstars?_where=FirstName LIKE &#39;Jim%&#39;

/rockstars?_select=FirstName&amp;_where=LastName = &#39;Cobain&#39;

/rockstars?_from=Rockstar r INNER JOIN RockstarAlbum a ON r.Id = a.RockstarId
</code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>url encoding in the above examples are omitted for readability</p></div><p>Whilst Raw SqlFilters affect the query executed, they don&#39;t change what Response DTO is returned.</p><h2 id="custom-fields" tabindex="-1">Custom Fields <a class="header-anchor" href="#custom-fields" aria-hidden="true">#</a></h2><p>You can also customize which fields you want returned using the <code>Fields</code> property available on all AutoQuery Services, e.g:</p><div class="language-"><pre><code>?Fields=Id,Name,Description,JoinTableId
</code></pre></div><p>The Fields still need to be defined on the Response DTO as this feature doesn&#39;t change the Response DTO Schema, only which fields are populated. This does change the underlying RDBMS SELECT that&#39;s executed, also benefiting from reduced bandwidth between your RDBMS and App Server.</p><p>A useful <a href="/customize-json-responses.html">JSON customization</a> that you can add when specifying custom fields is <code>ExcludeDefaultValues</code>, e.g:</p><div class="language-"><pre><code>/query?Fields=Id,Name,Description,JoinTableId&amp;jsconfig=ExcludeDefaultValues
</code></pre></div><p>Which will remove any value type fields with a <strong>default value</strong> from the JSON response, e.g:</p><ul><li><a href="http://github.servicestack.net/repos.json?fields=Name,Homepage,Language,Updated_At" target="_blank" rel="noopener noreferrer">github.servicestack.net/repos.json?fields=Name,Homepage,Language,Updated_At</a></li><li><a href="http://github.servicestack.net/repos.json?fields=Name,Homepage,Language,Updated_At&amp;jsconfig=ExcludeDefaultValues" target="_blank" rel="noopener noreferrer">github.servicestack.net/repos.json?fields=Name,Homepage,Language,Updated_At&amp;jsconfig=ExcludeDefaultValues</a></li></ul><h3 id="wildcards" tabindex="-1">Wildcards <a class="header-anchor" href="#wildcards" aria-hidden="true">#</a></h3><p>You can use <strong>wildcards</strong> to quickly reference all fields on a table using the <code>table.*</code> format, e.g:</p><div class="language-"><pre><code>?fields=id,departmentid,department,employee.*
</code></pre></div><p>Which is a shorthand that expands to manually listing each field in the <code>Employee</code> table, useful for queries which joins multiple tables, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/employees&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryEmployees</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
    <span class="token class-name">IJoin<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">,</span> EmployeeType<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
    <span class="token class-name">IJoin<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">,</span> Department<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
    <span class="token class-name">IJoin<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">,</span> Title<span class="token punctuation">&gt;</span></span></span> 
<span class="token punctuation">{</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="distinct-custom-fields" tabindex="-1">DISTINCT Custom Fields <a class="header-anchor" href="#distinct-custom-fields" aria-hidden="true">#</a></h3><p>To query only results with distinct fields you can prefix the custom fields list with <code>DISTINCT </code>, e.g</p><p>Using QueryString:</p><div class="language-"><pre><code>?Fields=DISTINCT City,Country
</code></pre></div><p>Using C# Client:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryCustomers</span> <span class="token punctuation">{</span> 
    Fields <span class="token operator">=</span> <span class="token string">&quot;DISTINCT City,Country&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>We can use this feature with Northwind&#39;s existing <a href="https://github.com/NetCoreApps/Northwind/blob/master/src/Northwind.ServiceModel/AutoQuery.cs" target="_blank" rel="noopener noreferrer">AutoQuery Request DTOs</a>:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/query/customers&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryCustomers</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre></div><p>To return all unique City and Countries of Northwind Customers with:</p><ul><li><a href="http://northwind.netcore.io/query/customers?Fields=DISTINCT%20City,Country" target="_blank" rel="noopener noreferrer">northwind.netcore.io/query/customers?Fields=DISTINCT City,Country</a></li></ul><p>Or to just return their unique Countries they&#39;re in:</p><ul><li><a href="http://northwind.netcore.io/query/customers?Fields=DISTINCT%20Country" target="_blank" rel="noopener noreferrer">northwind.netcore.io/query/customers?Fields=DISTINCT Country</a></li></ul><h2 id="paging-and-ordering" tabindex="-1">Paging and Ordering <a class="header-anchor" href="#paging-and-ordering" aria-hidden="true">#</a></h2><p>Some functionality defined on the core <code>IQuery</code> interface and available to all queries is the ability to page and order results:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IQuery</span>
<span class="token punctuation">{</span>
    <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Skip <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Take <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> OrderBy <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token return-type class-name"><span class="token keyword">string</span></span> OrderByDesc <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This works as you would expect where you can modify the returned result set with:</p><div class="language-"><pre><code>/rockstars?skip=10&amp;take=20&amp;orderBy=Id
</code></pre></div><p>Or when accessing via a ServiceClient:</p><div class="language-csharp"><pre><code>client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryRockstars</span> <span class="token punctuation">{</span> Skip<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> Take<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> OrderBy<span class="token operator">=</span><span class="token string">&quot;Id&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When results are paged an implicit OrderBy is added using the PrimaryKey of the <code>IQuery&lt;Table&gt;</code> to ensure predictable ordering of results are returned. You can change the OrderBy used by specifying your own:</p><div class="language-csharp"><pre><code>client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryRockstars</span> <span class="token punctuation">{</span> Skip<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> Take<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> OrderByDesc<span class="token operator">=</span><span class="token string">&quot;Id&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Or remove the default behavior with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span> 
    OrderByPrimaryKeyOnPagedQuery <span class="token operator">=</span> <span class="token boolean">false</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="multiple-orderby-s" tabindex="-1">Multiple OrderBy&#39;s <a class="header-anchor" href="#multiple-orderby-s" aria-hidden="true">#</a></h3><p>AutoQuery also supports specifying multiple OrderBy&#39;s with a comma-delimited list of field names, e.g:</p><div class="language-"><pre><code>/rockstars?orderBy=Id,Age,FirstName
</code></pre></div><p>Same request via Service Client:</p><div class="language-csharp"><pre><code>client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryRockstars</span> <span class="token punctuation">{</span> OrderBy <span class="token operator">=</span> <span class="token string">&quot;Id,Age,FirstName&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="sort-specific-fields-in-reverse-order" tabindex="-1">Sort specific fields in reverse order <a class="header-anchor" href="#sort-specific-fields-in-reverse-order" aria-hidden="true">#</a></h4><p>When specifying multiple order by&#39;s you can sort specific fields in reverse order by prepending a <code>-</code> before the field name, e.g:</p><div class="language-"><pre><code>?orderBy=Id,-Age,FirstName
?orderByDesc=-Id,Age,-FirstName
</code></pre></div><h3 id="orderby-random" tabindex="-1">OrderBy Random <a class="header-anchor" href="#orderby-random" aria-hidden="true">#</a></h3><p><code>OrderBy</code> includes special support for returning results in Random order using <code>Random</code>, e.g:</p><div class="language-"><pre><code>/rockstars?OrderBy=Random
</code></pre></div><p>Using Service Client:</p><div class="language-csharp"><pre><code>client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryRockstars</span> <span class="token punctuation">{</span> OrderBy <span class="token operator">=</span> <span class="token string">&quot;Random&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="service-clients-support" tabindex="-1">Service Clients Support <a class="header-anchor" href="#service-clients-support" aria-hidden="true">#</a></h2><p>One of the major benefits of using Typed DTO&#39;s to define your Service Contract is that it allows usage of ServiceStack&#39;s <a href="/csharp-client.html">.NET Service Clients</a> which enables an end-to-end API without code-gen for <a href="https://github.com/ServiceStack/Hello" target="_blank" rel="noopener noreferrer">most .NET and PCL client platforms</a>.</p><p>With the richer semantics available in queries, we&#39;ve been able to enhance the Service Clients new <code>GetLazy()</code> API that allows lazy streaming of responses to provide transparent paging of large result-sets, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> results <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetLazy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryMovies</span> <span class="token punctuation">{</span> 
    Ratings <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;G&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;PG-13&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Since GetLazy returns a lazy <code>IEnumerable&lt;T&gt;</code> sequence it can also be used within LINQ expressions, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> top250 <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetLazy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryMovies</span> <span class="token punctuation">{</span> 
        Ratings <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PG-13&quot;</span> <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">ConvertTo</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Title<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="mime-types-and-content-negotiation" tabindex="-1">Mime Types and Content-Negotiation <a class="header-anchor" href="#mime-types-and-content-negotiation" aria-hidden="true">#</a></h2><p>Another benefit we get from AutoQuery Services being regular ServiceStack services is taking advantage of <a href="/formats.html">ServiceStack&#39;s built-in formats</a>.</p><h3 id="csvformat" tabindex="-1">CsvFormat <a class="header-anchor" href="#csvformat" aria-hidden="true">#</a></h3><p>The <a href="/csv-format.html">CSV Format</a> especially shines here given queries return a single tabular resultset making it perfect for CSV. In many ways CSV is one of the most interoperable Data Formats given most data import and manipulation programs including Databases and Spreadsheets have native support for CSV allowing for deep and seamless integration.</p><p>ServiceStack provides a number of ways to <a href="/routing.html#content-negotiation">request your preferred content-type</a>, the easiest of which is to just use the <code>.{format}</code> extension at the end of the <code>/pathinfo</code> e.g:</p><div class="language-"><pre><code>/rockstars.csv
/movies.csv?ratings=G,PG-13
</code></pre></div><p><a href="/csv-format.html">CSV Format</a> responses can use the same <a href="/customize-json-responses.html">scoped custom responses as JSON</a> to allow Typed Results to exclude default values columns when returning limited <a href="/autoquery-rdbms.html#custom-fields">custom fields with <code>?fields</code></a>:</p><ul><li>Camel Humps Notation: <code>?jsconfig=edf</code></li><li>Full configuration: <code>?jsconfig=ExcludeDefaultValues</code></li></ul><h2 id="named-connection" tabindex="-1">Named Connection <a class="header-anchor" href="#named-connection" aria-hidden="true">#</a></h2><p>AutoQuery can also easily be configured to query any number of different databases registered in your AppHost.</p><p>In the example below we configure our main RDBMS to use SQL Server and register a <strong>Named Connection</strong> to point to a <strong>Reporting</strong> PostgreSQL RDBMS:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> dbFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OrmLiteConnectionFactory</span><span class="token punctuation">(</span>connString<span class="token punctuation">,</span> SqlServer2012Dialect<span class="token punctuation">.</span>Provider<span class="token punctuation">)</span><span class="token punctuation">;</span>
container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>dbFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

dbFactory<span class="token punctuation">.</span><span class="token function">RegisterConnection</span><span class="token punctuation">(</span><span class="token string">&quot;Reporting&quot;</span><span class="token punctuation">,</span> pgConnString<span class="token punctuation">,</span> PostgreSqlDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Any normal AutoQuery Services like <code>QueryOrders</code> will use the default SQL Server connection whilst <code>QuerySales</code> will execute its query on the PostgreSQL <code>Reporting</code> Database instead:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryOrders</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Order<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ConnectionInfo</span><span class="token attribute-arguments"><span class="token punctuation">(</span>NamedConnection <span class="token operator">=</span> <span class="token string">&quot;Reporting&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuerySales</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Sales<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>An alternative to specifying the <code>[ConnectionInfo]</code> Request Filter Attribute on the AutoQuery Request DTO, is to specify the named connection on the <strong>POCO Table</strong> instead, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">NamedConnection</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;Reporting&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Sales</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuerySales</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Sales<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="include-aggregates-in-autoquery" tabindex="-1">Include Aggregates in AutoQuery <a class="header-anchor" href="#include-aggregates-in-autoquery" aria-hidden="true">#</a></h2><p>AutoQuery supports running additional Aggregate queries on the queried result-set. To include aggregates in your Query&#39;s response specify them in the <code>Include</code> property of your AutoQuery Request DTO, e.g:</p><div class="language-cs"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryRockstars</span> <span class="token punctuation">{</span> Include <span class="token operator">=</span> <span class="token string">&quot;COUNT(*)&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Or in the <code>Include</code> QueryString param if you&#39;re calling AutoQuery Services from a browser, e.g:</p><div class="language-"><pre><code>/rockstars?include=COUNT(*)
</code></pre></div><p>The result is then published in the <code>QueryResponse&lt;T&gt;.Meta</code> String Dictionary and is accessible with:</p><div class="language-"><pre><code>response.Meta[&quot;COUNT(*)&quot;] //= 7
</code></pre></div><p>By default any of the functions in the SQL Aggregate whitelist can be referenced:</p><div class="language-"><pre><code>AVG, COUNT, FIRST, LAST, MAX, MIN, SUM
</code></pre></div><p>Which can be added to or removed from by modifying <code>SqlAggregateFunctions</code> collection, e.g, you can allow usage of a <code>CustomAggregate</code> SQL Function with:</p><div class="language-cs"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span> 
    SqlAggregateFunctions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;CustomAggregate&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="aggregate-query-usage" tabindex="-1">Aggregate Query Usage <a class="header-anchor" href="#aggregate-query-usage" aria-hidden="true">#</a></h3><p>The syntax for aggregate functions is modelled after their usage in SQL so they&#39;re instantly familiar. At its most basic usage you can just specify the name of the aggregate function which will use <code>*</code> as a default argument so you can also query <code>COUNT(*)</code> with:</p><div class="language-"><pre><code>?include=COUNT
</code></pre></div><p>It also supports SQL aliases:</p><div class="language-"><pre><code>COUNT(*) Total
COUNT(*) as Total
</code></pre></div><p>Which is used to change what key the result is saved into:</p><div class="language-cs"><pre><code>response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span><span class="token string">&quot;Total&quot;</span><span class="token punctuation">]</span>
</code></pre></div><p>Columns can be referenced by name:</p><div class="language-"><pre><code>COUNT(LivingStatus)
</code></pre></div><p>If an argument matches a column in the primary table the literal reference is used as-is, if it matches a column in a joined table it&#39;s replaced with its fully-qualified reference and when it doesn&#39;t match any column, Numbers are passed as-is otherwise its automatically escaped and quoted and passed in as a string literal.</p><p>The <code>DISTINCT</code> modifier can also be used, so a complex example looks like:</p><div class="language-"><pre><code>COUNT(DISTINCT LivingStatus) as UniqueStatus
</code></pre></div><p>Which saves the result of the above function in:</p><div class="language-cs"><pre><code>response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span><span class="token string">&quot;UniqueStatus&quot;</span><span class="token punctuation">]</span>
</code></pre></div><p>Any number of aggregate functions can be combined in a comma-delimited list:</p><div class="language-"><pre><code>Count(*) Total, Min(Age), AVG(Age) AverageAge
</code></pre></div><p>Which returns results in:</p><div class="language-cs"><pre><code>response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span><span class="token string">&quot;Total&quot;</span><span class="token punctuation">]</span>
response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span><span class="token string">&quot;Min(Age)&quot;</span><span class="token punctuation">]</span>
response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span><span class="token string">&quot;AverageAge&quot;</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="include-total" tabindex="-1">Include Total <a class="header-anchor" href="#include-total" aria-hidden="true">#</a></h3><p>The total records available for a query can be included in the Response by adding it on the QueryString, e.g:</p><div class="language-"><pre><code>/query?Include=Total
</code></pre></div><p>Or on the Request DTO:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">MyQuery</span> <span class="token punctuation">{</span> Include <span class="token operator">=</span> <span class="token string">&quot;Total&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Alternatively you can always have the Total returned in every request with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span>
    IncludeTotal <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="aggregate-query-performance" tabindex="-1">Aggregate Query Performance <a class="header-anchor" href="#aggregate-query-performance" aria-hidden="true">#</a></h4><p>AutoQuery combines all other aggregate functions like <code>Total</code> and executes them in the same a single query for optimal performance.</p><h3 id="hybrid-autoquery-services" tabindex="-1">Hybrid AutoQuery Services <a class="header-anchor" href="#hybrid-autoquery-services" aria-hidden="true">#</a></h3><p>AutoQuery Services can be easily enhanced by creating a custom Service implementation that modifies the <code>SqlExpression</code> Query that AutoQuery auto populates from the incoming request. In addition to using OrmLite&#39;s typed API to perform standard DB queries you can also take advantage of advanced RDBMS features with custom SQL fragments. As an example we&#39;ll look at the implementation of <a href="https://github.com/NetCoreApps/TechStacks" target="_blank" rel="noopener noreferrer">techstacks.io</a> fundamental <a href="https://github.com/NetCoreApps/TechStacks/blob/master/src/TechStacks.ServiceInterface/PostPublicServices.cs" target="_blank" rel="noopener noreferrer">QueryPosts Service</a> which powers every Post feed in TechStacks where its custom implementation inherits all queryable functionality of its <code>QueryDb&lt;Post&gt;</code> AutoQuery Service and adds high-level functionality for <code>AnyTechnologyIds</code> and <code>Is</code> custom high-level properties that&#39;s used to query multiple columns behind-the-scenes.</p><p>In addition to inheriting all default Querying functionality in a <code>QueryDb&lt;Post&gt;</code> AutoQuery Service, the custom implementation also:</p><ul><li>Prevents returning any <code>Deleted</code> Posts</li><li>Prevents returning any posts with a <code>closed</code> status unless the query specifically targets a closed label or status</li><li>Avoids any table joins by using PostgreSQL advanced Array data type for querying post <code>string</code> <strong>labels</strong> or <code>int</code> <strong>technology ids</strong></li><li>Uses <code>AnyTechnologyIds</code> to return any posts <strong>tagged with</strong> the specified technologies</li></ul><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/posts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryPosts</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Post<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// Handled by AutoQuery</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> Ids <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> OrganizationId <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> OrganizationIds <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> Types <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token comment">// Handled by Custom Implementation</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> AnyTechnologyIds <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> Is <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CacheResponse</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Duration <span class="token operator">=</span> <span class="token number">600</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PostPublicServices</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">PostServicesBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">IAutoQueryDb</span> AutoQuery <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token class-name">QueryPosts</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> <span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">GetDb</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateQuery</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">,</span> db<span class="token punctuation">)</span> <span class="token comment">//Populated SqlExpression</span>

        q<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Deleted <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name"><span class="token keyword">var</span></span> states <span class="token operator">=</span> request<span class="token punctuation">.</span>Is <span class="token operator">??</span> TypeConstants<span class="token punctuation">.</span>EmptyStringArray<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>states<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;closed&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> states<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;completed&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> states<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span><span class="token string">&quot;declined&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            q<span class="token punctuation">.</span><span class="token function">And</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Status <span class="token operator">==</span> <span class="token string">&quot;closed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            q<span class="token punctuation">.</span><span class="token function">And</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Hidden <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>Status <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> x<span class="token punctuation">.</span>Status <span class="token operator">!=</span> <span class="token string">&quot;closed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>states<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> labelSlugs <span class="token operator">=</span> states<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token operator">!=</span> <span class="token string">&quot;closed&quot;</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">!=</span> <span class="token string">&quot;open&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">Map</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">GenerateSlug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>labelSlugs<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                q<span class="token punctuation">.</span><span class="token function">And</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">PgSql<span class="token punctuation">.</span><span class="token function">Array</span><span class="token punctuation">(</span>labelSlugs<span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string"> &amp;&amp; labels&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>request<span class="token punctuation">.</span>AnyTechnologyIds<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            q<span class="token punctuation">.</span><span class="token function">And</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">PgSql<span class="token punctuation">.</span><span class="token function">Array</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>AnyTechnologyIds<span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string"> &amp;&amp; technology_ids&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> AutoQuery<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above implementation also caches all <code>QueryPosts</code> responses as a result of being defined in a Service annotated with <a href="/cacheresponse-attribute.html"><code>[CacheResponse]</code> attribute</a>.</p><h3 id="iautoquerydb-api" tabindex="-1">IAutoQueryDb API <a class="header-anchor" href="#iautoquerydb-api" aria-hidden="true">#</a></h3><p>To increase the versatility of using AutoQuery functionality in custom Service implementations, <code>IAutoQueryDb</code> supports both parallel Sync and Async APIs if needing to enlist AutoQuery functionality in Sync methods that are unable to be refactored to use the async APIs:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IAutoQueryDb</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IAutoCrudDb</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// Generic API to resolve the DB Connection to use for this request</span>
    <span class="token return-type class-name">IDbConnection</span> <span class="token generic-method"><span class="token function">GetDb</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IRequest</span> req <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Generate a populated and Typed OrmLite SqlExpression using same model as the source and output target</span>
    <span class="token return-type class-name">SqlExpression<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">CreateQuery</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IQueryDb<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> dynamicArgs<span class="token punctuation">,</span>
        <span class="token class-name">IRequest</span> req <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Execute an OrmLite SqlExpression using the same model as the source and output target</span>
    <span class="token return-type class-name">QueryResponse<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">Execute</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IQueryDb<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> model<span class="token punctuation">,</span> <span class="token class-name">SqlExpression<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> query<span class="token punctuation">,</span> 
        <span class="token class-name">IRequest</span> req <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Async Execute an OrmLite SqlExpression using the same model as the source and output target</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>QueryResponse<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">ExecuteAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IQueryDb<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> model<span class="token punctuation">,</span> <span class="token class-name">SqlExpression<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> query<span class="token punctuation">,</span> 
        <span class="token class-name">IRequest</span> req <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Generate a populated and Typed OrmLite SqlExpression using different models for source &amp; output target</span>
    <span class="token return-type class-name">SqlExpression<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">CreateQuery</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span>Into<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IQueryDb<span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span>Into<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> dynamicArgs<span class="token punctuation">,</span>
        <span class="token class-name">IRequest</span> req <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Execute an OrmLite SqlExpression using different models for source and output target</span>
    <span class="token return-type class-name">QueryResponse<span class="token punctuation">&lt;</span>Into<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">Execute</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span> Into<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IQueryDb<span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span>Into<span class="token punctuation">&gt;</span></span> model<span class="token punctuation">,</span> <span class="token class-name">SqlExpression<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> query<span class="token punctuation">,</span> 
        <span class="token class-name">IRequest</span> req <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Async Execute an OrmLite SqlExpression using different models for source and output target</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>QueryResponse<span class="token punctuation">&lt;</span>Into<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">ExecuteAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span> Into<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IQueryDb<span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span>Into<span class="token punctuation">&gt;</span></span> model<span class="token punctuation">,</span> <span class="token class-name">SqlExpression<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> query<span class="token punctuation">,</span> 
        <span class="token class-name">IRequest</span> req <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">IDbConnection</span> db <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>IAutoQueryDb</code> inherits <code>IAutoCrudDb</code> APIs below and can access both AutoQuery and CRUD functionality.</p><p>Likewise the new AutoQuery Crud APIs also have sync &amp; async implementations:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IAutoCrudDb</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Inserts new entry into Table</span>
    <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token generic-method"><span class="token function">Create</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">ICreateDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Inserts new entry into Table Async</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">CreateAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">ICreateDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Updates entry into Table</span>
    <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token generic-method"><span class="token function">Update</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IUpdateDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Updates entry into Table Async</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">UpdateAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IUpdateDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Partially Updates entry into Table (Uses OrmLite UpdateNonDefaults behavior)</span>
    <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token generic-method"><span class="token function">Patch</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IPatchDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Partially Updates entry into Table Async (Uses OrmLite UpdateNonDefaults behavior)</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">PatchAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IPatchDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Deletes entry from Table</span>
    <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token generic-method"><span class="token function">Delete</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IDeleteDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Deletes entry from Table Async</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">DeleteAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IDeleteDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Inserts or Updates entry into Table</span>
    <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token generic-method"><span class="token function">Save</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">ISaveDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Inserts or Updates entry into Table Async</span>
    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">SaveAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">ISaveDb<span class="token punctuation">&lt;</span>Table<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Due to its internal pre-defined behavior, AutoQuery CRUD custom Service implementations have limited customizability over its implementation but still allows you to apply custom logic like apply Custom Filter Attributes, include additional validation, augment the Response DTO, etc.</p><p>E.g. This implementation applies the <code>[ConnectionInfo]</code> behavior to all its Services which will instead execute queries on the registered Reporting named connection:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ConnectionInfo</span><span class="token attribute-arguments"><span class="token punctuation">(</span>NamedConnection <span class="token operator">=</span> <span class="token string">&quot;Reporting&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyReportingServices</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">IAutoQueryDb</span> AutoQuery <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token class-name">CreateReport</span> request<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="autoquery-response-filters" tabindex="-1">AutoQuery Response Filters <a class="header-anchor" href="#autoquery-response-filters" aria-hidden="true">#</a></h3><p>The Aggregate functions feature is built on the new <code>ResponseFilters</code> support in AutoQuery which provides a new extensibility option enabling customization and additional metadata to be attached to AutoQuery Responses. As the Aggregate Functions support is itself a Response Filter in can disabled by clearing them:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span>
    ResponseFilters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Action<span class="token punctuation">&lt;</span>QueryFilterContext<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>The Response Filters are executed after each AutoQuery and gets passed the full context of the executed query, i.e:</p><div class="language-csharp"><pre><code><span class="token keyword">class</span> <span class="token class-name">QueryFilterContext</span>
<span class="token punctuation">{</span>
    IDbConnection Db             <span class="token comment">// The ADO.NET DB Connection</span>
    List<span class="token operator">&lt;</span>Command<span class="token operator">&gt;</span> Commands       <span class="token comment">// Tokenized list of commands</span>
    IQuery Request               <span class="token comment">// The AutoQuery Request DTO</span>
    ISqlExpression SqlExpression <span class="token comment">// The AutoQuery SqlExpression</span>
    IQueryResponse Response      <span class="token comment">// The AutoQuery Response DTO</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Where the <code>Commands</code> property contains the parsed list of commands from the <code>Include</code> property, tokenized into the structure below:</p><div class="language-csharp"><pre><code><span class="token keyword">class</span> <span class="token class-name">Command</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">string</span> Name
    List<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">&gt;</span> Args
    <span class="token keyword">string</span> Suffix
<span class="token punctuation">}</span>
</code></pre></div><p>With this we could add basic calculator functionality to AutoQuery with the custom Response Filter below:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span>
    ResponseFilters <span class="token operator">=</span> <span class="token punctuation">{</span>
        ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> supportedFns <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>StringComparer<span class="token punctuation">.</span>OrdinalIgnoreCase<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token punctuation">{</span><span class="token string">&quot;ADD&quot;</span><span class="token punctuation">,</span>      <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span><span class="token string">&quot;MULTIPLY&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">*</span> b <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span><span class="token string">&quot;DIVIDE&quot;</span><span class="token punctuation">,</span>   <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">/</span> b <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span><span class="token string">&quot;SUBTRACT&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">-</span> b <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> executedCmds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Command<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> cmd <span class="token keyword">in</span> ctx<span class="token punctuation">.</span>Commands<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> fn<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>supportedFns<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token keyword">out</span> fn<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">var</span></span> label <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>Suffix<span class="token punctuation">)</span> <span class="token punctuation">?</span> cmd<span class="token punctuation">.</span>Suffix<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> cmd<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span>label<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>Args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>Args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                executedCmds<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            ctx<span class="token punctuation">.</span>Commands<span class="token punctuation">.</span><span class="token function">RemoveAll</span><span class="token punctuation">(</span>executedCmds<span class="token punctuation">.</span>Contains<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Which now lets users perform multiple basic arithmetic operations with any AutoQuery request!</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryRockstars</span> <span class="token punctuation">{</span>
    Include <span class="token operator">=</span> <span class="token string">&quot;ADD(6,2), Multiply(6,2) SixTimesTwo, Subtract(6,2), divide(6,2) TheDivide&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span><span class="token string">&quot;ADD(6,2)&quot;</span><span class="token punctuation">]</span>      <span class="token comment">//= 8</span>
response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span><span class="token string">&quot;SixTimesTwo&quot;</span><span class="token punctuation">]</span>   <span class="token comment">//= 12</span>
response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span><span class="token string">&quot;Subtract(6,2)&quot;</span><span class="token punctuation">]</span> <span class="token comment">//= 4</span>
response<span class="token punctuation">.</span>Meta<span class="token punctuation">[</span><span class="token string">&quot;TheDivide&quot;</span><span class="token punctuation">]</span>     <span class="token comment">//= 3</span>
</code></pre></div><h3 id="untyped-sqlexpression" tabindex="-1">Untyped SqlExpression <a class="header-anchor" href="#untyped-sqlexpression" aria-hidden="true">#</a></h3><p>If you need to introspect or modify the executed <code>ISqlExpression</code>, it\u2019s useful to access it as a <code>IUntypedSqlExpression</code> so its non-generic API&#39;s are still accessible without having to convert it back into its concrete generic <code>SqlExpression&lt;T&gt;</code> Type, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name">IUntypedSqlExpression</span> q <span class="token operator">=</span> ctx<span class="token punctuation">.</span>SqlExpression<span class="token punctuation">.</span><span class="token function">GetUntypedSqlExpression</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Cloning the SqlExpression allows you to modify a copy that won&#39;t affect any other Response Filter.</p></div><h3 id="autoquery-property-mapping" tabindex="-1">AutoQuery Property Mapping <a class="header-anchor" href="#autoquery-property-mapping" aria-hidden="true">#</a></h3><p>AutoQuery can map <code>[DataMember]</code> property aliases on Request DTO&#39;s to the queried table, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryPerson</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Name <span class="token operator">=</span> <span class="token string">&quot;first_name&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> FirstName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Which can be queried with:</p><div class="language-"><pre><code>?first_name=Jimi
</code></pre></div><p>or by setting the global <code>JsConfig.Init(Config { TextCase = TextCase.SnakeCase })</code> convention:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryPerson</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastName <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Where it&#39;s also queryable with:</p><div class="language-"><pre><code>?last_name=Hendrix
</code></pre></div><h2 id="extensibility-with-queryfilters" tabindex="-1">Extensibility with QueryFilters <a class="header-anchor" href="#extensibility-with-queryfilters" aria-hidden="true">#</a></h2><p>We&#39;ve already covered some of extensibility options with Customizable <strong>QueryDbFields</strong> and <strong>Implicit Conventions</strong>, the most customizable would be to override the default implementation with a custom one, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyQueryServices</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">IAutoQueryDb</span> AutoQuery <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token comment">//Override with custom implementation</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token class-name">FindMovies</span> dto<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateQuery</span><span class="token punctuation">(</span>dto<span class="token punctuation">,</span> Request<span class="token punctuation">.</span><span class="token function">GetRequestParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> AutoQuery<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>dto<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>There&#39;s also a lighter weight option by registering a typed Query Filter, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> autoQuery <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">RegisterQueryFilter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>QueryRockstarsFilter<span class="token punctuation">,</span> Rockstar<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span> dto<span class="token punctuation">,</span> req<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      q<span class="token punctuation">.</span><span class="token function">And</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>LastName<span class="token punctuation">.</span><span class="token function">EndsWith</span><span class="token punctuation">(</span><span class="token string">&quot;son&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">RegisterQueryFilter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IFilterRockstars<span class="token punctuation">,</span> Rockstar<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span> dto<span class="token punctuation">,</span> req<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      q<span class="token punctuation">.</span><span class="token function">And</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>LastName<span class="token punctuation">.</span><span class="token function">EndsWith</span><span class="token punctuation">(</span><span class="token string">&quot;son&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>autoQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Registering an interface like <code>IFilterRockstars</code> is especially useful as it enables applying custom logic to a number of different Query Services sharing the same interface.</p><h2 id="intercept-and-introspect-every-query" tabindex="-1">Intercept and Introspect Every Query <a class="header-anchor" href="#intercept-and-introspect-every-query" aria-hidden="true">#</a></h2><p>As mentioned earlier AutoQuery works by auto-generating ServiceStack Services for each Request DTO marked with <code>IQueryDb</code> unless a custom implementation has been defined for that Query. It&#39;s also possible to change the base class for the generated services so that all queries execute your custom implementation instead.</p><p>To do this, create a custom Service that inherits from <code>AutoQueryServiceBase</code> and overrides both <code>Exec</code> methods with your own implementation, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">MyAutoQueryServiceBase</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AutoQueryServiceBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token generic-method"><span class="token function">Exec</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IQueryDb<span class="token punctuation">&lt;</span>From<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateQuery</span><span class="token punctuation">(</span>dto<span class="token punctuation">,</span> Request<span class="token punctuation">.</span><span class="token function">GetRequestParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> AutoQuery<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>dto<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token generic-method"><span class="token function">Exec</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span> Into<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">IQueryDb<span class="token punctuation">&lt;</span>From<span class="token punctuation">,</span> Into<span class="token punctuation">&gt;</span></span> dto<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateQuery</span><span class="token punctuation">(</span>dto<span class="token punctuation">,</span> Request<span class="token punctuation">.</span><span class="token function">GetRequestParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> AutoQuery<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>dto<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token keyword">base</span><span class="token punctuation">.</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Then tell AutoQuery to use your base class instead, e.g:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span> 
    AutoQueryServiceBaseType <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyAutoQueryServiceBase</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Which will now get AutoQuery to execute your implementations instead.</p><h2 id="exclude-autoquery-collections-from-being-initialized" tabindex="-1">Exclude AutoQuery Collections from being initialized <a class="header-anchor" href="#exclude-autoquery-collections-from-being-initialized" aria-hidden="true">#</a></h2><p>The default configuration for all languages supported in <a href="/add-servicestack-reference.html">Add ServiceStack Reference</a> is to <a href="/csharp-add-servicestack-reference.html#initializecollections">InitializeCollections</a> which allows for a nicer client API in which clients can assume Request DTO&#39;s have their collections initialized allowing them to use the shorthand collection initializer syntax, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SearchQuestions</span> <span class="token punctuation">{</span> 
    Tags <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;redis&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ormlite&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="autoquery-crud-batch-requests" tabindex="-1">AutoQuery CRUD Batch Requests <a class="header-anchor" href="#autoquery-crud-batch-requests" aria-hidden="true">#</a></h2><p>All AutoQuery CRUD operations support auto batch implementations which will by default execute all AutoQuery CRUD Requests within a DB transaction.</p><p>By default it will generate AutoBatch implementations for all CRUD operations and can be changed to only generate implementations for specific CRUD operations by changing:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span>
    GenerateAutoBatchImplementationsFor <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> AutoCrudOperation<span class="token punctuation">.</span>Create <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>It also wont generate implementations for custom AutoBatch implementations, e.g. you can add a custom implementation that does what the generated implementation would&#39;ve done and execute using the same DB Connection and Transaction with:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomAutoQueryServices</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">IAutoQueryDb</span> AutoQuery <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token class-name">CreateItem<span class="token punctuation">[</span><span class="token punctuation">]</span></span> requests<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> <span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> AutoQuery<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetDb</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Item<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>Request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">using</span> <span class="token class-name"><span class="token keyword">var</span></span> dbTrans <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">OpenTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name"><span class="token keyword">var</span></span> results <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> request <span class="token keyword">in</span> requests<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> AutoQuery<span class="token punctuation">.</span><span class="token function">CreateAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> Request<span class="token punctuation">,</span> db<span class="token punctuation">)</span><span class="token punctuation">;</span>
            results<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        dbTrans<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> results<span class="token punctuation">;</span>            
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>As AutoQuery Services are normal ServiceStack Services they can re-use the existing Service Client support for <a href="/auto-batched-requests.html">Auto Batched Requests</a>, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">JsonServiceClient</span><span class="token punctuation">(</span>BaseUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">SendAll</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">CreateItem<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="autoquery-examples" tabindex="-1">AutoQuery Examples <a class="header-anchor" href="#autoquery-examples" aria-hidden="true">#</a></h1><h2 id="autoquery-viewer" tabindex="-1">AutoQuery Viewer <a class="header-anchor" href="#autoquery-viewer" aria-hidden="true">#</a></h2><p>AutoQuery Viewer provides an instant UI for constructing and browsing your <a href="/autoquery.html">AutoQuery</a> Services:</p><p><a href="http://github.servicestack.net/ss_admin/autoquery" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Admin/master/img/query-default-values.png" alt=""></a></p><div class="info custom-block"><p class="custom-block-title">YouTube</p><p><a href="https://youtu.be/YejYkCvKsuQ" target="_blank" rel="noopener noreferrer">youtu.be/YejYkCvKsuQ</a></p></div><h3 id="live-autoquery-viewer-examples" tabindex="-1">Live AutoQuery Viewer Examples <a class="header-anchor" href="#live-autoquery-viewer-examples" aria-hidden="true">#</a></h3><ul><li><a href="http://github.servicestack.net/ss_admin/" target="_blank" rel="noopener noreferrer">http://github.servicestack.net/ss_admin/</a></li><li><a href="http://northwind.netcore.io/ss_admin/" target="_blank" rel="noopener noreferrer">http://northwind.netcore.io/ss_admin/</a></li><li><a href="http://stackapis.netcore.io/ss_admin/" target="_blank" rel="noopener noreferrer">http://stackapis.netcore.io/ss_admin/</a></li></ul><h2 id="northwind" tabindex="-1"><a href="https://github.com/ServiceStackApps/Northwind" target="_blank" rel="noopener noreferrer">Northwind</a> <a class="header-anchor" href="#northwind" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">DEMO</p><p>Northwind database viewer, showing how to easily expose read and cached view services of an internal dataset with OrmLite</p></div><p><a href="http://northwind.netcore.io" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/livedemos/northwind.png" alt=""></a></p><h4 id="features" tabindex="-1">Features <a class="header-anchor" href="#features" aria-hidden="true">#</a></h4><ul><li><a href="/autoquery.html">AutoQuery</a><ul><li><a href="https://github.com/ServiceStackApps/Northwind/blob/master/src/Northwind/Northwind.ServiceModel/AutoQuery.cs" target="_blank" rel="noopener noreferrer">Northwind AutoQuery DTOs</a></li><li><a href="https://github.com/ServiceStack/ServiceStack.OrmLite#download" target="_blank" rel="noopener noreferrer">OrmLite Sqlite</a></li></ul></li></ul><h2 id="stackapis" tabindex="-1"><a href="https://github.com/ServiceStackApps/StackApis" target="_blank" rel="noopener noreferrer">StackApis</a> <a class="header-anchor" href="#stackapis" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">DEMO</p><p>AngularJS Single Page App leveraging AutoQuery in &lt;50 lines of JavaScript + 1 AutoQuery DTO</p></div><p><a href="http://stackapis.netcore.io" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/livedemos/stackapis.png" alt=""></a></p><h4 id="features-1" tabindex="-1">Features <a class="header-anchor" href="#features-1" aria-hidden="true">#</a></h4><ul><li><a href="/autoquery.html">AutoQuery</a><ul><li><a href="https://github.com/ServiceStackApps/StackApis#stackapis-autoquery-service" target="_blank" rel="noopener noreferrer">StackApis AutoQuery DTO</a></li><li><a href="https://github.com/ServiceStack/ServiceStack.OrmLite#download" target="_blank" rel="noopener noreferrer">OrmLite Sqlite</a></li></ul></li></ul><h2 id="autoquery-viewer-1" tabindex="-1"><a href="https://github.com/ServiceStackApps/AutoQueryViewer" target="_blank" rel="noopener noreferrer">AutoQuery Viewer</a> <a class="header-anchor" href="#autoquery-viewer-1" aria-hidden="true">#</a></h2><p>AutoQuery Viewer is a native iPad App that provides an automatic UI for browsing, inspecting and querying any publicly accessible <a href="/autoquery.html">ServiceStack AutoQuery Service</a> from an iPad.</p><p><a href="https://itunes.apple.com/us/app/autoquery-viewer/id968625288?ls=1&amp;mt=8" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/wikis/autoquery/autoqueryviewer-appstore.png" alt="AutoQuery Viewer on AppStore"></a></p><h4 id="features-2" tabindex="-1">Features <a class="header-anchor" href="#features-2" aria-hidden="true">#</a></h4><ul><li><a href="https://github.com/ServiceStackApps/AutoQueryViewer#techstacks-autoquery-reqeust-dtos" target="_blank" rel="noopener noreferrer">TechStacks AutoQuery DTOs</a></li><li><a href="https://github.com/ServiceStackApps/AutoQueryViewer#githubautoquery-request-dtos" target="_blank" rel="noopener noreferrer">GitHub AutoQuery DTOs</a></li><li><a href="https://github.com/ServiceStackApps/AutoQueryViewer#stakapi-autoquery-request-dto" target="_blank" rel="noopener noreferrer">Stack Apis AutoQuery DTO</a></li></ul><h2 id="techstacks-cocoa-osx-desktop-app" tabindex="-1"><a href="https://github.com/ServiceStackApps/TechStacksDesktopApp" target="_blank" rel="noopener noreferrer">TechStacks Cocoa OSX Desktop App</a> <a class="header-anchor" href="#techstacks-cocoa-osx-desktop-app" aria-hidden="true">#</a></h2><p>TechStacks OSX Desktop App is built around 2 AutoQuery Services showing how much querying functionality <a href="/autoquery.html">AutoQuery Services</a> provides for free and how easy they are to call with <a href="/swift-add-servicestack-reference.html">ServiceStack&#39;s new support for Swift and XCode</a>.</p><p><a href="https://github.com/ServiceStackApps/TechStacksDesktopApp" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/techstacks-desktop-field.png" alt="TechStack Desktop Search Fields"></a></p>__VP_STATIC_END__`,353),i=[c,u,l];function r(k,d,g,y,h,m){return e(),t("div",null,i)}var f=a(o,[["render",r]]);export{b as __pageData,f as default};
