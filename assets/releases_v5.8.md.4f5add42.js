import{_ as n,c as s,o as a,a as e}from"./app.14440598.js";const g='{"title":"v5.8 Release Notes","description":"","frontmatter":{"title":"v5.8 Release Notes","slug":"v5-8"},"headers":[{"level":2,"title":".NET Core 3.1 LTS","slug":"net-core-3-1-lts"},{"level":3,"title":".NET Core 3.1 LTS Project Templates","slug":"net-core-3-1-lts-project-templates"},{"level":3,"title":".NET Core 3.1 Desktop Apps using latest Chromium","slug":"net-core-3-1-desktop-apps-using-latest-chromium"},{"level":2,"title":"ServiceStack gRPC","slug":"servicestack-grpc"},{"level":3,"title":"Getting Started","slug":"getting-started"},{"level":3,"title":"ServiceStack Services are gRPC Services","slug":"servicestack-services-are-grpc-services"},{"level":3,"title":"Enable gRPC Services in existing .NET Core 3 projects","slug":"enable-grpc-services-in-existing-net-core-3-projects"},{"level":3,"title":"Maximize reuse of Knowledge and Investments","slug":"maximize-reuse-of-knowledge-and-investments"},{"level":3,"title":"Code-First gRPC Services","slug":"code-first-grpc-services"},{"level":3,"title":"No additional complexity or artificial machinery","slug":"no-additional-complexity-or-artificial-machinery"},{"level":3,"title":"Smart, Substitutable, Generic GrpcServiceClient","slug":"smart-substitutable-generic-grpcserviceclient"},{"level":3,"title":"Preserve rich Semantics and API Design","slug":"preserve-rich-semantics-and-api-design"},{"level":3,"title":"Offer best API for every platform","slug":"offer-best-api-for-every-platform"},{"level":2,"title":"Architecture","slug":"architecture"},{"level":3,"title":"RpcGateway","slug":"rpcgateway"},{"level":2,"title":"Limitations","slug":"limitations"},{"level":3,"title":"Inheritance","slug":"inheritance"},{"level":2,"title":"Features","slug":"features"},{"level":3,"title":"protobuf-net Inheritance","slug":"protobuf-net-inheritance"},{"level":3,"title":"Dynamic gRPC Requests","slug":"dynamic-grpc-requests"},{"level":3,"title":"Simulate HTTP Requests","slug":"simulate-http-requests"},{"level":3,"title":"Server Stream gRPC Services","slug":"server-stream-grpc-services"},{"level":3,"title":"Implementing Server Stream Services","slug":"implementing-server-stream-services"},{"level":2,"title":"SSL Certificate Configuration","slug":"ssl-certificate-configuration"},{"level":2,"title":"gRPC Clients","slug":"grpc-clients"},{"level":3,"title":"protoc generated clients","slug":"protoc-generated-clients"},{"level":2,"title":"gRPC Web","slug":"grpc-web"},{"level":3,"title":"x dotnet tool gRPC Web support","slug":"x-dotnet-tool-grpc-web-support"},{"level":2,"title":"gRPC Configuration","slug":"grpc-configuration"},{"level":3,"title":"Protobuf Serialization","slug":"protobuf-serialization"},{"level":3,"title":"Any Methods","slug":"any-methods"},{"level":3,"title":"Custom gRPC Status Codes","slug":"custom-grpc-status-codes"},{"level":3,"title":"Filtered HTTP Headers","slug":"filtered-http-headers"},{"level":3,"title":"Proto Options","slug":"proto-options"},{"level":2,"title":"Public gRPC protoc Service and UI","slug":"public-grpc-protoc-service-and-ui"},{"level":3,"title":"From .proto descriptors","slug":"from-proto-descriptors"},{"level":3,"title":"Using curl","slug":"using-curl"},{"level":2,"title":"Mix in Gists","slug":"mix-in-gists"},{"level":2,"title":"OrmLite","slug":"ormlite"},{"level":3,"title":"Dapper","slug":"dapper"},{"level":3,"title":"XML Field Support in PostgreSQL","slug":"xml-field-support-in-postgresql"},{"level":3,"title":"NOLOCK SQL Server Table Hint","slug":"nolock-sql-server-table-hint"},{"level":3,"title":"ServiceStack.Text","slug":"servicestack-text"},{"level":2,"title":"New #Script Methods","slug":"new-script-methods"}],"relativePath":"releases/v5.8.md","lastUpdated":1634495308446}',t={},o=e(`<p>Happy New 2020 All! Hope everyone&#39;s had an enjoyable and relaxing break over the holidays and are re-energized to usher in the new decade.</p><p><a href="https://grpc.io" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/grpc/grpc-horizontal-color.svg?sanitize=true" alt=""></a></p><p>We&#39;re super excited to open the year with the premier feature in this release <strong>ServiceStack gRPC</strong>, our highly-productive entry into the <a href="https://grpc.io" target="_blank" rel="noopener noreferrer">gRPC</a> universe with a number of value-added additions that makes developing and consuming gRPC Services a joy with USPs that leverages and preserves your existing knowledge and investments and maximizes the utility of your Services offering unprecedented value for your development efforts.</p><h2 id="net-core-3-1-lts" tabindex="-1">.NET Core 3.1 LTS <a class="header-anchor" href="#net-core-3-1-lts" aria-hidden="true">#</a></h2><p>With the release of <a href="https://devblogs.microsoft.com/dotnet/announcing-net-core-3-1/" target="_blank" rel="noopener noreferrer">.NET Core 3.1 LTS</a> we&#39;ve standardized our Project Templates and tools to <strong>.NET Core 3.1 LTS</strong> whilst continuing to support existing <strong>.NET Core 2.1+</strong> and <strong>.NET Framework</strong> projects including <a href="/templates-corefx.html">ASP.NET Core Apps on the .NET Framework</a>.</p><p>You can view all available .NET Core Templates using the <a href="/dotnet-tool.html">x dotnet tool</a> and running <a href="/dotnet-new.html">x new</a>:</p><pre><code>$ dotnet tool install --global x 
$ x new
</code></pre><h3 id="net-core-3-1-lts-project-templates" tabindex="-1">.NET Core 3.1 LTS Project Templates <a class="header-anchor" href="#net-core-3-1-lts-project-templates" aria-hidden="true">#</a></h3><p><a href="/web-new.html"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/csharp-templates/vue-nuxt.png" alt=""></a></p><p>All <a href="/web-new.html">.NET Core Project Templates</a> have been upgraded to <a href="https://devblogs.microsoft.com/dotnet/announcing-net-core-3-1/" target="_blank" rel="noopener noreferrer">.NET Core 3.1 LTS</a> in this release including new <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/host/generic-host?view=aspnetcore-3.1" target="_blank" rel="noopener noreferrer">Generic Host</a> (i.e. non HTTP) Project Templates configured with each of our <a href="/messaging.html">supported MQ Servers</a> for running MQ-only workloads:</p><ul><li><a href="https://github.com/NetCoreTemplates/worker-rabbitmq" target="_blank" rel="noopener noreferrer">worker-rabbitmq</a></li><li><a href="https://github.com/NetCoreTemplates/worker-redismq" target="_blank" rel="noopener noreferrer">worker-redismq</a></li><li><a href="https://github.com/NetCoreTemplates/worker-servicebus" target="_blank" rel="noopener noreferrer">worker-servicebus</a></li><li><a href="https://github.com/NetCoreTemplates/worker-sqs" target="_blank" rel="noopener noreferrer">worker-sqs</a></li></ul><p>The new <a href="/dotnet-tool.html">x dotnet tool</a> is exactly like the cross-platform <code>web</code> .NET Core 2.1 dotnet tool except for <strong>.NET Core 3</strong>, which is required for making HTTP/2 requests on non-Windows platforms.</p><h3 id="net-core-3-1-desktop-apps-using-latest-chromium" tabindex="-1">.NET Core 3.1 Desktop Apps using latest Chromium <a class="header-anchor" href="#net-core-3-1-desktop-apps-using-latest-chromium" aria-hidden="true">#</a></h3><p>The <code>app</code> dotnet tool for running <a href="/netcore-windows-desktop.html">.NET Core Chromium Desktop Apps</a> has been upgraded to use <strong>.NET Core 3.1 LTS</strong> and the latest version of Chromium available in <a href="https://gitlab.com/xiliumhq/chromiumembedded/cefglue" target="_blank" rel="noopener noreferrer">CefGlue</a>.</p><p><a href="/netcore-windows-desktop.html"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/app/app-shortcut-icon.png" alt=""></a></p><p>Thanks to <a href="https://sharpscript.net" target="_blank" rel="noopener noreferrer">#Script&#39;s</a> dynamic and late-binding characteristics all <a href="https://sharpscript.net/docs/sharp-apps" target="_blank" rel="noopener noreferrer">Sharp Apps</a> and <a href="https://sharpscript.net/docs/gist-desktop-apps" target="_blank" rel="noopener noreferrer">Gist Desktop Apps</a> continue to run unmodified on both .NET Core 2.1 or .NET Core 3.1 <code>app</code> launchers.</p><p><a href="https://youtu.be/FlKeaav0gt8" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/sharpscript/gist-desktop-apps.png" alt=""></a></p><h2 id="servicestack-grpc" tabindex="-1">ServiceStack gRPC <a class="header-anchor" href="#servicestack-grpc" aria-hidden="true">#</a></h2><p>ServiceStack&#39;s code-first message-based development approach offers a number of advantages over most gRPC Service frameworks which rely on manually maintaining a separate plain-text <code>.proto</code> IDL files for defining your gRPC Services and reliance on external tooling and binding to foreign code-generated classes.</p><p>With ServiceStack gRPC, there&#39;s no additional complexity, no manual maintenance of <code>.proto</code> files, no reliance on external tooling, code-gen, etc is required to maintain its simple code-first development model utilizing clean POCOs which is still able to retain its ideal end-to-end Typed API utilizing smart, rich .NET generic Service Clients:</p><div class="language-csharp"><pre><code><span class="token comment">//IRestServiceClient client = new JsonServiceClient(BaseUrl);</span>
<span class="token class-name">IRestServiceClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcServiceClient</span><span class="token punctuation">(</span>BaseUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Like other <a href="/csharp-client.html#built-in-clients">.NET Service Clients</a>, <code>GrpcServiceClient</code> is a substitutable full-featured Service Client should consumers prefer to revert to using other more versatile, interoperable, debuggable and ubiquitous serialization formats.</p><h3 id="getting-started" tabindex="-1">Getting Started <a class="header-anchor" href="#getting-started" aria-hidden="true">#</a></h3><p>The easiest way to get started is to start from a new <a href="https://github.com/NetCoreTemplates/grpc" target="_blank" rel="noopener noreferrer">grpc</a> template that&#39;s a copy of the empty <a href="https://github.com/NetCoreTemplates/web" target="_blank" rel="noopener noreferrer">web</a> project template pre-configured with gRPC support:</p><pre><code>$ dotnet tool install --global x 
$ x new grpc MyGrpcProject
</code></pre><h3 id="servicestack-services-are-grpc-services" tabindex="-1">ServiceStack Services are gRPC Services <a class="header-anchor" href="#servicestack-services-are-grpc-services" aria-hidden="true">#</a></h3><p>Whilst Protocol Buffers imposes <a href="/grpc.html#limitations">additional restrictions</a> on the Types that can be returned, in general the only change to ServiceStack Services following our <a href="/api-design.html">recommended API Design</a> are to add .NET&#39;s <code>[DataContract]</code> and <code>[DataMember]</code> attributes on each DTO member assigning unique field index to each property, i.e. what&#39;s required to support existing <a href="/protobuf-format.html">ProtoBuf Services</a> or used to customize XML wire format in ServiceStack&#39;s XML or <a href="/soap-support.html">SOAP Services</a>.</p><p>For an example, here&#39;s the complete annotated <code>GetTodos</code> Service from <a href="https://github.com/NetCoreApps/todo-world" target="_blank" rel="noopener noreferrer">todo-world</a> gRPC Service:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataContract</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetTodos</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IReturn<span class="token punctuation">&lt;</span>GetTodosResponse<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataContract</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetTodosResponse</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Order <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span>Todo<span class="token punctuation">&gt;</span></span> Results <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Order <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">ResponseStatus</span> ResponseStatus <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataContract</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Todo</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Order <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">long</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Order <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Title <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Order <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Order <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Order <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> Completed <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TodoServices</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span>Todo<span class="token punctuation">&gt;</span></span> Todos <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Todo<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetTodos</span> request<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetTodosResponse</span> <span class="token punctuation">{</span> Results <span class="token operator">=</span> Todos <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>As gRPC mandates a static service contract (i.e. only returns the same Response DTO Type) Request DTOs are required to adhere to ServiceStack best practices and be annotated with either <code>IReturn&lt;TResponse&gt;</code> or <code>IReturnVoid</code> interfaces.</p><blockquote><p>Only services annotated with <code>IReturn*</code> interfaces and member indexes (as above) will be registered as gRPC Services.</p></blockquote><p>Trying to call a Service without these annotations will result in an error that the Service you&#39;re trying to call doesn&#39;t exist.</p><h3 id="enable-grpc-services-in-existing-net-core-3-projects" tabindex="-1">Enable gRPC Services in existing .NET Core 3 projects <a class="header-anchor" href="#enable-grpc-services-in-existing-net-core-3-projects" aria-hidden="true">#</a></h3><p>By default this Service is available in <a href="/formats.html">all of ServiceStack&#39;s supported formats</a>, to also make it available via <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core&#39;s gRPC Endpoints you can <a href="/mix-tool.html">mix it</a> into <a href="/modular-startup.html">Modular Startup</a> projects with:</p><pre><code>$ x mix grpc
</code></pre><p>Which applies this <a href="https://gist.github.com/gistlyn/656c29a7257dc374d22d4aa709ba7244" target="_blank" rel="noopener noreferrer">modular ConfigureGrpc configuration</a> to your project.</p><p>Or to manually configure gRPC support, add a reference to the .NET Core 3 <strong>ServiceStack.Extensions</strong> NuGet package:</p><pre><code>$ dotnet add package ServiceStack.Extensions
</code></pre><p>Add the necessary dependencies:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    services<span class="token punctuation">.</span><span class="token function">AddServiceStackGrpc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Then register the <code>GrpcFeature</code> Plugin in your <code>AppHost</code>:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcFeature</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Which registers all applicable ServiceStack Services with <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core&#39;s gRPC Endpoint and provides an auto-generated <a href="/add-servicestack-reference.html">Add ServiceStack Reference</a> <code>/types/proto</code> metadata endpoint that Google&#39;s protoc generated clients can use to generate typed client proxies in each of the languages Google&#39;s gRPC supports.</p><h3 id="maximize-reuse-of-knowledge-and-investments" tabindex="-1">Maximize reuse of Knowledge and Investments <a class="header-anchor" href="#maximize-reuse-of-knowledge-and-investments" aria-hidden="true">#</a></h3><p>Likely the biggest advantage in using ServiceStack to develop gRPC Services is being able to (without additional knowledge) leverage your existing investments and knowledge of building HTTP Services which in most cases (after applying above annotations) are automatically made available as gRPC Services. This maximizes utility of your Services which can be simultaneously made available via <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a>&#39;s gRPC Endpoints and ServiceStack&#39;s HTTP and MQ Endpoints alleviating the need to fork or duplicate your Services logic across multiple implementations, or worse, taking the leap to develop gRPC-only services and shutting out clients and environments that can&#39;t make use of gRPC HTTP/2 endpoints.</p><p>ServiceStack enables the best of both worlds, you can take the risk-free step of making your Services available via highly efficient and performant gRPC HTTP/2 Services for clients and environments that can take advantage of it whilst (in the same App) continuing to make them available via the ubiquitous JSON HTTP/1.1 APIs or in any of their <a href="/formats.html">preferred formats</a>.</p><h3 id="code-first-grpc-services" tabindex="-1">Code-First gRPC Services <a class="header-anchor" href="#code-first-grpc-services" aria-hidden="true">#</a></h3><p>By allowing the use of idiomatic C# POCOs to define your Services contract, code-first always enables a superior development experience which avoids having to rely on external build tools to generate foreign implementation-encumbered types limited in capability by what&#39;s generated by its opaque tooling where it emits single-purpose Types limited for usage in gRPC Services - restricted to the lowest common denominator capabilities of <code>.proto</code> files.</p><p>By contrast with a code-first approach your idiomatic C# POCOs remain the master authority for your Services contract in which you retain full control over, that can be further enhanced with attributes to enlist declarative behavior and shared interfaces and are in general inherently easier to develop genericized behavior around. As <a href="/physical-project-structure.html#servicemodel-project">Service Models</a> doesn&#39;t have any implementation dependencies they can be easily shared and <a href="/why-servicestack.html#target-multiple-platforms">referenced in any .NET Project</a> and as clean POCOs they can serve as <a href="/service-complexity-and-dto-roles.html#the-simple-poco-life">multi-purpose models enabling maximum reuse</a> where they can be utilized in all ServiceStack&#39;s POCO libraries as well being supported in <a href="/formats.html">all of ServiceStack&#39;s supported formats</a>.</p><h3 id="no-additional-complexity-or-artificial-machinery" tabindex="-1">No additional complexity or artificial machinery <a class="header-anchor" href="#no-additional-complexity-or-artificial-machinery" aria-hidden="true">#</a></h3><p>At its most productive usage in .NET Apps, ServiceStack offers the same highly-productive friction-free development experience that&#39;s enjoyed in its other <a href="/csharp-client.html">.NET Generic Service Clients</a> - requiring no tooling, code-generation or any other artificial machinery, as the same clean POCO DTOs used to define your Services can be reused on the client where by preserving any additional annotations or interfaces that can allow for a richer client development experience.</p><p>An alternative to sharing your <strong>ServiceModel.dll</strong> with .NET clients is for them to use <a href="/add-servicestack-reference.html">Add ServiceStack Reference</a> to generate .NET DTOs locally which they can easily do using the <a href="/dotnet-tool.html">x dotnet tool</a>, e.g:</p><pre><code>$ x csharp https://todoworld.servicestack.net
</code></pre><p>This offers the same behavior as sharing <strong>ServiceModel.dll</strong> binary where they can be used in any <a href="/csharp-client.html#built-in-clients">.NET Generic Service Client</a>, but also allows for clients to <a href="/csharp-add-servicestack-reference.html#dto-customization-options">customize DTO generation</a> to suit their own preferences.</p><h3 id="smart-substitutable-generic-grpcserviceclient" tabindex="-1">Smart, Substitutable, Generic GrpcServiceClient <a class="header-anchor" href="#smart-substitutable-generic-grpcserviceclient" aria-hidden="true">#</a></h3><p>Despite requiring much less complexity, the use of a generic Service Client offers a superior development model then what&#39;s available in Google&#39;s <code>protoc</code> generated Service Clients that&#39;s also able to be enjoyed by <a href="http://VB.NET" target="_blank" rel="noopener noreferrer">VB.NET</a> and F# App developers for whom previously there was no planned gRPC support.</p><p>The new <code>GrpcServiceClient</code> can be used in <strong>.NET Standard 2.1</strong> and <strong>.NET Core 3</strong> .NET Clients by adding a reference to:</p><pre><code>$ dotnet add package ServiceStack.GrpcClient
</code></pre><p>This is a full-featured generic Service Client that provides a nicer and cleaner API than what&#39;s possible with <code>protoc</code> generated clients and contains most of the built-in functionality of other <a href="/csharp-client.html">C#/.NET Typed Generic Clients</a>, namely:</p><ul><li>Substitutable <code>IRestServiceClient</code>, <code>IServiceClientAsync</code> and <code>IServiceClientSync</code> interfaces</li><li><a href="/validation.html">Rich Detailed and Structured</a> Typed Exceptions</li><li>Built-in Credentials, JWT, API Key and Session Authentication <ul><li>Transparent auto retry on expired JWT Bearer Tokens after retrieving new JWT from configured Refresh Token</li></ul></li><li>Auto populates Version/Auth info in <code>IHasSessionId</code>, <code>IHasBearerToken</code> and <code>IHasVersion</code> Request DTOs</li><li>Batched API support via <code>SendAll/Async</code> and <code>PublishAll/Async</code> APIs</li><li>Global and Instance Request/Response Filters to apply generic custom logic on each request</li><li>C# 8 <code>await foreach</code> friendly <code>async IAsyncEnumerable&lt;TResponse&gt; Stream()</code> APIs for Server Stream gRPC Services</li></ul><p>Importantly <code>GrpcServiceClient</code> implements the same interfaces shared by other <a href="/csharp-client.html">C#/.NET Typed Generic Clients</a> allowing development of higher-level shared client logic and libraries decoupled from concrete implementations, improved testability, easy substitution to other clients for improved debuggability or working around limitations in protocol buffers, as well as parallel client/server development where devs can temporarily bind to mock clients before server APIs are implemented.</p><p>The predetermined Generic API Surface area of the service client interfaces also makes it easier to develop enhanced functionality like <a href="/cache-aware-clients.html">Cache Aware Service Clients</a> in future that existing Apps will be able to utilize via a minimally disruptive &quot;drop-in&quot; implementation.</p><h4 id="servicestack-interceptor-for-protoc-generated-clients" tabindex="-1">ServiceStack Interceptor for protoc generated clients <a class="header-anchor" href="#servicestack-interceptor-for-protoc-generated-clients" aria-hidden="true">#</a></h4><p>As <code>GrpcServiceClient</code> offers a nicer UX its usage over <code>protoc</code> generated clients should generally be preferred, one area where you&#39;ll want to consider using Google&#39;s <code>protoc</code> generated clients is in AOT environments like Xamarin.iOS as the <code>protoc</code> tooling emits AOT-friendly Protocol Buffer serialization implementations within its code generated Types.</p><p>To better accommodate scenarios where <code>protoc</code> clients are used you can use the <code>ServiceStackClientInterceptor</code> (also in <strong>ServiceStack.GrpcClient</strong>) to replicate most of the rich ServiceStack integration features that&#39;s possible to implement using an <code>Interceptor</code>.</p><p>ServiceStack&#39;s Interceptor can be registered using <code>GrpcServiceStack.Client()</code> when creating the protoc <code>GrpcServicesClient</code>:</p><div class="language-csharp"><pre><code><span class="token comment">// Insecure plain-text example</span>
GrpcClientFactory<span class="token punctuation">.</span>AllowUnencryptedHttp2 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcServices<span class="token punctuation">.</span>GrpcServicesClient</span><span class="token punctuation">(</span>
    GrpcServiceStack<span class="token punctuation">.</span><span class="token function">Client</span><span class="token punctuation">(</span><span class="token string">&quot;http://todoworld.servicestack.net:5054&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// SSL Example</span>
<span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcServices<span class="token punctuation">.</span>GrpcServicesClient</span><span class="token punctuation">(</span>
    GrpcServiceStack<span class="token punctuation">.</span><span class="token function">Client</span><span class="token punctuation">(</span><span class="token string">&quot;https://todoworld.servicestack.net:50051&quot;</span><span class="token punctuation">,</span> 
        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">X509Certificate2</span><span class="token punctuation">(</span><span class="token string">&quot;grpc.crt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        GrpcUtils<span class="token punctuation">.</span><span class="token function">AllowSelfSignedCertificatesFrom</span><span class="token punctuation">(</span><span class="token string">&quot;todoworld.servicestack.net&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Optional (avoid protobuf-net deserialization)</span>
GrpcServiceStack<span class="token punctuation">.</span>ParseResponseStatus <span class="token operator">=</span> bytes <span class="token operator">=&gt;</span> ResponseStatus<span class="token punctuation">.</span>Parser<span class="token punctuation">.</span><span class="token function">ParseFrom</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="preserve-rich-semantics-and-api-design" tabindex="-1">Preserve rich Semantics and API Design <a class="header-anchor" href="#preserve-rich-semantics-and-api-design" aria-hidden="true">#</a></h3><p>gRPC Services enables an efficient long-lived HTTP/2 multiplexed channel with performant Protocol Buffer serialization and a vast code-generation framework allowing us to provide Typed clients for most major programming languages.</p><p>An area that could see a regression which all RPC frameworks suffer from is the erosion of the <a href="/why-servicestack.html#goals-of-service-design">Goals of Service Design</a> and loss of loosely-coupled resource-oriented HTTP API Design centered around applying actions (aka HTTP Verbs) to the request subjects, laying out a logical structure for your API Design that&#39;s also able to better communicate at a higher-level the commonly understood properties of each HTTP method.</p><p>Forcing the usage of <strong>messages</strong> in gRPC Service Requests partially mitigates against the <a href="/why-servicestack.html#wcf-the-anti-dto-web-services-framework">fragile usage of chatty client-specific method signatures</a> plagued by most RPC frameworks like WCF, but still makes it easy for API designs to descend into a logically unstructured &quot;free-for-all&quot; surface area adopting non-standard conventions making it harder and requiring more effort to convey understanding to your API consumers.</p><p>By continuing to develop your ServiceStack Services as a good HTTP First citizens using coarse-grained loosely-coupled messages oriented around resources, a lot of the rich HTTP semantics is preserved where each Verb remains accessible where its prefixed at the start of the rpc Method name:</p><pre><code>rpc [Verb][RequestType](RequestType) returns (ResponseType) {}
</code></pre><p>The original HTTP Status Code remains accessible from the <strong>httpstatus</strong> gRPC Metadata Response Header that continues to be populated in the <code>WebServiceException.StatusCode</code> thrown in <code>GrpcServiceClient</code> or <code>protoc</code> clients configured with the ServiceStack Interceptor. Any Custom HTTP Headers added by your Services are also returned in gRPC headers including your Services detailed structured Exception information stored as a serialized <code>ResponseStatus</code> message in the <strong>responsestatus-bin</strong> Header that continues to be available in <code>WebServiceException.ResponseStatus</code> property allowing gRPC client Apps to develop <a href="/world-validation.html#contacts-page">rich form validation bindings</a> that&#39;s otherwise not possible in gRPC&#39;s failed responses containing just an error code and simple text description.</p><h3 id="offer-best-api-for-every-platform" tabindex="-1">Offer best API for every platform <a class="header-anchor" href="#offer-best-api-for-every-platform" aria-hidden="true">#</a></h3><p>Given the trade-offs of gRPC we still expect the traditional and more ubiquitous HTTP/REST API endpoints to be more widely utilized in areas where you don&#39;t control both client and server Apps, where simplicity and interoperability is more important than maximum performance, when needing to support Ajax requests in Web Apps where HTTP/JSON is the lingua franca with rich support baked into many JS libraries or if needing to support environments where deeper integration of different formats is preferred, e.g. utilizing <a href="/csv-format.html">CSV Format</a> in Excel based workflows or importing datasets into Databases where it&#39;s natively supported in most RDBMS&#39;s tooling.</p><p>With the additional &quot;complexity tax&quot; for adopting a gRPC-based solution workflow, many App developers are still going to prefer the simplicity of consuming a HTTP/JSON API from a URL and HTTP API docs.</p><p>As gRPC is just another endpoint for your ServiceStack Services you don&#39;t have to take the risk of committing to one scenario at the expense of all others and can continue to serve all client consumers with the best API for every platform simultaneously.</p><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-hidden="true">#</a></h2><p>Unlike in other Services where ServiceStack handles writing the response directly to the HttpResponse, ServiceStack&#39;s gRPC Services are the implementation for <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core gRPC Endpoint requests where it makes use of <a href="https://github.com/mgravell" target="_blank" rel="noopener noreferrer">Marc Gravell&#39;s</a> code-first <a href="https://github.com/protobuf-net/protobuf-net.Grpc" target="_blank" rel="noopener noreferrer">protobuf-net.Grpc</a> library to enable ServiceStack&#39;s code-first development model of using typed Request/Response DTOs to implement and consume gRPC Services.</p><p><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/grpc/grpc-request.svg?sanitize=true" alt=""></p><p>Requests are executed using the <a href="/order-of-operations.html#rpcgateway">RpcGateway</a> which returns the Response DTO back to ASP .NET Core gRPC which handles sending the response back to the HTTP/2 connected client.</p><h3 id="rpcgateway" tabindex="-1">RpcGateway <a class="header-anchor" href="#rpcgateway" aria-hidden="true">#</a></h3><p>The <code>RpcGateway</code> provides a pure object model API for executing requests through the full HTTP Request pipeline including converting all Errors inc. short-circuited Request Pipeline requests into an Error ResponseStatus that&#39;s populated into the Response DTO&#39;s <code>ResponseStatus</code>.</p><p>The <code>RpcGateway</code> is available via the single <code>AppHost.RpcGateway</code> API:</p><div class="language-csharp"><pre><code><span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>TResponse<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">ExecuteAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TResponse<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> requestDto<span class="token punctuation">,</span> <span class="token class-name">IRequest</span> req<span class="token punctuation">)</span>
</code></pre></div><p>Unlike MQ Requests which uses <code>ServiceController.ExecuteMessage</code> to execute <strong>internal/trusted</strong> Services, the <code>RpcGateway</code> executes the full <a href="/order-of-operations.html#rpcgateway">HTTP Request Pipeline</a> where requests are executed through the same global Request/Response filters that normal HTTP ServiceStack Services execute making them suitable for executing external <strong>untrusted</strong> requests.</p><p>The <code>RpcGateway</code> will simplify future integrations into external facing service endpoints, e.g. for proprietary endpoints or should there be a next successor to gRPC.</p><h2 id="limitations" tabindex="-1">Limitations <a class="header-anchor" href="#limitations" aria-hidden="true">#</a></h2><p>Protocol Buffers have a number of restrictions in Types it supports:</p><h3 id="inheritance" tabindex="-1">Inheritance <a class="header-anchor" href="#inheritance" aria-hidden="true">#</a></h3><p>In its pursuit of defining a universal service description that can be both implemented and consumed by each major programming language, Google&#39;s gRPC <code>.proto</code> and Protocol Buffers suffers from the limitations of needing to abide by the lowest common denominator functionality available in all languages that&#39;s limited to use <a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf" target="_blank" rel="noopener noreferrer">Protocol Buffers built-in and Well Known Types</a> which is much more restrictive than schema-less formats like JSON where the Type definition is retained in native POCOs used to de/serialize JSON.</p><p>The Types of limitations applicable when building gRPC Services in .NET include:</p><ul><li>No support for Generic Types</li><li>No proper support for Inheritance</li><li>All enums need a zero value</li><li>All top-level enum names to be <strong>globally unique</strong> across all enums used in your Services</li><li>No built-in Types that can accommodate .NET&#39;s <code>Decimal</code>, <code>Guid</code> Types</li><li>Loss of precision when using the built-in <code>Timestamp</code> to serialize .NET&#39;s <code>DateTime</code> or <code>DateTimeOffset</code></li></ul><p>The <a href="https://github.com/protobuf-net/protobuf-net" target="_blank" rel="noopener noreferrer">protobuf-net</a> library used in both Server and <code>GrpcServiceClient</code> implementations does its best to transparently work around above limitations, e.g:</p><ul><li>Creates multiple messages using reified generic type names for each concrete Generic Type used</li><li>Allows defining layout of base Types to embed (&quot;has a&quot;) relation of known sub types</li><li>Emits <code>ZERO</code> enum value for enums without <code>0</code> default values <ul><li>Due to unique naming enum scoping rules it&#39;s an error to do this for more than 1 Enum</li></ul></li><li>Utilizing custom Types defined in an accompanying <code>bcl.proto</code> to support .NET&#39;s <code>Decimal</code>, <code>Guid</code> Types</li><li>Other BCL Types like <code>DateTimeOffset</code> can be <a href="https://github.com/protobuf-net/protobuf-net/issues/226#issuecomment-319564317" target="_blank" rel="noopener noreferrer">supported via surrogates</a></li></ul><h2 id="features" tabindex="-1">Features <a class="header-anchor" href="#features" aria-hidden="true">#</a></h2><p>In addition to its code-first development model ServiceStack gRPC adds a number of useful features to simplify and provide a richer gRPC Services development experience:</p><h3 id="protobuf-net-inheritance" tabindex="-1">protobuf-net Inheritance <a class="header-anchor" href="#protobuf-net-inheritance" aria-hidden="true">#</a></h3><p>In order to support inheritance <a href="https://github.com/protobuf-net/protobuf-net/wiki/Getting-Started#inheritance" target="_blank" rel="noopener noreferrer">protobuf-net has to retrofit</a> its support by embedding sub classes as different fields in the base class type. This is awkward since all known sub classes needs to be defined upfront on the base type using a consistent and non-conflicting numerical field id.</p><p>As it&#39;s required by <a href="/autoquery.html">AutoQuery</a> it was important to best provide a seamless out-of-the-box solution to alleviate as much friction as possible, so ServiceStack pre-configures this numerical index on all known sub types in your Services Contract with a generated <a href="https://softwareengineering.stackexchange.com/a/145633/14025" target="_blank" rel="noopener noreferrer">Murmur2 hash</a> (best overall for speed/randomness) of the <strong>Types Name</strong> that&#39;s modded to within the <code>2^29-1</code> range of <a href="https://developers.google.com/protocol-buffers/docs/proto#assigning-field-numbers" target="_blank" rel="noopener noreferrer">valid field ids in protocol buffers</a> - resulting in a low (but still possible) index collision.</p><p>To instead use your own user-defined field id for inherited classes you can use the <code>[Id]</code> attribute, for AutoQuery Services it should at least start from <code>10</code> to avoid conflicts with its base class properties, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataContract</span><span class="token punctuation">,</span> <span class="token class-name">Id</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Order <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>[Id]</code> needs to be <strong>unique across all Sub Types</strong> and must not conflict with base class field ids, given AutoQuery Services share the same base-class, any user-defined <code>[Id(N)]</code> used needs to be <strong>unique across all your AutoQuery Services</strong>.</p><p>Both implicit or explicit <code>[Id]</code> inherited Types works nicely with the generic <code>GrpcServiceClient</code> where it allows calling the base and Sub Type properties, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryRockstars</span> <span class="token punctuation">{</span> Age <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">,</span> Include <span class="token operator">=</span> <span class="token string">&quot;Total&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Unfortunately usage of inheritance is <a href="https://github.com/protobuf-net/protobuf-net.Grpc/issues/50" target="_blank" rel="noopener noreferrer">currently not compatible with protoc clients</a> so in order to call AutoQuery Services from protoc generated clients you can utilize <strong>Dynamic gRPC Requests</strong> to execute any Service from an loosely-typed string dictionary.</p><h3 id="dynamic-grpc-requests" tabindex="-1">Dynamic gRPC Requests <a class="header-anchor" href="#dynamic-grpc-requests" aria-hidden="true">#</a></h3><p>Dynamic Requests lets you to populate Request DTOs of gRPC Services with a <code>DynamicRequest</code> DTO in the same way as <strong>QueryString</strong> and <strong>FormData</strong> is used to populate a Request DTO, in this case <code>DynamicRequest</code> is just a Request DTO containing a string dictionary:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataContract</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicRequest</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Order <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> Params <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Which just like QueryStrings/FormData are also able to <a href="/serialization-deserialization.html">populate deeply nested object graphs from a JSV string</a></p></blockquote><p>By default ServiceStack only generates Dynamic Services for Services annotated with the <code>[Tag(&quot;Dynamic&quot;)]</code> attribute, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Tag</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Keywords<span class="token punctuation">.</span>Dynamic<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataContract</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Order <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This generates an additional Service that uses a <code>DynamicRequest</code> DTO input, in the format:</p><pre><code>rpc [Verb]Dynamic[RequestType](DynamicRequest) returns (ResponseType) {}
</code></pre><p>For the <code>QueryRockstars</code> above, it generates:</p><pre><code>rpc GetDynamicQueryRockstars(DynamicRequest) returns (QueryResponse_Rockstar) {}
</code></pre><p>Dynamic Requests are useful when you&#39;d prefer to be able to populate Requests from an untyped string Dictionary such as implementing a <a href="https://github.com/ServiceStack/Admin" target="_blank" rel="noopener noreferrer">dynamic Query Builder UI</a> which would require significantly less effort and boilerplate then trying to map dynamic rules into populating a typed Request.</p><p>They&#39;re also required for calling Services that doesn&#39;t have an explicit Service contract like any untyped <a href="/autoquery-rdbms.html#implicit-conventions">AutoQuery Services utilizing implicit conventions</a>, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueryRockstars</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryDb<span class="token punctuation">&lt;</span>Rockstar<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>Until <a href="https://github.com/protobuf-net/protobuf-net.Grpc/issues/50" target="_blank" rel="noopener noreferrer">protoc clients are compatible with protobuf-net inheritance</a> they can be used as an alternative for calling inheritance-based Request DTOs like AutoQuery.</p><p>The <code>CreateDynamicService</code> predicate determines which Services should have dynamic requests generated for it, by default it&#39;s limited to Request DTOs annotated with <code>[Tag(&quot;Dynamic&quot;)]</code>, but can also be made to have dynamic requests generated for <strong>all AutoQuery Services</strong> with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcFeature</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    CreateDynamicService <span class="token operator">=</span> GrpcConfig<span class="token punctuation">.</span>AutoQueryOrDynamicAttribute
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When configured each AutoQuery Service will have an additional Service starting with <code>GetDynamic*</code> available that can be called with a <code>DynamicRequest</code>, in fact the same <code>DynamicRequest</code> can be used to call either Typed or Untyped AutoQuery Services, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetDynamicQueryRockstarsAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">DynamicRequest</span> <span class="token punctuation">{</span>
    Params <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">{</span> <span class="token string">&quot;Age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;27&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
        <span class="token punctuation">{</span> <span class="token string">&quot;OrderBy&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FirstName&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token string">&quot;Include&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Total&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In addition to populating the Request DTO each dynamic param will also be available to your services via the <code>IRequest.QueryString</code> collection.</p><h3 id="simulate-http-requests" tabindex="-1">Simulate HTTP Requests <a class="header-anchor" href="#simulate-http-requests" aria-hidden="true">#</a></h3><p>Similar to <code>DynamicRequest</code> even normal typed gRPC Service requests can be augmented with gRPC Metadata Request Headers where they can be used to be able to simulate an HTTP Request where headers starting with:</p><ul><li><code>query.</code> - added to <code>IRequest.QueryString</code></li><li><code>form.</code> - added to <code>IRequest.FormData</code></li><li><code>cookie.</code> - added to <code>IRequest.Cookies</code></li><li><code>header.</code> - added to <code>IRequest.Headers</code> (default)</li><li>Remaining headers without above prefixes are added to <code>IRequest.Headers</code> as-is.</li></ul><p>This can be used to simulate a valid HTTP Request for Filters, Plugins and HTTP APIs that are specific in how they analyze HTTP Requests.</p><p>So just like <code>DynamicRequest</code> you can use dynamic gRPC Metadata Headers to populated typed gRPC Service requests, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcServiceClient</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    RequestFilter <span class="token operator">=</span> ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span>RequestHeaders<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;UserAgent&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Googlebot/2.1 (+http://www.google.com/bot.html)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//impersonate</span>
        ctx<span class="token punctuation">.</span>RequestHeaders<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;query.Age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;27&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span>RequestHeaders<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;query.OrderBy&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FirstName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span>RequestHeaders<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;query.Include&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Total&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryRockstars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Where each matching property will populate the Request DTO with the string value using the conversion rules in <a href="/auto-mapping.html">ServiceStack&#39;s Auto Mapping</a>.</p><p>If you don&#39;t wish for Headers to be able to populate Typed gRPC Requests, it can be disabled with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcFeature</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    DisableRequestParamsInHeaders <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="server-stream-grpc-services" tabindex="-1">Server Stream gRPC Services <a class="header-anchor" href="#server-stream-grpc-services" aria-hidden="true">#</a></h3><p>All gRPC Services we&#39;ve seen so far are what gRPC Refers to as <strong>Unary RPC</strong>, i.e. where clients sends a single request to the server and gets a single response back. Another very useful communication style supported by gRPC is <strong>Server streaming</strong>:</p><blockquote><p>the client sends a request to the server and gets a stream to read a sequence of messages back. The client reads from the returned stream until there are no more messages. gRPC guarantees message ordering within an individual RPC call.</p></blockquote><h4 id="streamserverevents" tabindex="-1">StreamServerEvents <a class="header-anchor" href="#streamserverevents" aria-hidden="true">#</a></h4><p>There are a couple of scenarios in ServiceStack where this communication channel is especially useful such as <a href="/server-events.html">Server Events</a> which operates in a similar style with clients connecting to a long-lived HTTP connection that streams back &quot;real-time Events&quot; over the light and efficient <a href="https://www.html5rocks.com/en/tutorials/eventsource/basics/" target="_blank" rel="noopener noreferrer">SSE</a> standard natively supported in modern browsers.</p><p>Although as HTTP Requests are not normally used for maintaining long-lived connections they&#39;re susceptible to issues like buffering from App Servers, middleware and proxies and require implementing a bespoke health-check and auto-reconnect solution in order to maintain interrupted service.</p><p>As a first class supported communication channel clients can instead leverage gRPC&#39;s library infrastructure which is perfectly suited for streaming real-time Server Events over an efficient persistent HTTP/2 channel that&#39;s available from the <code>StreamServerEvents</code> gRPC Service:</p><pre><code>rpc ServerStreamServerEvents(StreamServerEvents) returns (stream StreamServerEventsResponse) {}
</code></pre><p>Which gives all <code>protoc</code> supported languages a Typed Client for consuming your <a href="/server-events.html">Server Events</a>.</p><h4 id="grpcserviceclient-streams" tabindex="-1">GrpcServiceClient Streams <a class="header-anchor" href="#grpcserviceclient-streams" aria-hidden="true">#</a></h4><p>When using the generic <code>GrpcServiceClient</code> you&#39;re able to take advantage of C#&#39;s 8 new <code>await foreach</code> syntax sugar for consuming gRPC Server Streams.</p><p>Its usage is analogous to all Server Events clients where your initial connection contains the channels you want to subscribe to receive notifications from, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> stream <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">StreamAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamServerEvents</span> <span class="token punctuation">{</span>
    Channels <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;todos&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Then you can use <code>await foreach</code> to consume an endless stream of Server Events. Use <code>Selector</code> to identify the type of Server Event whilst the complex-type body of each event message can be parsed from its JSON body, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">await</span> <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> msg <span class="token keyword">in</span> stream<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>Selector<span class="token punctuation">.</span><span class="token function">StartsWith</span><span class="token punctuation">(</span><span class="token string">&quot;todos.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//custom todos.* events</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> obj <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>Json<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//body of message in JSON</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">is</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//todos.create + todos.update properties</span>
            <span class="token class-name"><span class="token keyword">var</span></span> id <span class="token operator">=</span> map<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> title <span class="token operator">=</span> map<span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token interpolation-string"><span class="token string">$&quot;EVENT </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">msg<span class="token punctuation">.</span>Selector</span><span class="token punctuation">}</span></span><span class="token string"> [</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">msg<span class="token punctuation">.</span>Channel</span><span class="token punctuation">}</span></span><span class="token string">]: #</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">id</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">title</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//todos.delete id</span>
            <span class="token interpolation-string"><span class="token string">$&quot;EVENT </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">msg<span class="token punctuation">.</span>Selector</span><span class="token punctuation">}</span></span><span class="token string"> [</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">msg<span class="token punctuation">.</span>Channel</span><span class="token punctuation">}</span></span><span class="token string">]: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">obj</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// general server events, e.g cmd.onConnect, cmd.onJoin, cmd.onLeave</span>
        <span class="token interpolation-string"><span class="token string">$&quot;EVENT </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">msg<span class="token punctuation">.</span>Selector</span><span class="token punctuation">}</span></span><span class="token string"> [</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">msg<span class="token punctuation">.</span>Channel</span><span class="token punctuation">}</span></span><span class="token string">]: #</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">msg<span class="token punctuation">.</span>UserId</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">msg<span class="token punctuation">.</span>DisplayName</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If connected whilst running the <a href="https://todoworld.servicestack.net/#user-content-c-local-development-grpc-ssl-crud-example" target="_blank" rel="noopener noreferrer">TodoWorld CRUD Example</a> this stream will output something similar to:</p><pre><code>EVENT cmd.onConnect []: #-1 user1
EVENT cmd.onJoin [todos]: #-1 user1
EVENT todos.create [todos]: #1 ServiceStack
EVENT todos.update [todos]: #1 gRPC
EVENT todos.delete [todos]: 1
</code></pre><h4 id="protoc-dart-streams" tabindex="-1">protoc Dart Streams <a class="header-anchor" href="#protoc-dart-streams" aria-hidden="true">#</a></h4><p>Other <code>protoc</code> languages will require using their own language constructs for consuming gRPC Streams, here&#39;s the <a href="https://todoworld.servicestack.net/#dart" target="_blank" rel="noopener noreferrer">example for Dart</a> that also has a pleasant API for consuming Server Streams:</p><div class="language-dart"><pre><code><span class="token keyword">var</span> stream <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">serverStreamServerEvents</span><span class="token punctuation">(</span><span class="token class-name">StreamServerEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span>channels<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;todos&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> r <span class="token keyword">in</span> stream<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token function">jsonDecode</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>r<span class="token punctuation">.</span>selector<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;todos&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">is</span> <span class="token class-name">Map</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#39;EVENT \${r.selector} [\${r.channel}]: #\${obj[&#39;</span>id<span class="token string">&#39;]} \${obj[&#39;</span>title<span class="token string">&#39;]}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#39;EVENT \${r.selector} [\${r.channel}]: \${obj}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#39;EVENT \${r.selector} \${r.channels}: #\${obj[&#39;</span>userId<span class="token string">&#39;]} \${obj[&#39;</span>displayName<span class="token string">&#39;]}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="implementing-server-stream-services" tabindex="-1">Implementing Server Stream Services <a class="header-anchor" href="#implementing-server-stream-services" aria-hidden="true">#</a></h3><p>As they&#39;re not your typical unary-style Request/Response service, Server Streams are handled and implemented a little differently where in addition to inheriting ServiceStack&#39;s base <code>Service</code> class you&#39;ll need to implement the <code>IStreamService&lt;TRequest,TResponse&gt;</code> interface and implement its <code>Stream()</code> method for your Server Stream implementation.</p><p>Here&#39;s the implementation of ServiceStack&#39;s built-in <code>StreamFiles</code> Service which accepts multiple virtual paths of files and returns the File contents and metadata in the same order:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StreamFileService</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span><span class="token punctuation">,</span> <span class="token class-name">IStreamService<span class="token punctuation">&lt;</span>StreamFiles<span class="token punctuation">,</span>FileContent<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">IAsyncEnumerable<span class="token punctuation">&lt;</span>FileContent<span class="token punctuation">&gt;</span></span> <span class="token function">Stream</span><span class="token punctuation">(</span><span class="token class-name">StreamFiles</span> request<span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancel <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> paths <span class="token operator">=</span> request<span class="token punctuation">.</span>Paths <span class="token operator">??</span> TypeConstants<span class="token punctuation">.</span>EmptyStringList<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>cancel<span class="token punctuation">.</span>IsCancellationRequested<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> file <span class="token operator">=</span> VirtualFileSources<span class="token punctuation">.</span><span class="token function">GetFile</span><span class="token punctuation">(</span>paths<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> bytes <span class="token operator">=</span> file<span class="token punctuation">?.</span><span class="token function">GetBytesContentsAsBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> to <span class="token operator">=</span> file <span class="token operator">!=</span> <span class="token keyword">null</span>
                <span class="token punctuation">?</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileContent</span> <span class="token punctuation">{</span>
                    Name <span class="token operator">=</span> file<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
                    Type <span class="token operator">=</span> MimeTypes<span class="token punctuation">.</span><span class="token function">GetMimeType</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>Extension<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    Body <span class="token operator">=</span> bytes<span class="token punctuation">,</span>
                    Length <span class="token operator">=</span> bytes<span class="token punctuation">.</span>Length<span class="token punctuation">,</span>
                <span class="token punctuation">}</span>
                <span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileContent</span> <span class="token punctuation">{</span>
                    Name <span class="token operator">=</span> paths<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
                    ResponseStatus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ResponseStatus</span> <span class="token punctuation">{</span>
                        ErrorCode <span class="token operator">=</span> <span class="token keyword">nameof</span><span class="token punctuation">(</span>HttpStatusCode<span class="token punctuation">.</span>NotFound<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        Message <span class="token operator">=</span> <span class="token string">&quot;File does not exist&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            
            <span class="token keyword">yield</span> <span class="token keyword">return</span> to<span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>i <span class="token operator">&gt;=</span> paths<span class="token punctuation">.</span>Count<span class="token punctuation">)</span>
                <span class="token keyword">yield</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Although <code>StreamFiles</code> is already pre-registered, to register your own gRPC Stream Service add them to the <code>RegisterServices</code> collection:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcFeature</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    RegisterServices <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">StreamFileService</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>Or remove the pre-registered <code>StreamFileService</code> and <code>SubscribeServerEventsService</code> services to disable them</p></blockquote><p>Clients can use <code>StreamFiles</code> to efficiently download multiple files over a single gRPC HTTP/2 Server Stream connection in their preferred order:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamFiles</span> <span class="token punctuation">{</span>
    Paths <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token string">&quot;/js/ss-utils.js&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/js/hot-loader.js&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/js/not-exists.js&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/js/hot-fileloader.js&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> files <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>FileContent<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> file <span class="token keyword">in</span> client<span class="token punctuation">.</span><span class="token function">StreamAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    files<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>With each <code>FileContent</code> result containing either the file contents and metadata or an error response for missing files, e.g:</p><div class="language-csharp"><pre><code><span class="token comment">// files[0].Name = &#39;ss-utils.js&#39;</span>
<span class="token comment">// files[1].Name = &#39;hot-loader.js&#39;</span>
<span class="token comment">// files[2].ResponseStatus.ErrorCode = NotFound</span>
<span class="token comment">// files[3].Name = &#39;hot-fileloader.js&#39;</span>
</code></pre></div><h4 id="protoc-dart-example" tabindex="-1">protoc Dart Example <a class="header-anchor" href="#protoc-dart-example" aria-hidden="true">#</a></h4><p>Example of server streaming of files from a protoc generated Dart client:</p><div class="language-dart"><pre><code><span class="token keyword">var</span> stream <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">serverStreamFiles</span><span class="token punctuation">(</span><span class="token class-name">StreamFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span>paths<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token string">&#39;/js/ss-utils.js&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&#39;/js/hot-loader.js&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&#39;/js/hot-fileloader.js&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> file <span class="token keyword">in</span> stream<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> text <span class="token operator">=</span> utf8<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&#39;FILE \${file.name} (\${file.length}): \${text.substring(0, text.length &lt; 50 ? text.length : 50)} ...&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ssl-certificate-configuration" tabindex="-1">SSL Certificate Configuration <a class="header-anchor" href="#ssl-certificate-configuration" aria-hidden="true">#</a></h2><p>Please see the <a href="/grpc-ssl.html">gRPC SSL docs</a> for information on how to secure your gRPC connections including scripts for creating custom self-signed certificates and hosting public gRPC Services behind nginx reverse proxies.</p><h2 id="grpc-clients" tabindex="-1">gRPC Clients <a class="header-anchor" href="#grpc-clients" aria-hidden="true">#</a></h2><p>Visit <a href="https://todoworld.servicestack.net" target="_blank" rel="noopener noreferrer">todoworld.servicestack.net</a> to explore how easy it is to consume ServiceStack gRPC Services in different languages.</p><p><a href="https://todoworld.servicestack.net/#csharp-generic" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/grpc/grpc-videos-generic.png" alt=""></a></p><p>For most .NET Clients we recommend using our generic <code>GrpcServiceClient</code> with deeper ServiceStack integration that can be used with the richer <a href="/add-servicestack-reference.html">Add ServiceStack Reference</a> POCO DTOs that implements the same shared Service Client interfaces adopted by all ServiceStack&#39;s <a href="/csharp-client.html">.NET Service Clients</a>:</p><ul><li><a href="/grpc-generic.html">C# / F# / VB.NET Smart GrpcServiceClient</a></li></ul><h3 id="protoc-generated-clients" tabindex="-1">protoc generated clients <a class="header-anchor" href="#protoc-generated-clients" aria-hidden="true">#</a></h3><p><a href="https://todoworld.servicestack.net/#csharp" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/grpc/grpc-videos-protoc.png" alt=""></a></p><p>For all non .NET Clients and AOT environments like Xamarin.iOS we recommend using Google&#39;s <code>protoc</code> generated clients:</p><ul><li><a href="/grpc-csharp.html">C#</a></li><li><a href="/grpc-swift.html">Swift</a></li><li><a href="/grpc-java.html">Java</a></li><li><a href="/grpc-dart.html">Dart</a></li><li><a href="/grpc-go.html">Go</a></li><li><a href="/grpc-nodejs.html">Node.js</a></li><li><a href="/grpc-python.html">Python</a></li><li><a href="/grpc-ruby.html">Ruby</a></li><li><a href="/grpc-php.html">PHP</a></li></ul><h2 id="grpc-web" tabindex="-1">gRPC Web <a class="header-anchor" href="#grpc-web" aria-hidden="true">#</a></h2><p>As it&#39;s <a href="https://grpc.io/blog/state-of-grpc-web/" target="_blank" rel="noopener noreferrer">impossible to implement the HTTP/2 gRPC spec in the browser</a>, in order to be able to consume gRPC services from a browser a <a href="https://grpc.io/blog/state-of-grpc-web/#the-tech" target="_blank" rel="noopener noreferrer">gRPC Web Proxy</a> is needed.</p><p>The current recommendation from the gRPC Web team is to <a href="https://grpc.io/docs/tutorials/basic/web/#configure-the-envoy-proxy" target="_blank" rel="noopener noreferrer">Configure the Envoy Proxy</a> to forward gRPC browser requests to the native gRPC endpoint, however as it adds more moving parts and additional complexity, if you&#39;re not already using envoyproxy we instead recommended using ServiceStack HTTP JSON Services, made possible since ServiceStack&#39;s gRPC Service implementations are also made available over REST-ful HTTP APIs - i.e. the lingua franca of the web.</p><p>If <a href="https://github.com/grpc/grpc-dotnet/issues/99" target="_blank" rel="noopener noreferrer">ASP.NET Core adds native gRPC Web support</a> then using gRPC clients may provide a more appealing option although it won&#39;t have a clean, versatile and rich API as <a href="https://docs.servicestack.net/typescript-add-servicestack-reference" target="_blank" rel="noopener noreferrer">TypeScript Add ServiceStack Reference</a>.</p><h3 id="x-dotnet-tool-grpc-web-support" tabindex="-1">x dotnet tool gRPC Web support <a class="header-anchor" href="#x-dotnet-tool-grpc-web-support" aria-hidden="true">#</a></h3><p>If wanting to evaluate using a gRPC Web Proxy you can use generate different TypeScript and JavaScript clients using the commands below:</p><pre><code>$ x proto-ts &lt;url&gt;             # TypeScript + gRPC Web Text
$ x proto-ts-binary &lt;url&gt;      # TypeScript + gRPC Web Binary
$ x proto-js-closure &lt;url&gt;     # Google Closure + gRPC Web Text
$ x proto-js-commonjs &lt;url&gt;    # Common JS + gRPC Web Text
</code></pre><p>Or if preferred you can use the online UI or HTTP API for generating Protocol Buffers and gRPC client proxies at <a href="https://grpc.servicestack.net" target="_blank" rel="noopener noreferrer">grpc.servicestack.net</a>.</p><h2 id="grpc-configuration" tabindex="-1">gRPC Configuration <a class="header-anchor" href="#grpc-configuration" aria-hidden="true">#</a></h2><p>There are a number of additional configuration options for customizing and extending ServiceStack&#39;s gRPC support:</p><h3 id="protobuf-serialization" tabindex="-1">Protobuf Serialization <a class="header-anchor" href="#protobuf-serialization" aria-hidden="true">#</a></h3><p>Behavior of how <a href="https://github.com/protobuf-net/protobuf-net" target="_blank" rel="noopener noreferrer">protobuf-net</a> de/serializes .NET Models can be customized by modifying <code>GrpcConfig.TypeModel</code> where any customizations should be applied to both server and client apps if using <a href="/grpc-generic.html">C# generic GrpcServiceClient</a>.</p><h3 id="any-methods" tabindex="-1">Any Methods <a class="header-anchor" href="#any-methods" aria-hidden="true">#</a></h3><p>ServiceStack lets you define <code>Any()</code> services which can be invoked when called on each HTTP Method. To minimize gRPC surface area pollution, by default ServiceStack only generates different <strong>rpc</strong> endpoints for HTTP&#39;s primary <code>Get*</code>, <code>Post*</code>, <code>Put*</code> and <code>Delete*</code> verbs.</p><p>To change this for <strong>all Any services</strong> specify which methods you want generated in <code>DefaultMethodsForAny</code> list, e.g. you can specify to only generate <code>Get*</code> and <code>Post*</code> methods with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcFeature</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    DefaultMethodsForAny <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> 
        HttpMethods<span class="token punctuation">.</span>Get<span class="token punctuation">,</span>
        HttpMethods<span class="token punctuation">.</span>Post<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>As <a href="/autoquery.html">AutoQuery Services</a> are read-only queries they only default to generating <code>Get*</code> rpc methods, which can be changed with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcFeature</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    AutoQueryMethodsForAny <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> 
        HttpMethods<span class="token punctuation">.</span>Get<span class="token punctuation">,</span>
        HttpMethods<span class="token punctuation">.</span>Post<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This can be customized per service by annotating your Request DTO with <code>IVerb</code> marker interfaces, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataContract</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IReturn<span class="token punctuation">&lt;</span>HelloResponse<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">IGet</span><span class="token punctuation">,</span> <span class="token class-name">IPost</span></span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyServices</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token class-name">Hello</span> request<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Alternatively you can replace your <code>Any()</code> method and only implement the specific methods you want generated, e.g. <code>Get()</code> or <code>Post()</code>.</p><p>For even finer-grained customization you can override the <code>GenerateMethodsForAny</code> predicate to adopt your own conventions.</p><h3 id="custom-grpc-status-codes" tabindex="-1">Custom gRPC Status Codes <a class="header-anchor" href="#custom-grpc-status-codes" aria-hidden="true">#</a></h3><p>gRPC has are reduced number of <a href="https://github.com/grpc/grpc/blob/master/doc/statuscodes.md" target="_blank" rel="noopener noreferrer">Error Status Codes</a> compared to what&#39;s available in HTTP, you can override ServiceStack&#39;s built-in <code>HTTP &gt; gRPC</code> mapping with your own implementation by populating <code>ToGrpcStatus</code>, e.g:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcFeature</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ToGrpcStatus <span class="token operator">=</span> httpRes <span class="token operator">=&gt;</span> httpRes<span class="token punctuation">.</span>StatusCode <span class="token operator">==</span> <span class="token number">404</span>
        <span class="token punctuation">?</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Status</span><span class="token punctuation">(</span>StatusCode<span class="token punctuation">.</span>NotFound<span class="token punctuation">,</span> httpRes<span class="token punctuation">.</span>StatusDescription<span class="token punctuation">)</span>
        <span class="token punctuation">:</span> <span class="token punctuation">(</span>Status<span class="token punctuation">?</span><span class="token punctuation">)</span> <span class="token keyword">null</span> <span class="token comment">// use default behavior</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="filtered-http-headers" tabindex="-1">Filtered HTTP Headers <a class="header-anchor" href="#filtered-http-headers" aria-hidden="true">#</a></h3><p>You can control which of your custom HTTP Headers you don&#39;t want to return by adding them to the <code>IgnoreResponseHeaders</code> collection:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcFeature</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    IgnoreResponseHeaders <span class="token operator">=</span> <span class="token punctuation">{</span> HttpHeaders<span class="token punctuation">.</span>ContentDisposition <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="proto-options" tabindex="-1">Proto Options <a class="header-anchor" href="#proto-options" aria-hidden="true">#</a></h3><p>The auto-generated <code>.proto</code> service description ServiceStack generates at <code>/types/proto</code> allows for <a href="https://developers.google.com/protocol-buffers/docs/proto#options" target="_blank" rel="noopener noreferrer">proto options</a> to customize <code>protoc</code> code-generation behavior which are pre-configured with C# and PHP namespaces used in its generated proxy clients.</p><p>You can include your own proto options by registering them in the <code>ProtoOptions</code> collection as seen below:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcFeature</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ProtoOptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>ProtoOptionDelegate<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> 
        ProtoOption<span class="token punctuation">.</span>CSharpNamespace<span class="token punctuation">,</span>
        ProtoOption<span class="token punctuation">.</span>PhpNamespace<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ProtoOption</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">CSharpNamespace</span><span class="token punctuation">(</span><span class="token class-name">IRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">MetadataTypesConfig</span> config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token interpolation-string"><span class="token string">$&quot;option csharp_namespace = \\&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">config<span class="token punctuation">.</span>GlobalNamespace</span><span class="token punctuation">}</span></span><span class="token string">\\&quot;;&quot;</span></span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">PhpNamespace</span><span class="token punctuation">(</span><span class="token class-name">IRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">MetadataTypesConfig</span> config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token interpolation-string"><span class="token string">$&quot;option php_namespace = \\&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">config<span class="token punctuation">.</span>GlobalNamespace</span><span class="token punctuation">}</span></span><span class="token string">\\&quot;;&quot;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="public-grpc-protoc-service-and-ui" tabindex="-1">Public gRPC protoc Service and UI <a class="header-anchor" href="#public-grpc-protoc-service-and-ui" aria-hidden="true">#</a></h2><blockquote><p><a href="https://grpc.servicestack.net" target="_blank" rel="noopener noreferrer">grpc.servicestack.net</a></p></blockquote><p><a href="https://grpc.servicestack.net" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/grpc/protoc-api.png" alt=""></a></p><p>To provide the simplest and seamless end-to-end gRPC solution we&#39;re maintaining a <strong><a href="https://grpc.servicestack.net" target="_blank" rel="noopener noreferrer">public gRPC protoc Service</a></strong> and UI which is the backend empowering our cross-platform <a href="/dotnet-tool.html">dotnet tools</a> to be able to generate Protocol Buffer DTOs and gRPC clients in every <code>protoc</code> supported language without any installation, tooling or configuration required.</p><p>This is a public service <strong>any gRPC clients using any gRPC Service framework</strong> can use as an alternative for having each client configure and maintain their build system to use protoc tooling.</p><p>Local <strong>.proto</strong> files aren&#39;t necessary for ServiceStack gRPC Services with gRPC clients only needing a URL, e.g:</p><pre><code>$ x proto-&lt;lang&gt; https://todoworld.servicestack.net
</code></pre><h3 id="from-proto-descriptors" tabindex="-1">From .proto descriptors <a class="header-anchor" href="#from-proto-descriptors" aria-hidden="true">#</a></h3><p>Other clients can generate protoc clients from either a single <strong>.proto</strong> services description:</p><pre><code>$ x proto-&lt;lang&gt; services.proto
</code></pre><p>Or upload multiple <strong>.proto</strong> files by specifying a directory instead:</p><pre><code>$ x proto-&lt;lang&gt; /path/to/grpc/protos
</code></pre><p>Use <strong>-out</strong> to specify a different directory to save the protoc generated classes to, e.g:</p><pre><code>$ x proto-&lt;lang&gt; services.proto -out /path/to/dir
</code></pre><h3 id="using-curl" tabindex="-1">Using curl <a class="header-anchor" href="#using-curl" aria-hidden="true">#</a></h3><p>Alternatively you can use curl command-line HTTP Client to download protoc generated classes in a <strong>.zip</strong> archive:</p><pre><code>$ curl -F &#39;file1=@services.proto&#39; https://grpc.servicestack.net/protoc/[lang]?zip -L -o grpc.zip
</code></pre><p>Below is a complete list of different languages supported by this public gRPC Service:</p><table><thead><tr><th>Lang</th><th>Description</th></tr></thead><tbody><tr><td>cpp</td><td>C++</td></tr><tr><td>csharp</td><td>C#</td></tr><tr><td>dart</td><td>Dart</td></tr><tr><td>go</td><td>Go</td></tr><tr><td>java</td><td>Java</td></tr><tr><td>java-lite</td><td>Java (Lite)</td></tr><tr><td>js-node</td><td>JavaScript (node.js)</td></tr><tr><td>objc</td><td>Objective C</td></tr><tr><td>php</td><td>PHP</td></tr><tr><td>python</td><td>Python</td></tr><tr><td>ruby</td><td>Ruby</td></tr><tr><td>swift</td><td>Swift</td></tr><tr><td><strong>gRPC Web Languages</strong></td><td></td></tr><tr><td>js-closure</td><td>JavaScript (Closure)</td></tr><tr><td>js-commonjs</td><td>JavaScript (CommonJS)</td></tr><tr><td>ts</td><td>TypeScript</td></tr><tr><td>ts-binary</td><td>TypeScript (Binary)</td></tr></tbody></table><h2 id="mix-in-gists" tabindex="-1">Mix in Gists <a class="header-anchor" href="#mix-in-gists" aria-hidden="true">#</a></h2><p><a href="https://github.com/GuerrillaCoder" target="_blank" rel="noopener noreferrer">@GuerrillaCoder</a> from the ServiceStack community has added a couple of <a href="/mix-tool.html">Mix gists</a> for effortlessly configuring <a href="/modular-startup.html">Modular Startup</a> Apps:</p><p>Adds hangfire cron scheduler and dashboard for PostgreSQL by applying <a href="https://gist.github.com/GuerrillaCoder/28ae3d10f3063bf693da1d566dbb6000" target="_blank" rel="noopener noreferrer">this Gist</a>:</p><pre><code>$ x mix hangfire-postgres
</code></pre><p>Configures <a href="https://www.nuget.org/packages/NLog" target="_blank" rel="noopener noreferrer">NLog</a> and adds prod/dev config files based on default NLog config by applying <a href="https://gist.github.com/GuerrillaCoder/5e42aea8a1462dacbe8640328ae4c162" target="_blank" rel="noopener noreferrer">this gist</a>:</p><pre><code>$ x mix nlog
</code></pre><blockquote><p>Saves to path specified in <code>APP_LOG_PATH</code> Environment variable</p></blockquote><h2 id="ormlite" tabindex="-1">OrmLite <a class="header-anchor" href="#ormlite" aria-hidden="true">#</a></h2><h3 id="dapper" tabindex="-1">Dapper <a class="header-anchor" href="#dapper" aria-hidden="true">#</a></h3><p>OrmLite&#39;s interned version of Dapper has been upgraded to the latest version.</p><h3 id="xml-field-support-in-postgresql" tabindex="-1">XML Field Support in PostgreSQL <a class="header-anchor" href="#xml-field-support-in-postgresql" aria-hidden="true">#</a></h3><p>The new <a href="https://stackoverflow.com/a/58404980/85785" target="_blank" rel="noopener noreferrer">XmlValue struct and OrmLite Converter</a> lets you create, insert and query using PostgreSQL XML functions, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> dbFactory<span class="token punctuation">.</span><span class="token function">OpenDbConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DropAndCreateTable</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>XmlTest<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    db<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlTest</span> <span class="token punctuation">{</span> Id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Xml <span class="token operator">=</span> <span class="token string">@&quot;&lt;attendee&gt;
&lt;bio&gt;
    &lt;name&gt;John Doe&lt;/name&gt;
    &lt;birthYear&gt;1986&lt;/birthYear&gt;
&lt;/bio&gt;
&lt;languages&gt;
    &lt;lang level=&quot;&quot;5&quot;&quot;&gt;php&lt;/lang&gt;
    &lt;lang level=&quot;&quot;4&quot;&quot;&gt;python&lt;/lang&gt;
    &lt;lang level=&quot;&quot;2&quot;&quot;&gt;java&lt;/lang&gt;
&lt;/languages&gt;
&lt;/attendee&gt;&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        db<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlTest</span> <span class="token punctuation">{</span> Id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Xml <span class="token operator">=</span> <span class="token string">@&quot;&lt;attendee&gt;
&lt;bio&gt;
    &lt;name&gt;Tom Smith&lt;/name&gt;
    &lt;birthYear&gt;1978&lt;/birthYear&gt;
&lt;/bio&gt;
&lt;languages&gt;
    &lt;lang level=&quot;&quot;5&quot;&quot;&gt;python&lt;/lang&gt;
    &lt;lang level=&quot;&quot;3&quot;&quot;&gt;java&lt;/lang&gt;
    &lt;lang level=&quot;&quot;1&quot;&quot;&gt;ruby&lt;/lang&gt;
&lt;/languages&gt;
&lt;/attendee&gt;&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword">var</span></span> results <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Column</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">@&quot;SELECT
        (xpath(&#39;//bio/name/text()&#39;, Xml)::text[])[1]
        FROM xml_test 
        WHERE cast(xpath(&#39;//bio[birthYear&gt;1980]&#39;, Xml) as text[]) != &#39;{}&#39;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">//= John Doe</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="nolock-sql-server-table-hint" tabindex="-1">NOLOCK SQL Server Table Hint <a class="header-anchor" href="#nolock-sql-server-table-hint" aria-hidden="true">#</a></h3><p>New NOLOCK <a href="https://github.com/ServiceStack/ServiceStack.OrmLite#sql-server-table-hints" target="_blank" rel="noopener noreferrer">SQL Server Table Hint</a> available:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> q <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">From</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Car<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Join</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Car<span class="token punctuation">,</span> CarType<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>CarId <span class="token operator">==</span> t<span class="token punctuation">.</span>CarId<span class="token punctuation">,</span> SqlServerTableHint<span class="token punctuation">.</span>NoLock<span class="token punctuation">)</span>
</code></pre></div><h3 id="servicestack-text" tabindex="-1">ServiceStack.Text <a class="header-anchor" href="#servicestack-text" aria-hidden="true">#</a></h3><p>New <a href="https://softwareengineering.stackexchange.com/questions/49550/which-hashing-algorithm-is-best-for-uniqueness-and-speed#answer-145633" target="_blank" rel="noopener noreferrer">Murmur2 Hash</a> APIs available:</p><div class="language-csharp"><pre><code><span class="token return-type class-name"><span class="token keyword">uint</span></span> MurmurHash2<span class="token punctuation">.</span><span class="token function">Hash</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token return-type class-name"><span class="token keyword">uint</span></span> MurmurHash2<span class="token punctuation">.</span><span class="token function">Hash</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token return-type class-name"><span class="token keyword">uint</span></span> MurmurHash2<span class="token punctuation">.</span><span class="token function">Hash</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> data<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">uint</span></span> seed<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="new-script-methods" tabindex="-1">New #Script Methods <a class="header-anchor" href="#new-script-methods" aria-hidden="true">#</a></h2><p>New <code>readLines()</code> #Script Method available for streaming a file by line, e.g:</p><div class="language-hbs"><pre><code><span class="token block keyword">#each</span> <span class="token variable">line</span> <span class="token variable">in</span> <span class="token string">&#39;path/to/file.txt&#39;</span><span class="token punctuation">.</span><span class="token variable">fileTextContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token variable">readLines</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">/</span><span class="token variable">each</span>
</code></pre></div><ul><li>Whilst <code>splitLines()</code> returns lines in a <code>string[]</code></li><li>New <code>snakeCase()</code> and <code>kebabCase()</code> script methods and text-style options</li><li>New <code>resolveFile()</code> returns a <code>IVirtualFile</code> from configured <code>ScriptContext.VirtualFiles</code></li><li>New <code>exit(int code)</code> for exiting a <a href="https://sharpscript.net/docs/sharp-scripts" target="_blank" rel="noopener noreferrer">Sharp Script</a> with the specified exit code</li></ul>`,254),p=[o];function c(r,i,l,u,d,k){return a(),s("div",null,p)}var m=n(t,[["render",c]]);export{g as __pageData,m as default};
