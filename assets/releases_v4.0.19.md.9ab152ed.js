import{_ as a,c as e,o as t,a as n,b as s,e as o}from"./app.14440598.js";const w='{"title":"v4.0.19 Release Notes","description":"","frontmatter":{"title":"v4.0.19 Release Notes","slug":"v4-0-19"},"headers":[{"level":2,"title":"Embedded ServiceStack","slug":"embedded-servicestack"},{"level":3,"title":"Razor Rockstars - Embedded Edition","slug":"razor-rockstars-embedded-edition"},{"level":3,"title":"As a Single Self-Hosted .exe","slug":"as-a-single-self-hosted-exe"},{"level":3,"title":"Running inside Windows and OSX Native Desktop Apps","slug":"running-inside-windows-and-osx-native-desktop-apps"},{"level":3,"title":"Standard Web Hosts","slug":"standard-web-hosts"},{"level":3,"title":"ILMerging","slug":"ilmerging"},{"level":3,"title":"Compiled Razor Views","slug":"compiled-razor-views"},{"level":2,"title":"Postman Support","slug":"postman-support"},{"level":3,"title":"Support for authenticated requests","slug":"support-for-authenticated-requests"},{"level":3,"title":"Other Customizations","slug":"other-customizations"},{"level":2,"title":"Cascading layout templates","slug":"cascading-layout-templates"},{"level":2,"title":"Async APIs added to HTTP Utils","slug":"async-apis-added-to-http-utils"},{"level":2,"title":"Redis","slug":"redis"},{"level":3,"title":"Twemproxy support","slug":"twemproxy-support"},{"level":2,"title":"OrmLite","slug":"ormlite"},{"level":3,"title":"Other Features","slug":"other-features"},{"level":3,"title":"Example Results","slug":"example-results"}],"relativePath":"releases/v4.0.19.md","lastUpdated":1634495308430}',p={},c=n(`<h2 id="embedded-servicestack" tabindex="-1">Embedded ServiceStack <a class="header-anchor" href="#embedded-servicestack" aria-hidden="true">#</a></h2><p>This release has put all the final touches together to open up interesting new use-cases for deploying ServiceStack solutions into a single self-contained, cross-platform, xcopy-able executable.</p><p>By leveraging ServiceStack&#39;s support for <a href="/self-hosting.html">self-hosting</a>, the <a href="/virtual-file-system.html">Virtual File System</a> support for Embedded Resources and the new support for <a href="#compiled-razor-views">Compiled Razor Views</a>, we can embed all images/js/css Razor views and Markdown Razor assets into a single dll that can be ILMerged with the preferred ServiceStack dependencies (inc. OrmLite.Sqlite) into a single cross-platform .NET exe:</p><h3 id="razor-rockstars-embedded-edition" tabindex="-1">Razor Rockstars - Embedded Edition <a class="header-anchor" href="#razor-rockstars-embedded-edition" aria-hidden="true">#</a></h3><p>To showcase its potential we&#39;ve compiled the entire <a href="http://razor.servicestack.net/" target="_blank" rel="noopener noreferrer">Razor Rockstars</a> website into a <a href="https://github.com/ServiceStack/RazorRockstars/tree/master/src/RazorRockstars.CompiledViews" target="_blank" rel="noopener noreferrer">single dll</a> that&#39;s referenced them in the multiple use-case scenarios below:</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>all demo apps are unsigned so will require ignoring security warnings to run.</p></div><h3 id="as-a-single-self-hosted-exe" tabindex="-1">As a Single Self-Hosted .exe <a class="header-anchor" href="#as-a-single-self-hosted-exe" aria-hidden="true">#</a></h3><p>The examples below merges Razor Rockstars and ServiceStack into a Single, cross-platform, self-hosting Console App, that opens up Razor Rockstars homepage in the users default web browser when launched:</p><blockquote><p><a href="https://github.com/ServiceStack/RazorRockstars/raw/master/build/RazorRockstars.exe" target="_blank" rel="noopener noreferrer">RazorRockstars.exe</a> - Self-Host running in a Console App</p></blockquote><blockquote><p><a href="https://github.com/ServiceStack/RazorRockstars/raw/master/build/WindowlessRockstars.exe" target="_blank" rel="noopener noreferrer">WindowlessRockstars.exe</a> - Headless Self-Hosted Console App running in the background</p></blockquote><p><a href="https://github.com/ServiceStack/RazorRockstars/raw/master/build/RazorRockstars.exe" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/self-host.png" alt="SelfHost"></a></p><blockquote><p>The total size for the entire uncompressed <strong>RazorRockstars.exe</strong> ServiceStack website comes down to just <strong>4.8MB</strong> (lighter than the 5MB footprint of EntityFramework.dll) that includes <strong>1.5MB</strong> for RazorRockstars html/img/js/css website assets and <strong>630kb</strong> for native Windows sqlite3.dll.</p></blockquote><h3 id="running-inside-windows-and-osx-native-desktop-apps" tabindex="-1">Running inside Windows and OSX Native Desktop Apps <a class="header-anchor" href="#running-inside-windows-and-osx-native-desktop-apps" aria-hidden="true">#</a></h3><p>You can also achieve a <a href="http://phonegap.com/" target="_blank" rel="noopener noreferrer">PhoneGap-like experience</a> by hosting ServiceStack inside native .NET Desktop App shells for OSX and Windows:</p><blockquote><p><a href="https://github.com/ServiceStack/RazorRockstars/raw/master/build/RazorRockstars.MacHost.app.zip" target="_blank" rel="noopener noreferrer">RazorRockstars.MacHost.app</a> - Running inside a Desktop Cocoa OSX app using <a href="https://xamarin.com/mac" target="_blank" rel="noopener noreferrer">Xamarin.Mac</a></p></blockquote><p><a href="https://github.com/ServiceStack/RazorRockstars/raw/master/build/RazorRockstars.MacHost.app.zip" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/osx-host.png" alt="OSX Cocoa App"></a></p><blockquote><p><a href="https://github.com/ServiceStack/RazorRockstars/raw/master/build/WpfHost.zip" target="_blank" rel="noopener noreferrer">WpfHost.zip</a> - Running inside a WPF Desktop app</p></blockquote><p><a href="https://github.com/ServiceStack/RazorRockstars/raw/master/build/WpfHost.zip" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/wpf-host.png" alt="WPF App"></a></p><p>Surprisingly .NET Desktop apps built with <a href="https://xamarin.com/mac" target="_blank" rel="noopener noreferrer">Xamarin.Mac on OSX</a> using Cocoa&#39;s WebKit-based WebView widget provides a superior experience over WPF&#39;s built-in WebBrowser widget which renders in an old behind-the-times version of IE. To improve the experience on Windows we&#39;re exploring better experiences on Windows by researching options around the <a href="https://code.google.com/p/chromiumembedded/" target="_blank" rel="noopener noreferrer">Chromium Embedded Framework</a> and the existing managed .NET wrappers: <a href="http://xilium.bitbucket.org/cefglue/" target="_blank" rel="noopener noreferrer">CefGlue</a> and <a href="https://github.com/cefsharp/CefSharp" target="_blank" rel="noopener noreferrer">CefSharp</a>.</p><p><strong>Xamarin.Mac</strong> can deliver an even better end-user experience by bundling the Mono runtime with the app avoiding the need for users to have Mono runtime installed. Incidentally this is the same approach used to deploy .NET OSX apps to the <a href="http://www.apple.com/osx/apps/app-store.html" target="_blank" rel="noopener noreferrer">Mac AppStore</a>.</p><h3 id="standard-web-hosts" tabindex="-1">Standard Web Hosts <a class="header-anchor" href="#standard-web-hosts" aria-hidden="true">#</a></h3><p>As the only differences when using the embedded .dll is that it embeds all img/js/css/etc assets as embedded resources and makes use of compiled razor views, it can also be used in standard web hosts configurations which are effectively just lightweight wrappers containing the App configuration and references to external dependencies:</p><ul><li><a href="https://github.com/ServiceStack/RazorRockstars/tree/master/src/RazorRockstars.CompiledViews.SelfHost" target="_blank" rel="noopener noreferrer">CompiledViews in SelfHost</a></li><li><a href="https://github.com/ServiceStack/RazorRockstars/tree/master/src/RazorRockstars.CompiledViews.WebHost" target="_blank" rel="noopener noreferrer">CompiledViews in ASP.NET Web Host</a></li></ul><p>Benefits of Web Hosts referencing embedded dlls include easier updates by being able to update a websites core functionality by copying over a single <strong>.dll</strong> as well as improved performance for Razor views by eliminating Razor compile times.</p><h3 id="ilmerging" tabindex="-1">ILMerging <a class="header-anchor" href="#ilmerging" aria-hidden="true">#</a></h3><p>Creating the single <strong>RazorRockstars.exe</strong> is simply a matter of <a href="https://github.com/ServiceStack/RazorRockstars/blob/master/build/ilmerge.bat" target="_blank" rel="noopener noreferrer">ILMerging all the self-host project dlls</a> into a single executable.</p><p>There are only a couple of issues that need to be addressed when running in a single ILMerged .exe:</p><p>Assembly names are merged together so all registration of assemblies in <code>Config.EmbeddedResourceSources</code> end up referencing the same assembly which results in only serving embedded resources in the host assembly namespace. To workaround this behavior we&#39;ve added a more specific way to reference assemblies in <code>Config.EmbeddedResourceBaseTypes</code>, e.g:</p><div class="language-csharp"><pre><code><span class="token function">SetConfig</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">HostConfig</span> <span class="token punctuation">{</span>
   DebugMode <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   EmbeddedResourceBaseTypes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">BaseTypeMarker</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Where <code>BaseTypeMarker</code> is just a dummy class that sits on the base namespace of the class library that&#39;s used to preserve the Assembly namespace.</p><p>The other limitation is not being able to merge unmanaged .dll&#39;s, which is what&#39;s needed for RazorRockstars as it makes use of the native <code>sqlite3.dll</code>. An easy workaround for this is to make <code>sqlite3.dll</code> an embedded resource then simply write it out to the current directory where OrmLite.Sqlite can find it when it first makes an sqlite connection, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ExportWindowsSqliteDll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>Env<span class="token punctuation">.</span>IsMono<span class="token punctuation">)</span>
       <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">//Uses system sqlite3.so or sqlite3.dylib on Linux/OSX</span>

   <span class="token class-name"><span class="token keyword">var</span></span> resPath <span class="token operator">=</span> <span class="token string">&quot;{0}.sqlite3.dll&quot;</span><span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">AppHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Namespace<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name"><span class="token keyword">var</span></span> resInfo <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">AppHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span><span class="token function">GetManifestResourceInfo</span><span class="token punctuation">(</span>resPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>resInfo <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
       <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">&quot;Couldn&#39;t load sqlite3.dll&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name"><span class="token keyword">var</span></span> dllBytes <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">AppHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span><span class="token function">GetManifestResourceStream</span><span class="token punctuation">(</span>resPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ReadFully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name"><span class="token keyword">var</span></span> dirPath <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">GetDirectoryName</span><span class="token punctuation">(</span>Assembly<span class="token punctuation">.</span><span class="token function">GetExecutingAssembly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Location<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name"><span class="token keyword">var</span></span> filePath <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>dirPath<span class="token punctuation">,</span> <span class="token string">&quot;sqlite3.dll&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   File<span class="token punctuation">.</span><span class="token function">WriteAllBytes</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> dllBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This isn&#39;t required for Mono as it&#39;s able to make use of the preinstalled version of sqlite on OSX and Linux platforms.</p><h3 id="compiled-razor-views" tabindex="-1">Compiled Razor Views <a class="header-anchor" href="#compiled-razor-views" aria-hidden="true">#</a></h3><p>Support for Compiled Razor Views has landed in ServiceStack thanks to the efforts of <a href="https://github.com/Tyst" target="_blank" rel="noopener noreferrer">Carl Healy</a>.</p><p>The primary benefits of compiled views is improved performance by eliminating compile times of Razor views. They also provide static compilation benefits by highlighting compile errors during development and also save you from deploying multiple <code>*.cshtml</code> files with your app since they all end up pre-compiled in your Assembly.</p><p>Enabling compiled views is fairly transparent where you only need to install the new <a href="https://www.nuget.org/packages/ServiceStack.Razor.BuildTask/" target="_blank" rel="noopener noreferrer">Razor.BuildTask NuGet Package</a> to the project containing your <code>.cshtml</code> Razor Views you want to compile:</p>`,37),r=s("div",{class:"package-reference-box"},[s("div",{class:"flex"},[s("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[s("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[s("p",null,[s("code",null,'<PackageReference Include="ServiceStack.Razor.BuildTask" Version="5.*" />')]),o(`
`)])]),s("div",{class:"flex-shrink"},[s("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),s("b")])]),s("div",{class:"copy-text w-full text-right h-6"})],-1),l=n(`<p>This doesn&#39;t add any additional dlls to your project, instead it just sets the <strong>BuildAction</strong> to all <code>*.cshtml</code> pages to <code>Content</code> and adds an MSBuild task to your project file to pre-compile razor views on every build.</p><p>Then to register assemblies containing compiled razor views with Razor Format you just need to add it to <code>RazorFormat.LoadFromAssemblies</code>, e.g:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RazorFormat</span> <span class="token punctuation">{</span>
    LoadFromAssemblies <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">RockstarsService</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The Compiled Views support continues to keep a great development experience in <a href="/debugging.html#debugmode">DebugMode</a> where all Razor Views are initially loaded from the Assembly but then continues to monitor the file system for modified views, automatically compiling and loading them on the fly.</p><h2 id="postman-support" tabindex="-1"><a href="http://www.getpostman.com/" target="_blank" rel="noopener noreferrer">Postman Support</a> <a class="header-anchor" href="#postman-support" aria-hidden="true">#</a></h2><p>We&#39;ve added great support for the very popular <a href="http://www.getpostman.com/" target="_blank" rel="noopener noreferrer">Postman Rest Client</a> in this release which is easily enabled by just registering the plugins below:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">PostmanFeature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">CorsFeature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>As it makes cross-site requests, Postman also requires CORS support.</p></blockquote><p>Once enabled, a link with appear in your metadata page:</p><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/postman-metadata.png" alt="Postman Metadata link"></p><p>Which by default is a link to <code>/postman</code> route that returns a JSON postman collection that can be imported into postman by clicking on <strong>import collections</strong> icon at the top:</p><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/postman.png" alt="Postman Screenshot"></p><p>Once imported it will populate a list of available routes which you can select and easily call from the Postman UI. Just like the <a href="/swagger-api.html">Swagger Support</a> the list of operations returned respects the <a href="/auth-restricting-services.html">Restriction Attributes</a> and only shows the operations each user is allowed to see.</p><p>The above screenshot shows how to call the <code>SearchRockstars</code> Route <code>/rockstars/{Id}</code> which returns the rockstar with the matching id.</p><p>The screenshot above also illustrates some of the customization that&#39;s available with the <a href="https://github.com/ServiceStack/EmailContacts/" target="_blank" rel="noopener noreferrer">Email Contacts</a> metadata imported with the default settings and the Razor Rockstars metadata imported with a customized label:</p><pre><code>/postman?label=type,+,route
</code></pre><p>The <code>label</code> param accepts a collection of string tokens that controls how the label is formatted.The <code>type</code> and <code>route</code> are special tokens that get replaced by the <strong>Request DTO name</strong> and <strong>Route</strong> respectively. Everything else are just added string literals including the <code>+</code> character which is just a url-encoded version of <code></code> space character.</p><p>Here are some examples using the example definition below:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;/contacts/{Id}&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetContact</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><table class="table"><tr><td><b>/postman?label=type</b></td><td>GetContact</td></tr><tr><td><b>/postman?label=route</b></td><td>/contacts/{Id}</td></tr><tr><td><b>/postman?label=type:english</b></td><td>Get contact</td></tr><tr><td><b>/postman?label=type:english,+(,route,)</b></td><td>Get contact (/contacts/{Id})</td></tr></table><p>The default label format can also be configured when registering the Postman plugin, e.g:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">PostmanFeature</span> <span class="token punctuation">{</span> 
    DefaultLabelFmt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token string">&quot;type:english&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;route&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="support-for-authenticated-requests" tabindex="-1">Support for authenticated requests <a class="header-anchor" href="#support-for-authenticated-requests" aria-hidden="true">#</a></h3><p>We&#39;ve also made it easy to call authentication-only services with the <code>/postman?exportSession=true</code> parameter which will redirect to a url that captures your session cookies into a deep-linkable url like <code>/postman?ssopt=temp&amp;ssid={key}&amp;sspid={key}</code> that can be copied into Postman.</p><p>This lets you replace your session cookies with the session ids on the url, effectively allowing you to take over someone elses session, in this case telling Postman to make requests on your behalf using your authenticated session cookies.</p><p>As this functionality is potentially dangerous it&#39;s only enabled by default in <strong>DebugMode</strong> but can be overridden with:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">PostmanFeature</span> <span class="token punctuation">{</span> 
    EnableSessionExport <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="other-customizations" tabindex="-1">Other Customizations <a class="header-anchor" href="#other-customizations" aria-hidden="true">#</a></h3><p>Other options include hosting postman on an alternate path, adding custom HTTP Headers for each Postman request and providing friendly aliases for Request DTO Property Types that you want to appear to external users, in this case we can show <code>DateTime</code> types as <code>Date</code> in Postmans UI:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">PostmanFeature</span> <span class="token punctuation">{</span> 
    AtRestPath <span class="token operator">=</span> <span class="token string">&quot;/alt-postman-link&quot;</span><span class="token punctuation">,</span>
    Headers <span class="token operator">=</span> <span class="token string">&quot;X-Custom-Header: Value\\nXCustom2: Value2&quot;</span><span class="token punctuation">,</span>
    FriendlyTypeNames <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token string">&quot;DateTime&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Date&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="cascading-layout-templates" tabindex="-1"><a href="http://razor.servicestack.net/#no-ceremony" target="_blank" rel="noopener noreferrer">Cascading layout templates</a> <a class="header-anchor" href="#cascading-layout-templates" aria-hidden="true">#</a></h2><p>Support for <a href="http://razor.servicestack.net/#no-ceremony" target="_blank" rel="noopener noreferrer">Cascading layout templates</a> for Razor ViewPages inside <code>/Views</code> were added in this release by <a href="https://github.com/Its-Tyson" target="_blank" rel="noopener noreferrer">@Its-Tyson</a>.</p><p>This works the same intuitive way it does for external Razor Content pages where the <code>_Layout.cshtml</code> nearest to the selected View will be used by default, e.g:</p><pre><code>/Views/_Layout.cshtml
/Views/Public.cshtml
/Views/Admin/_Layout.cshtml
/Views/Admin/Dashboard.cshtml
</code></pre><p>Where <code>/Views/Admin/Dashboard.cshtml</code> by default uses the <code>/Views/Admin/_Layout.cshtml</code> template.</p><h2 id="async-apis-added-to-http-utils" tabindex="-1">Async APIs added to HTTP Utils <a class="header-anchor" href="#async-apis-added-to-http-utils" aria-hidden="true">#</a></h2><p>The following Async versions of <a href="/http-utils.html">HTTP Utils</a> have been added to ServiceStack.Text by <a href="https://github.com/KyleGobel" target="_blank" rel="noopener noreferrer">Kyle Gobel</a>:</p><div class="language-csharp"><pre><code><span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">GetStringFromUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">PostStringToUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">PostToUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">PostJsonToUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">PostXmlToUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">PutStringToUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">PutToUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">PutJsonToUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">PutXmlToUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">DeleteFromUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">OptionsFromUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">HeadFromUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">SendStringToUrlAsync</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="redis" tabindex="-1">Redis <a class="header-anchor" href="#redis" aria-hidden="true">#</a></h2><p>The latest <a href="http://download.redis.io/redis-stable/00-RELEASENOTES" target="_blank" rel="noopener noreferrer">stable release of redis-server</a> includes support for the new <a href="http://redis.io/commands/zrangebylex" target="_blank" rel="noopener noreferrer">ZRANGEBYLEX</a> sorted set operations allowing you to query a sorted set lexically. A good showcase for this is available on <a href="http://autocomplete.redis.io/" target="_blank" rel="noopener noreferrer">autocomplete.redis.io</a> that shows a demo querying all 8 millions of unique lines of the Linux kernel source code in a fraction of a second.</p><p>These new operations are available as a 1:1 mapping with redis-server on IRedisNativeClient:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IRedisNativeClient</span>
<span class="token punctuation">{</span>
    <span class="token range operator">..</span><span class="token punctuation">.</span>
    <span class="token return-type class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token function">ZRangeByLex</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> setId<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> min<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> max<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> skip <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> take <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token return-type class-name"><span class="token keyword">long</span></span> <span class="token function">ZLexCount</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> setId<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> min<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token return-type class-name"><span class="token keyword">long</span></span> <span class="token function">ZRemRangeByLex</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> setId<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> min<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>As well as under more user-friendly APIs under IRedisClient:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IRedisClient</span>
<span class="token punctuation">{</span>
    <span class="token range operator">..</span><span class="token punctuation">.</span>
    <span class="token return-type class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">SearchSortedSet</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> setId<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> start<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> end<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> skip<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">?</span></span> take<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token return-type class-name"><span class="token keyword">long</span></span> <span class="token function">SearchSortedSetCount</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> setId<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> start<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> end<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token return-type class-name"><span class="token keyword">long</span></span> <span class="token function">RemoveRangeFromSortedSetBySearch</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> setId<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> start<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> end<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Just like NuGet version matchers, Redis uses <code>[</code> char to express inclusiveness and <code>(</code> char for exclusiveness. Since the <code>IRedisClient</code> APIs defaults to inclusive searches, these two APIs are the same:</p><div class="language-csharp"><pre><code>Redis<span class="token punctuation">.</span><span class="token function">SearchSortedSetCount</span><span class="token punctuation">(</span><span class="token string">&quot;zset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span>
Redis<span class="token punctuation">.</span><span class="token function">SearchSortedSetCount</span><span class="token punctuation">(</span><span class="token string">&quot;zset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;[a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;[c&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>Alternatively you can specify one or both bounds to be exclusive by using the <code>(</code> prefix, e.g:</p><div class="language-csharp"><pre><code>Redis<span class="token punctuation">.</span><span class="token function">SearchSortedSetCount</span><span class="token punctuation">(</span><span class="token string">&quot;zset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(c&quot;</span><span class="token punctuation">)</span>
Redis<span class="token punctuation">.</span><span class="token function">SearchSortedSetCount</span><span class="token punctuation">(</span><span class="token string">&quot;zset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(c&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>More API examples are available in <a href="https://github.com/ServiceStack/ServiceStack.Redis/blob/master/tests/ServiceStack.Redis.Tests/LexTests.cs" target="_blank" rel="noopener noreferrer">LexTests.cs</a>.</p><h3 id="twemproxy-support" tabindex="-1">Twemproxy support <a class="header-anchor" href="#twemproxy-support" aria-hidden="true">#</a></h3><p>This release also includes better support for <a href="https://github.com/twitter/twemproxy" target="_blank" rel="noopener noreferrer">twemproxy</a>, working around missing server commands sent upon connection.</p><h2 id="ormlite" tabindex="-1">OrmLite <a class="header-anchor" href="#ormlite" aria-hidden="true">#</a></h2><p>New support for StringFilter allowing you apply custom filter on string values, e.g <a href="http://stackoverflow.com/a/23261868/85785" target="_blank" rel="noopener noreferrer">remove trailing whitespace</a>:</p><div class="language-csharp"><pre><code>OrmLiteConfig<span class="token punctuation">.</span>StringFilter <span class="token operator">=</span> s <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span><span class="token function">TrimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Poco</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Value with trailing   &quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Assert<span class="token punctuation">.</span><span class="token function">That</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Select</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Poco<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Is<span class="token punctuation">.</span><span class="token function">EqualTo</span><span class="token punctuation">(</span><span class="token string">&quot;Value with trailing&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Added implicit support for <a href="http://stackoverflow.com/a/23435975/85785" target="_blank" rel="noopener noreferrer">escaping wildcards in typed expressions</a> that make use of LIKE, namely <code>StartsWith</code>, <code>EndsWith</code> and <code>Contains</code>, e.g:</p><div class="language-csharp"><pre><code>db<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Poco</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;ab&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Poco</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;a%&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Poco</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;a%b&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Count</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Poco<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>q <span class="token operator">=&gt;</span> q<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">StartsWith</span><span class="token punctuation">(</span><span class="token string">&quot;a_&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span>
db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Count</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Poco<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>q <span class="token operator">=&gt;</span> q<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">StartsWith</span><span class="token punctuation">(</span><span class="token string">&quot;a%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2</span>
</code></pre></div><p>OrmLite also underwent some internal refactoring to remove duplicate code and re-use existing code-paths.</p><h3 id="other-features" tabindex="-1">Other Features <a class="header-anchor" href="#other-features" aria-hidden="true">#</a></h3><ul><li>Allow overriding of <code>HttpListenerBase.CreateRequest()</code> for controlling creation of Self-Hosting requests allowing you to force a <a href="http://stackoverflow.com/a/23381383/85785" target="_blank" rel="noopener noreferrer">Character encoding to override the built-in heuristics</a> for detecting non UTF-8 character encodings</li><li>Support for retrieving untyped <code>base.UserSession</code> when inheriting from an untyped MVC <code>ServiceStackController</code></li><li>Added <code>@Html.RenderErrorIfAny()</code> to render a pretty bootstrap-styled exception response in a razor view</li><li>The generated WSDL output now replaces all occurances of <code>http://schemas.servicestack.net/types</code> with <code>Config.WsdlServiceNamespace</code></li><li>Initialize the CompressedResult Status code with the current HTTP ResponseStatus code</li><li>Plugins implementing <code>IPreInitPlugin</code> are now configured immediately after <code>AppHost.Configure()</code></li><li>HttpListeners now unwrap async Aggregate exceptions containing only a Single Exception for better error reporting</li><li>HttpListeners now shares the same behavior as IIS for <a href="https://github.com/ServiceStack/ServiceStack/commit/a0a2857721656c7161fcd83eb07609ae4239ea2a" target="_blank" rel="noopener noreferrer">redirecting requests for directories without a trailing slash</a></li><li><a href="/debugging.html#request-info">Debug Request Info</a> now shows file listing of the configured VirtualPathProvider</li><li>Resource Virtual Directories are no longer case-sensitive</li><li>Added new <code>Config.ExcludeAutoRegisteringServiceTypes</code> option to exclude services from being implicitly auto registered from assembly scanning. All built-in services in ServiceStack.dll now excluded by default which removes unintentional registration of services from ILMerging.</li></ul><h1 id="new-http-benchmarks-example-project" tabindex="-1">New HTTP Benchmarks example project <a class="header-anchor" href="#new-http-benchmarks-example-project" aria-hidden="true">#</a></h1><p><a href="https://httpbenchmarks.servicestack.net/" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/benchmarks-admin-ui.png" alt="HTTP Benchmarks"></a></p><p>Following the release of the <a href="https://github.com/ServiceStack/EmailContacts/" target="_blank" rel="noopener noreferrer">Email Contacts</a> solution, a new documented ServiceStack example project allowing you to uploaded Apache HTTP Benchmarks to visualize and analyze their results has been released at: <a href="https://github.com/ServiceStack/HttpBenchmarks" target="_blank" rel="noopener noreferrer">github.com/ServiceStack/HttpBenchmarks</a> and is hosted at <a href="https://httpbenchmarks.servicestack.net/" target="_blank" rel="noopener noreferrer">httpbenchmarks.servicestack.net</a>.</p><h3 id="example-results" tabindex="-1">Example Results <a class="header-anchor" href="#example-results" aria-hidden="true">#</a></h3><ul><li><a href="https://httpbenchmarks.servicestack.net/databases-in-asp-net" target="_blank" rel="noopener noreferrer">Performance of different RDBMS in an ASP.NET Host</a></li><li><a href="https://httpbenchmarks.servicestack.net/servicestack-hosts" target="_blank" rel="noopener noreferrer">Performance of different ServiceStack Hosts</a></li></ul><p>The documentation includes a development guide that walks through the projects different features:</p><ul><li>Integration with <code>Glimpse</code> with support for <code>DotNetOpenAuth</code></li><li>Allow authentication with Twitter, Facebook, Google and LinkedIn OAuth providers</li><li>Enables registration of new user accounts</li><li>Use of <code>[FallbackRoute]</code> attribute to allow users to create top-level routes (e.g. <a href="http://twitter.com/name" target="_blank" rel="noopener noreferrer">twitter.com/name</a>)</li><li>Explains why you want to aim for minimal JS dependencies</li><li>Introduction of <strong>Really Simple MV Pattern</strong> using plain JavaScript</li><li>Integration with multi-file Uploader <code>FineUploader</code></li><li>Processes multiple file uploads including files in <strong>.zip</strong> packages using <code>DotNetZip</code></li><li>Integration with <code>Highcharts.js</code></li><li>Hosting differences of <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> with AWS</li><li>Deploying to AWS and creating customized deployment packages with MSDeploy</li><li>Configuring SSL</li><li>Forcing SSL Redirects</li></ul><p>The repository also includes benchmark scripts and host projects of <a href="https://github.com/ServiceStack/HttpBenchmarks/tree/master/servers" target="_blank" rel="noopener noreferrer">all ServiceStack HTTP Hosts</a>, which all support runtime configuration of different RDBMS&#39;s:</p>`,67),i=[c,r,l];function u(k,d,h,g,m,f){return t(),e("div",null,i)}var y=a(p,[["render",u]]);export{w as __pageData,y as default};
