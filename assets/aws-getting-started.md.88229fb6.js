import{_ as t,c as e,o,a as s,b as n,e as a}from"./app.14440598.js";const x='{"title":"Getting started with AWS + ServiceStack","description":"","frontmatter":{"title":"Getting started with AWS + ServiceStack"},"headers":[{"level":2,"title":"Amazon RDS","slug":"amazon-rds"},{"level":2,"title":"Amazon ElastiCache","slug":"amazon-elasticache"},{"level":2,"title":"Getting Started with AWS RDS PostgreSQL and OrmLite","slug":"getting-started-with-aws-rds-postgresql-and-ormlite"},{"level":2,"title":"Connecting with ServiceStack.OrmLite","slug":"connecting-with-servicestack-ormlite"},{"level":2,"title":"Getting Started with AWS RDS Aurora and OrmLite","slug":"getting-started-with-aws-rds-aurora-and-ormlite"},{"level":2,"title":"Creating an Aurora Instance","slug":"creating-an-aurora-instance"},{"level":2,"title":"Connecting with ServiceStack.OrmLite","slug":"connecting-with-servicestack-ormlite-1"},{"level":2,"title":"Getting Started with AWS RDS MySQL and OrmLite","slug":"getting-started-with-aws-rds-mysql-and-ormlite"},{"level":2,"title":"Creating a MySQL RDS Instance","slug":"creating-a-mysql-rds-instance"},{"level":2,"title":"Connecting with ServiceStack.OrmLite","slug":"connecting-with-servicestack-ormlite-2"},{"level":2,"title":"Getting Started with AWS RDS MariaDB and OrmLite","slug":"getting-started-with-aws-rds-mariadb-and-ormlite"},{"level":2,"title":"Creating a MariaDB RDS Instance","slug":"creating-a-mariadb-rds-instance"},{"level":2,"title":"Connecting with ServiceStack.OrmLite","slug":"connecting-with-servicestack-ormlite-3"},{"level":2,"title":"Getting Started with AWS RDS SQL Server and OrmLite","slug":"getting-started-with-aws-rds-sql-server-and-ormlite"},{"level":2,"title":"Creating a SQL Server RDS Instance","slug":"creating-a-sql-server-rds-instance"},{"level":2,"title":"Connecting with ServiceStack.OrmLite","slug":"connecting-with-servicestack-ormlite-4"},{"level":2,"title":"Getting started with AWS ElastiCache Redis and ServiceStack","slug":"getting-started-with-aws-elasticache-redis-and-servicestack"},{"level":2,"title":"Enable Caching with ServiceStack.Redis","slug":"enable-caching-with-servicestack-redis"},{"level":2,"title":"Getting started with AWS ElastiCache and ServiceStack","slug":"getting-started-with-aws-elasticache-and-servicestack"},{"level":3,"title":"Memcached","slug":"memcached"},{"level":2,"title":"Enable Caching in your ServiceStack application","slug":"enable-caching-in-your-servicestack-application"}],"relativePath":"aws-getting-started.md","lastUpdated":1634495307610}',p={},c=s(`<p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/5744efd80015870e6441cef6e8fd8bbc79044945/img/aws/servicestack-aws-banner.png" alt=""></p><p>The <a href="https://github.com/ServiceStackApps/AwsGettingStarted" target="_blank" rel="noopener noreferrer">ServiceStackApps/AwsGettingStarted</a> repository contains Visual Studio solutions for getting started with AWS and ServiceStack libraries, as well as step by step guides to get you started below.</p><h2 id="amazon-rds" tabindex="-1">Amazon RDS <a class="header-anchor" href="#amazon-rds" aria-hidden="true">#</a></h2><ul><li><a href="#getting-started-with-aws-rds-postgresql-and-ormlite">PostgreSQL</a></li><li><a href="#getting-started-with-aws-rds-aurora-and-ormlite">Aurora</a></li><li><a href="#getting-started-with-aws-rds-mysql-and-ormlite">MySQL</a></li><li><a href="#getting-started-with-aws-rds-mariadb-and-ormlite">MariaDB</a></li><li><a href="#getting-started-with-aws-rds-sql-server-and-ormlite">SQL Server</a></li></ul><h2 id="amazon-elasticache" tabindex="-1">Amazon ElastiCache <a class="header-anchor" href="#amazon-elasticache" aria-hidden="true">#</a></h2><ul><li><a href="#getting-started-with-aws-elasticache-redis-and-servicestack">Redis</a></li><li><a href="#getting-started-with-aws-elasticache-and-servicestack">Memcached</a></li></ul><h2 id="getting-started-with-aws-rds-postgresql-and-ormlite" tabindex="-1">Getting Started with AWS RDS PostgreSQL and OrmLite <a class="header-anchor" href="#getting-started-with-aws-rds-postgresql-and-ormlite" aria-hidden="true">#</a></h2><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/rds-postgres-powered-by-aws.png" alt=""></p><p>ServiceStack.OrmLite library has support for use with a <a href="http://www.postgresql.org/" target="_blank" rel="noopener noreferrer">PostgreSQL</a> database via the <a href="https://www.nuget.org/packages/ServiceStack.OrmLite.PostgreSQL/" target="_blank" rel="noopener noreferrer"><code>ServiceStack.OrmLite.PostgreSQL</code></a> NuGet package. This can be used in conjunction with Amazon&#39;s RDS service using PostgreSQL.</p><p>To get started, first you will need to create your PostgreSQL database via the AWS RDS service.</p><h1 id="creating-a-postgresql-rds-instance" tabindex="-1">Creating a PostgreSQL RDS Instance <a class="header-anchor" href="#creating-a-postgresql-rds-instance" aria-hidden="true">#</a></h1><ol><li>Login to the <a href="https://console.aws.amazon.com/console/home" target="_blank" rel="noopener noreferrer">AWS Web console</a>.</li><li>Select <a href="https://console.aws.amazon.com/rds/home" target="_blank" rel="noopener noreferrer">RDS</a> from the <strong>Services</strong> from the top menu. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/aws-rds-menu.png" alt=""></li><li>Select <strong>Instances</strong> from the <strong>RDS Dashboard</strong> and click <strong>Launch DB Instance</strong>. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/launch-db-dashboard.png" alt=""></li></ol><p>The above steps will start the RDS Wizard to launch a new DB instance. To setup a new PostgreSQL instance, follow the wizard selecting the appropriate options for your application. As an example, we can create a <code>Customers</code> database for a non-production environment.</p><ul><li><strong>Select Engine</strong> - Select PostgreSQL</li><li><strong>Production?</strong> - Select <code>No</code> for multi-instance/production setup</li><li><strong>Specify DB Details</strong><ul><li>Create a <code>db.t2.micro</code> instance with default settings</li><li>Specify <strong>Multi-AZ Deployment</strong> as <code>No</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/postgres-default-details.png" alt=""></p><ul><li><p>Specify <strong>DB Instance Identifier</strong>, eg <code>servicestack-example-customers</code>.</p></li><li><p>Specify <strong>Master Username</strong>, eg <code>postgres</code>.</p></li><li><p>Create and confirm master user password.</p></li><li><p><strong>Configure Advanced Settings</strong> - Leave the suggested settings and specify a database name, eg <code>customers</code>. This will be used in your connection string.</p></li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Problems can occur if your default VPC is not setup to DNS Resolution and/or DNS Hostname. Navigate to <strong>Services</strong>, <strong>VPC</strong> and enable these two options on your default VPC</p></div><p>Click <strong>Launch DB Instance</strong> at the <em>bottom right</em> to launch your new instance. If all is successful, you should see the following.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/create-db-success.png" alt=""></p><h2 id="connecting-with-servicestack-ormlite" tabindex="-1">Connecting with ServiceStack.OrmLite <a class="header-anchor" href="#connecting-with-servicestack-ormlite" aria-hidden="true">#</a></h2><p>Now that you&#39;re PostgreSQL instance is running, connecting with OrmLite will require the <code>ServiceStack.OrmLite.PostgreSQL</code> NuGet package as well as connection string to your new PostgreSQL instance.</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ConnectionString<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>User ID={User};Password={Password};Host={Host};Port={Port};<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>   
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>`,22),l=n("div",{class:"package-reference-box"},[n("div",{class:"flex"},[n("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[n("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[n("p",null,[n("code",null,'<PackageReference Include="ServiceStack.OrmLite.PostgreSQL" Version="5.*" />')]),a(`
`)])]),n("div",{class:"flex-shrink"},[n("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),n("b")])]),n("div",{class:"copy-text w-full text-right h-6"})],-1),i=s(`<p>Once this dependency is installed, the <code>OrmLiteConnectionFactory</code> can be used with the <code>PostgreSqlDialect.Provider</code> can be configured in the AppHost Configure method. For example.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppSelfHostBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;AWS PostgreSQL Customers&quot;</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">AppHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">Container</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OrmLiteConnectionFactory</span><span class="token punctuation">(</span>
            AppSettings<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token string">&quot;ConnectionString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> PostgreSqlDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Resolve</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CreateTableIfNotExists</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//Add seed data</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Using our connection from a ServiceStack Service, we can use the <code>Db</code> property to access our <code>Customer</code> table. Eg, Below is an example of a CRUD service using OrmLite.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerService</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomers</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetCustomersResponse</span> <span class="token punctuation">{</span> Results <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Select</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token class-name">CreateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name <span class="token punctuation">}</span><span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Put</span><span class="token punctuation">(</span><span class="token class-name">UpdateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>customer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> HttpError<span class="token punctuation">.</span><span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token string">&quot;Customer &#39;{0}&#39; does not exist&quot;</span><span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        customer<span class="token punctuation">.</span>Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token class-name">DeleteCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DeleteById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>See the <a href="https://github.com/ServiceStack/ServiceStack.OrmLite#api-examples" target="_blank" rel="noopener noreferrer">OrmLite GitHub</a> page for more info on working with OrmLite API.</p><h2 id="getting-started-with-aws-rds-aurora-and-ormlite" tabindex="-1">Getting Started with AWS RDS Aurora and OrmLite <a class="header-anchor" href="#getting-started-with-aws-rds-aurora-and-ormlite" aria-hidden="true">#</a></h2><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/rds-aurora-powered-by-aws.png" alt=""></p><p>ServiceStack.OrmLite library has support for use with an <a href="https://aws.amazon.com/rds/aurora/" target="_blank" rel="noopener noreferrer">Aurora</a> database via the <a href="https://www.nuget.org/packages/ServiceStack.OrmLite.MySql/" target="_blank" rel="noopener noreferrer"><code>ServiceStack.OrmLite.MySql</code></a> NuGet package. This can be used in conjunction with Amazon&#39;s RDS service using Aurora.</p><p>To get started, first you will need to create your Aurora database via the AWS RDS service.</p><h2 id="creating-an-aurora-instance" tabindex="-1">Creating an Aurora Instance <a class="header-anchor" href="#creating-an-aurora-instance" aria-hidden="true">#</a></h2><ol><li>Login to the <a href="https://console.aws.amazon.com/console/home" target="_blank" rel="noopener noreferrer">AWS Web console</a>.</li><li>Select <a href="https://console.aws.amazon.com/rds/home" target="_blank" rel="noopener noreferrer">RDS</a> from the <strong>Services</strong> from the top menu. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/aws-rds-menu.png" alt=""></li><li>Select <strong>Instances</strong> from the <strong>RDS Dashboard</strong> and click <strong>Launch DB Instance</strong>. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/launch-db-dashboard.png" alt=""></li></ol><p>The above steps will start the RDS Wizard to launch a new DB instance. To setup a new Aurora instance, follow the wizard selecting the appropriate options for your application. As an example, we can create a <code>Customers</code> database for a non-production environment.</p><ul><li><strong>Select Engine</strong> - Select Amazon Aurora</li><li><strong>Specify DB Details</strong><ul><li>Create a <code>db.r3.large</code> instance with default settings</li><li>Specify <strong>Multi-AZ Deployment</strong> as <code>No</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/aurora-default-details.png" alt=""></p><ul><li><p>Specify <strong>DB Instance Identifier</strong>, eg <code>servicestack-example-customers</code>.</p></li><li><p>Specify <strong>Master Username</strong>, eg <code>admin</code>.</p></li><li><p>Create and confirm master user password.</p></li><li><p><strong>Configure Advanced Settings</strong> - Leave the suggested settings and specify a <strong>Database Name</strong>, eg <code>customers</code>. This will be used in your connection string.</p></li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Problems can occur if your default VPC is not setup to DNS Resolution and/or DNS Hostname. Navigate to <strong>Services</strong>, <strong>VPC</strong> and enable these two options on your default VPC. Default settings are to create a new VPC security group that will allow remote access to your DB instance based on your IP address. If your IP address changes, you will lose remote access and this security group will need to be updated</p></div><p>Click <strong>Launch DB Instance</strong> at the <em>bottom right</em> to launch your new instance. If all is successful, you should see the following.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/create-db-success.png" alt=""></p><h2 id="connecting-with-servicestack-ormlite-1" tabindex="-1">Connecting with ServiceStack.OrmLite <a class="header-anchor" href="#connecting-with-servicestack-ormlite-1" aria-hidden="true">#</a></h2><p>Now that you&#39;re Aurora instance is running, connecting with OrmLite will require the <code>ServiceStack.OrmLite.MySql</code> NuGet package as well as connection string to your new Aurora instance.</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ConnectionString<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Uid={User};Password={Password};Server={EndpointUrl};Port={EndpointPort};Database=customers<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>   
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>`,21),u=n("div",{class:"package-reference-box"},[n("div",{class:"flex"},[n("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[n("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[n("p",null,[n("code",null,'<PackageReference Include="ServiceStack.OrmLite.MySql" Version="5.*" />')]),a(`
`)])]),n("div",{class:"flex-shrink"},[n("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),n("b")])]),n("div",{class:"copy-text w-full text-right h-6"})],-1),r=s(`<p>Once this dependency is installed, the <code>OrmLiteConnectionFactory</code> can be used with the <code>MySqlDialect.Provider</code> can be configured in the AppHost Configure method. For example.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppSelfHostBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;AWS Aurora Customers&quot;</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">AppHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">Container</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OrmLiteConnectionFactory</span><span class="token punctuation">(</span>
            AppSettings<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token string">&quot;ConnectionString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MySqlDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Resolve</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CreateTableIfNotExists</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//Add seed data</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Using our connection from a ServiceStack Service, we can use the <code>Db</code> property to access our <code>Customer</code> table. Eg, Below is an example of a CRUD service using OrmLite.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerService</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomers</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetCustomersResponse</span> <span class="token punctuation">{</span> Results <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Select</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token class-name">CreateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name <span class="token punctuation">}</span><span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Put</span><span class="token punctuation">(</span><span class="token class-name">UpdateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>customer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> HttpError<span class="token punctuation">.</span><span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token string">&quot;Customer &#39;{0}&#39; does not exist&quot;</span><span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        customer<span class="token punctuation">.</span>Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token class-name">DeleteCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DeleteById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>See the <a href="https://github.com/ServiceStack/ServiceStack.OrmLite#api-examples" target="_blank" rel="noopener noreferrer">OrmLite GitHub</a> page for more info on working with OrmLite API.</p><h2 id="getting-started-with-aws-rds-mysql-and-ormlite" tabindex="-1">Getting Started with AWS RDS MySQL and OrmLite <a class="header-anchor" href="#getting-started-with-aws-rds-mysql-and-ormlite" aria-hidden="true">#</a></h2><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/rds-mysql-powered-by-aws.png" alt=""></p><p>ServiceStack.OrmLite library has support for use with a <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL</a> database via the <a href="https://www.nuget.org/packages/ServiceStack.OrmLite.MySql/" target="_blank" rel="noopener noreferrer"><code>ServiceStack.OrmLite.MySql</code></a> NuGet package. This can be used in conjunction with Amazon&#39;s RDS service using MySQL.</p><p>To get started, first you will need to create your MySQL database via the AWS RDS service.</p><h2 id="creating-a-mysql-rds-instance" tabindex="-1">Creating a MySQL RDS Instance <a class="header-anchor" href="#creating-a-mysql-rds-instance" aria-hidden="true">#</a></h2><ol><li>Login to the <a href="https://console.aws.amazon.com/console/home" target="_blank" rel="noopener noreferrer">AWS Web console</a>.</li><li>Select <a href="https://console.aws.amazon.com/rds/home" target="_blank" rel="noopener noreferrer">RDS</a> from the <strong>Services</strong> from the top menu. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/aws-rds-menu.png" alt=""></li><li>Select <strong>Instances</strong> from the <strong>RDS Dashboard</strong> and click <strong>Launch DB Instance</strong>. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/launch-db-dashboard.png" alt=""></li></ol><p>The above steps will start the RDS Wizard to launch a new DB instance. To setup a new MySQL instance, follow the wizard selecting the appropriate options for your application. As an example, we can create a <code>Customers</code> database for a non-production environment.</p><ul><li><strong>Select Engine</strong> - Select MySQL</li><li><strong>Production?</strong> - Select <code>No</code> for multi-instance/production setup</li><li><strong>Specify DB Details</strong><ul><li>Create a <code>db.t2.micro</code> instance with default settings</li><li>Specify <strong>Multi-AZ Deployment</strong> as <code>No</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/mysql-default-details.png" alt=""></p><ul><li><p>Specify <strong>DB Instance Identifier</strong>, eg <code>servicestack-example-customers</code>.</p></li><li><p>Specify <strong>Master Username</strong>, eg <code>admin</code>.</p></li><li><p>Create and confirm master user password.</p></li><li><p><strong>Configure Advanced Settings</strong> - Leave the suggested settings and specify a database name, eg <code>customers</code>. This will be used in your connection string.</p></li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Problems can occur if your default VPC is not setup to DNS Resolution and/or DNS Hostname. Navigate to <strong>Services</strong>, <strong>VPC</strong> and enable these two options on your default VPC</p></div><p>Click <strong>Launch DB Instance</strong> at the <em>bottom right</em> to launch your new instance. If all is successful, you should see the following.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/create-db-success.png" alt=""></p><h2 id="connecting-with-servicestack-ormlite-2" tabindex="-1">Connecting with ServiceStack.OrmLite <a class="header-anchor" href="#connecting-with-servicestack-ormlite-2" aria-hidden="true">#</a></h2><p>Now that you&#39;re MySQL instance is running, connecting with OrmLite will require the <code>ServiceStack.OrmLite.MySql</code> NuGet package as well as connection string to your new MySQL instance.</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ConnectionString<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Uid={User};Password={Password};Server={EndpointUrl};Port={EndpointPort};Database=customers<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>   
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>`,21),k=n("div",{class:"package-reference-box"},[n("div",{class:"flex"},[n("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[n("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[n("p",null,[n("code",null,'<PackageReference Include="ServiceStack.OrmLite.MySql" Version="5.*" />')]),a(`
`)])]),n("div",{class:"flex-shrink"},[n("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),n("b")])]),n("div",{class:"copy-text w-full text-right h-6"})],-1),d=s(`<p>Once this dependency is installed, the <code>OrmLiteConnectionFactory</code> can be used with the <code>MySqlDialect.Provider</code> can be configured in the AppHost Configure method. For example.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppSelfHostBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;AWS MySql Customers&quot;</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">AppHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">Container</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OrmLiteConnectionFactory</span><span class="token punctuation">(</span>
            AppSettings<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token string">&quot;ConnectionString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MySqlDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Resolve</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CreateTableIfNotExists</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//Add seed data</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Using our connection from a ServiceStack Service, we can use the <code>Db</code> property to access our <code>Customer</code> table. Eg, Below is an example of a CRUD service using OrmLite.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerService</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomers</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetCustomersResponse</span> <span class="token punctuation">{</span> Results <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Select</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token class-name">CreateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name <span class="token punctuation">}</span><span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Put</span><span class="token punctuation">(</span><span class="token class-name">UpdateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>customer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> HttpError<span class="token punctuation">.</span><span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token string">&quot;Customer &#39;{0}&#39; does not exist&quot;</span><span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        customer<span class="token punctuation">.</span>Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token class-name">DeleteCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DeleteById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>See the <a href="https://github.com/ServiceStack/ServiceStack.OrmLite#api-examples" target="_blank" rel="noopener noreferrer">OrmLite GitHub</a> page for more info on working with OrmLite API.</p><h2 id="getting-started-with-aws-rds-mariadb-and-ormlite" tabindex="-1">Getting Started with AWS RDS MariaDB and OrmLite <a class="header-anchor" href="#getting-started-with-aws-rds-mariadb-and-ormlite" aria-hidden="true">#</a></h2><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/rds-mariadb-powered-by-aws.png" alt=""></p><p>ServiceStack.OrmLite library has support for use with a <a href="https://mariadb.org/" target="_blank" rel="noopener noreferrer">MariaDB</a> database via the <a href="https://www.nuget.org/packages/ServiceStack.OrmLite.MySql/" target="_blank" rel="noopener noreferrer"><code>ServiceStack.OrmLite.MySql</code></a> NuGet package. This can be used in conjunction with Amazon&#39;s RDS service using MariaDB.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>MariaDB is a &quot;binary drop in replacement for MySQL&quot; which is why the <code>ServiceStack.OrmLite.MySql</code> NuGet package can be used. For more information, see the <a href="https://mariadb.com/kb/en/mariadb/mariadb-vs-mysql-compatibility/" target="_blank" rel="noopener noreferrer">MariaDB documentation</a></p></div><p>To get started, first you will need to create your MariaDB database via the AWS RDS service.</p><h2 id="creating-a-mariadb-rds-instance" tabindex="-1">Creating a MariaDB RDS Instance <a class="header-anchor" href="#creating-a-mariadb-rds-instance" aria-hidden="true">#</a></h2><ol><li>Login to the <a href="https://console.aws.amazon.com/console/home" target="_blank" rel="noopener noreferrer">AWS Web console</a>.</li><li>Select <a href="https://console.aws.amazon.com/rds/home" target="_blank" rel="noopener noreferrer">RDS</a> from the <strong>Services</strong> from the top menu. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/aws-rds-menu.png" alt=""></li><li>Select <strong>Instances</strong> from the <strong>RDS Dashboard</strong> and click <strong>Launch DB Instance</strong>. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/launch-db-dashboard.png" alt=""></li></ol><p>The above steps will start the RDS Wizard to launch a new DB instance. To setup a new MariaDB instance, follow the wizard selecting the appropriate options for your application. As an example, we can create a <code>Customers</code> database for a non-production environment.</p><ul><li><strong>Select Engine</strong> - Select MariaDB</li><li><strong>Production?</strong> - Select <code>No</code> for multi-instance/production setup</li><li><strong>Specify DB Details</strong><ul><li>Create a <code>db.t2.micro</code> instance with default settings</li><li>Specify <strong>Multi-AZ Deployment</strong> as <code>No</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/mariadb-default-details.png" alt=""></p><ul><li><p>Specify <strong>DB Instance Identifier</strong>, eg <code>servicestack-example-customers</code>.</p></li><li><p>Specify <strong>Master Username</strong>, eg <code>admin</code>.</p></li><li><p>Create and confirm master user password.</p></li><li><p><strong>Configure Advanced Settings</strong> - Leave the suggested settings and specify a database name, eg <code>customers</code>. This will be used in your connection string.</p></li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Problems can occur if your default VPC is not setup to DNS Resolution and/or DNS Hostname. Navigate to <strong>Services</strong>, <strong>VPC</strong> and enable these two options on your default VPC</p></div><p>Click <strong>Launch DB Instance</strong> at the <em>bottom right</em> to launch your new instance. If all is successful, you should see the following.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/create-db-success.png" alt=""></p><h2 id="connecting-with-servicestack-ormlite-3" tabindex="-1">Connecting with ServiceStack.OrmLite <a class="header-anchor" href="#connecting-with-servicestack-ormlite-3" aria-hidden="true">#</a></h2><p>Now that you&#39;re MariaDB instance is running, connecting with OrmLite will require the <code>ServiceStack.OrmLite.MySql</code> NuGet package as well as connection string to your new MariaDB instance.</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ConnectionString<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Uid={User};Password={Password};Server={EndpointUrl};Port={EndpointPort};Database=customers<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>   
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>`,22),g=n("div",{class:"package-reference-box"},[n("div",{class:"flex"},[n("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[n("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[n("p",null,[n("code",null,'<PackageReference Include="ServiceStack.OrmLite.MySql" Version="5.*" />')]),a(`
`)])]),n("div",{class:"flex-shrink"},[n("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),n("b")])]),n("div",{class:"copy-text w-full text-right h-6"})],-1),m=s(`<p>Once this dependency is installed, the <code>OrmLiteConnectionFactory</code> can be used with the <code>MySqlDialect.Provider</code> can be configured in the AppHost Configure method. For example.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppSelfHostBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;AWS MariaDB Customers&quot;</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">AppHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">Container</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OrmLiteConnectionFactory</span><span class="token punctuation">(</span>
            AppSettings<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token string">&quot;ConnectionString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MySqlDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Resolve</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CreateTableIfNotExists</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//Add seed data</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Using our connection from a ServiceStack Service, we can use the <code>Db</code> property to access our <code>Customer</code> table. Eg, Below is an example of a CRUD service using OrmLite.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerService</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomers</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetCustomersResponse</span> <span class="token punctuation">{</span> Results <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Select</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token class-name">CreateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name <span class="token punctuation">}</span><span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Put</span><span class="token punctuation">(</span><span class="token class-name">UpdateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>customer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> HttpError<span class="token punctuation">.</span><span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token string">&quot;Customer &#39;{0}&#39; does not exist&quot;</span><span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        customer<span class="token punctuation">.</span>Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token class-name">DeleteCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DeleteById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>See the <a href="https://github.com/ServiceStack/ServiceStack.OrmLite#api-examples" target="_blank" rel="noopener noreferrer">OrmLite GitHub</a> page for more info on working with OrmLite API.</p><h2 id="getting-started-with-aws-rds-sql-server-and-ormlite" tabindex="-1">Getting Started with AWS RDS SQL Server and OrmLite <a class="header-anchor" href="#getting-started-with-aws-rds-sql-server-and-ormlite" aria-hidden="true">#</a></h2><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/rds-sqlserver-powered-by-aws.png" alt=""></p><p>ServiceStack.OrmLite library has support for use with a <a href="http://www.microsoft.com/en-au/server-cloud/products/sql-server/" target="_blank" rel="noopener noreferrer">Microsoft SQL Server</a> database via the <a href="https://www.nuget.org/packages/ServiceStack.OrmLite.SqlServer/" target="_blank" rel="noopener noreferrer"><code>ServiceStack.OrmLite.SqlServer</code></a> NuGet package. This can be used in conjunction with Amazon&#39;s RDS service using SQL Server.</p><p>To get started, first you will need to create your SQL Server database via the AWS RDS service.</p><h2 id="creating-a-sql-server-rds-instance" tabindex="-1">Creating a SQL Server RDS Instance <a class="header-anchor" href="#creating-a-sql-server-rds-instance" aria-hidden="true">#</a></h2><ol><li>Login to the <a href="https://console.aws.amazon.com/console/home" target="_blank" rel="noopener noreferrer">AWS Web console</a>.</li><li>Select <a href="https://console.aws.amazon.com/rds/home" target="_blank" rel="noopener noreferrer">RDS</a> from the <strong>Services</strong> from the top menu. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/aws-rds-menu.png" alt=""></li><li>Select <strong>Instances</strong> from the <strong>RDS Dashboard</strong> and click <strong>Launch DB Instance</strong>. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/launch-db-dashboard.png" alt=""></li></ol><p>The above steps will start the RDS Wizard to launch a new DB instance. To setup a new SQL Server instance, follow the wizard selecting the appropriate options for your application. As an example, we can create a <code>Customers</code> database for a non-production environment.</p><ul><li><strong>Select Engine</strong><ul><li>Select <strong>SQL Server</strong></li><li>Select appropriate SQL Server version, for this example, <strong>SQL Server SE</strong></li></ul></li><li><strong>Specify DB Details</strong><ul><li>Select <strong>License Model</strong> <code>license-included</code></li><li>Create a <code>db.m1.small</code> instance with default settings by changing the <strong>DB Instance Class</strong>.</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/mssql-default-details.png" alt=""></p><ul><li><p>Specify <strong>DB Instance Identifier</strong>, eg <code>customers</code>.</p></li><li><p>Specify <strong>Master Username</strong>, eg <code>admin</code>.</p></li><li><p>Create and confirm master user password.</p></li><li><p><strong>Configure Advanced Settings</strong> - Leave the suggested settings which will create your RDS instance with network rule that restricts public access via your current public IP address.</p></li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Problems can occur if your default VPC is not setup to DNS Resolution and/or DNS Hostname. Navigate to <strong>Services</strong>, <strong>VPC</strong> and enable these two options on your default VPC</p></div><p>Click <strong>Launch DB Instance</strong> at the <em>bottom right</em> to launch your new instance. If all is successful, you should see the following.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/create-db-success.png" alt=""></p><h2 id="connecting-with-servicestack-ormlite-4" tabindex="-1">Connecting with ServiceStack.OrmLite <a class="header-anchor" href="#connecting-with-servicestack-ormlite-4" aria-hidden="true">#</a></h2><p>Now that you&#39;re SQL Server instance is running, connecting with OrmLite will require the <code>ServiceStack.OrmLite.SqlServer</code> NuGet package as well as connection string to your new SQL Server instance.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you are connecting to a new instance without a database, you&#39;ll need to create a new Database via SQL Management Studio first. For this example the <code>customers</code> database was created</p></div><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ConnectionString<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Data Source={Endpoint},{Port};Initial Catalog=customers;User ID={User};Password={Password}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>   
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>`,22),h=n("div",{class:"package-reference-box"},[n("div",{class:"flex"},[n("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[n("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[n("p",null,[n("code",null,'<PackageReference Include="ServiceStack.SqlServer" Version="5.*" />')]),a(`
`)])]),n("div",{class:"flex-shrink"},[n("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),n("b")])]),n("div",{class:"copy-text w-full text-right h-6"})],-1),w=s(`<p>Once this dependency is installed, the <code>OrmLiteConnectionFactory</code> can be used with the <code>SqlServerDialect.Provider</code> can be configured in the AppHost Configure method. For example.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppSelfHostBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;AWS SQL Server Customers&quot;</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">AppHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">Container</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OrmLiteConnectionFactory</span><span class="token punctuation">(</span>
            AppSettings<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token string">&quot;ConnectionString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SqlServerDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> db <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Resolve</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CreateTableIfNotExists</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//Add seed data</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Using our connection from a ServiceStack Service, we can use the <code>Db</code> property to access our <code>Customer</code> table. Eg, Below is an example of a CRUD service using OrmLite.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerService</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomers</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetCustomersResponse</span> <span class="token punctuation">{</span> Results <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Select</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Post</span><span class="token punctuation">(</span><span class="token class-name">CreateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Customer</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name <span class="token punctuation">}</span><span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Put</span><span class="token punctuation">(</span><span class="token class-name">UpdateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>customer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> HttpError<span class="token punctuation">.</span><span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token string">&quot;Customer &#39;{0}&#39; does not exist&quot;</span><span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        customer<span class="token punctuation">.</span>Name <span class="token operator">=</span> request<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
        Db<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> customer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token class-name">DeleteCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DeleteById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>See the <a href="https://github.com/ServiceStack/ServiceStack.OrmLite#api-examples" target="_blank" rel="noopener noreferrer">OrmLite GitHub</a> page for more info on working with OrmLite API.</p><h2 id="getting-started-with-aws-elasticache-redis-and-servicestack" tabindex="-1">Getting started with AWS ElastiCache Redis and ServiceStack <a class="header-anchor" href="#getting-started-with-aws-elasticache-redis-and-servicestack" aria-hidden="true">#</a></h2><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/elasticache-redis-powered-by-aws.png" alt=""></p><p>Amazon&#39;s &#39;ElastiCache&#39; allows a simple way to create and manage cache instances that can be simply incorporated into your ServiceStack application stack using the ServiceStack Redis client, <code>ServiceStack.Redis</code>.</p><h4 id="creating-an-elasticache-cluster" tabindex="-1">Creating an ElastiCache Cluster <a class="header-anchor" href="#creating-an-elasticache-cluster" aria-hidden="true">#</a></h4><ol><li>Login to the <a href="https://console.aws.amazon.com/console/home" target="_blank" rel="noopener noreferrer">AWS Web console</a>.</li><li>Select <a href="https://console.aws.amazon.com/elasticache/home" target="_blank" rel="noopener noreferrer">ElastiCache</a> from the <strong>Services</strong> from the top menu. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/aws-services-menu-elasticcache.png" alt=""></li><li>Select <strong>Get Started Now</strong> or <strong>ElasticCache Dashboard</strong> and <strong>Launch Cache Cluster</strong></li><li>Select <strong>Redis</strong> for the cluster engine.</li></ol><p>You can run your cache as a single Redis node or add multiple nodes for additional redundency. In this example, we will be using 3 nodes. One as a primary (or master) node and 2 read only replicas (or slaves).</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/elasticcache-redis-config.png" alt=""></p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>To use the smaller instances like the <code>cache.t2.micro</code>, <strong>Multi-AZ</strong> must be disabled</p></div><p>So you&#39;re EC2 instance can access your Redis nodes, ensure you select a <strong>VPC Security Group</strong> that exposes the default port <code>6379</code>.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/elasticcache-redis-adv.png" alt=""></p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you haven&#39;t already setup a security group exposing this port, you&#39;ll need to create one by <a href="https://console.aws.amazon.com/vpc/home#securityGroups:" target="_blank" rel="noopener noreferrer">managing your VPC security groups</a></p></div><p>To finish, reviewed your settings and click <strong>Launch Replication Group</strong>.</p><h2 id="enable-caching-with-servicestack-redis" tabindex="-1">Enable Caching with ServiceStack.Redis <a class="header-anchor" href="#enable-caching-with-servicestack-redis" aria-hidden="true">#</a></h2><p>Now you&#39;re your Redis nodes are ready, your AppHost can be configured to use them when deployed. AWS <strong>does not allow external access</strong> to ElastiCache servers, so they can only be used when your ServiceStack application is deployed.</p><p>First, you&#39;ll need to install <code>ServiceStack.Redis</code> NuGet package if your application doesn&#39;t already use it.</p>`,20),y=n("div",{class:"package-reference-box"},[n("div",{class:"flex"},[n("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[n("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[n("p",null,[n("code",null,'<PackageReference Include="ServiceStack.Redis" Version="5.*" />')]),a(`
`)])]),n("div",{class:"flex-shrink"},[n("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),n("b")])]),n("div",{class:"copy-text w-full text-right h-6"})],-1),S=s(`<p>In this example, we are going to use a <code>PooledRedisClientManager</code> for our <code>IRedisClientsManager</code>. This will be responsible for creating <code>ICacheClient</code>s that our <code>Service</code>s will use to connect to the ElastiCache nodes. We will need to provide our <code>PooledRedisClientManager</code> with the nodes we have create. For example, as shown above, we created a cluster of <strong>1 Primary</strong> (master) and <strong>2 Read Replicas</strong> (slaves), these endpoint URLs can be accessed from the ElastiCache <strong>Dashboard</strong>.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/elasticcache-redis-nodes.png" alt=""></p><p>Below is a simple example of a configured self hosting AppHost that uses ElastiCache for caching when deployed and an in memory caching when developing locally.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppSelfHostBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;AWS Redis ElastiCache Example&quot;</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyServices</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">Container</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
		<span class="token comment">//Your DB initialization</span>
		<span class="token range operator">..</span><span class="token punctuation">.</span>

        <span class="token comment">// AWS ElastiCache servers are NOT accessible from outside AWS</span>
        <span class="token comment">// Use MemoryCacheClient locally</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>AppSettings<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token string">&quot;Environment&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;Production&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IRedisClientsManager<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span>
                <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PooledRedisClientManager</span><span class="token punctuation">(</span>
                    <span class="token comment">// Primary node from AWS (master)</span>
                    AwsElastiCacheConfig<span class="token punctuation">.</span>MasterNodes<span class="token punctuation">,</span>
                    <span class="token comment">// Read replica nodes from AWS (slaves)</span>
                    AwsElastiCacheConfig<span class="token punctuation">.</span>SlaveNodes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ICacheClient<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span>
                container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Resolve</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IRedisClientsManager<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCacheClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ICacheClient<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">MemoryCacheClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>With configuration provided in your application config.</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Environment<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Production<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>MasterNodes<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{YourAWSPrimaryNodeAddress}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SlaveNodes<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{Your1stAWSReadReplicaNodeAddress},{AWSReadReplicaNodeAddress}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Now that your caching is setup and connecting, you can cache your web servie responses easily by returning <code>Request.ToOptimizedResultUsingCache</code> from within a ServiceStack <code>Service</code>. For example, returning a full customers details might be an expensive database query. We can cache the result in the ElastiCache cluster for a faster response and invalidate the cache when the details are updated.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerService</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">string</span></span> CacheKey <span class="token operator">=</span> <span class="token string">&quot;customer_details_{0}&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">ToOptimizedResultUsingCache</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Cache<span class="token punctuation">,</span>
            CacheKey<span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Long request</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetCustomerResponse</span>
                <span class="token punctuation">{</span>
                    Result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">LoadSingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Put</span><span class="token punctuation">(</span><span class="token class-name">UpdateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">LoadSingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        customer <span class="token operator">=</span> customer<span class="token punctuation">.</span><span class="token function">PopulateWith</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">ConvertTo</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Db<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Invalidate customer details cache</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Cache<span class="token punctuation">.</span><span class="token function">ClearCaches</span><span class="token punctuation">(</span>CacheKey<span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">UpdateCustomerResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Result <span class="token operator">=</span> customer
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>As this example uses the <code>Cache</code> property from the <code>Service</code> in a distributed cache environment, <code>Cache.Get&lt;T&gt;</code> values are coming from the read replica (slave) instances which will take time to replicate from a previous <code>Cache.Set&lt;T&gt;</code> call. To gaurantee a value is immediately available, reusing the same instance can be done by handling the creating from the <code>IRedisClientsManager</code> from within your <code>Service</code> method</p></div><div class="language-csharp"><pre><code><span class="token keyword">using</span> <span class="token class-name"><span class="token keyword">var</span></span> cache <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>RedisClientManager<span class="token punctuation">.</span><span class="token function">GetClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Your Cache Client code</span>
</code></pre></div><h2 id="getting-started-with-aws-elasticache-and-servicestack" tabindex="-1">Getting started with AWS ElastiCache and ServiceStack <a class="header-anchor" href="#getting-started-with-aws-elasticache-and-servicestack" aria-hidden="true">#</a></h2><h3 id="memcached" tabindex="-1">Memcached <a class="header-anchor" href="#memcached" aria-hidden="true">#</a></h3><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/elasticache-memcached-powered-by-aws.png" alt=""></p><p>Amazon&#39;s &#39;ElastiCache&#39; allows a simple way to create and manage Memcached instances that can be simply incorporated into your ServiceStack application stack using the ServiceStack NuGet package, <code>ServiceStack.Caching.Memcached</code>.</p><h4 id="creating-an-elasticache-cluster-1" tabindex="-1">Creating an ElastiCache Cluster <a class="header-anchor" href="#creating-an-elasticache-cluster-1" aria-hidden="true">#</a></h4><ol><li>Login to the <a href="https://console.aws.amazon.com/console/home" target="_blank" rel="noopener noreferrer">AWS Web console</a>.</li><li>Select <a href="https://console.aws.amazon.com/elasticache/home" target="_blank" rel="noopener noreferrer">ElastiCache</a> from the <strong>Services</strong> from the top menu. <img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/aws/aws-services-menu-elasticcache.png" alt=""></li><li>Select <strong>Get Started Now</strong> or <strong>ElasticCache Dashboard</strong> and <strong>Launch Cache Cluster</strong></li><li>Select <strong>Memcached</strong> for the cluster engine.</li></ol><p>ElastiCache setup allows you to specify how many nodes you want in your cache cluster. In this example, we will be using 3.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/elasticcache-memcached-config.png" alt=""></p><p>So you&#39;re EC2 instance can access your Memcached cluster, ensure you select a <strong>VPC Security Group</strong> that exposes the default port <code>11211</code>.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/elasticcache-memcached-adv.png" alt=""></p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>If you haven&#39;t already setup a security group exposing this port, you&#39;ll need to create one by <a href="https://console.aws.amazon.com/vpc/home#securityGroups:" target="_blank" rel="noopener noreferrer">managing your VPC security groups</a></p></div><p>To finish, reviewed your settings and click <strong>Launch Cache Cluster</strong>.</p><h2 id="enable-caching-in-your-servicestack-application" tabindex="-1">Enable Caching in your ServiceStack application <a class="header-anchor" href="#enable-caching-in-your-servicestack-application" aria-hidden="true">#</a></h2><p>Now you&#39;re your Memcached cluster is ready, your AppHost can be configured to use it when deployed. AWS <strong>does not allow external access</strong> to ElastiCache servers, so they can only be used when your ServiceStack application is deployed.</p><p>First, you&#39;ll need to install <code>ServiceStack.Caching.Memcached</code>:</p>`,25),v=n("div",{class:"package-reference-box"},[n("div",{class:"flex"},[n("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[n("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[n("p",null,[n("code",null,'<PackageReference Include="ServiceStack.Caching.Memcached" Version="5.*" />')]),a(`
`)])]),n("div",{class:"flex-shrink"},[n("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),n("b")])]),n("div",{class:"copy-text w-full text-right h-6"})],-1),f=s(`<p>To access the Memcached nodes from your <code>Service</code>s, you will need to register a <code>MemcachedClientCache</code> as a <code>ICacheClient</code> with the IoC container. This client has to initialized with each of the node endpoints provided by AWS. From the <a href="https://console.aws.amazon.com/elasticache/home" target="_blank" rel="noopener noreferrer">ElastiCache Dashboard</a>, click on the <code>nodes</code> on your cluster to see the node endpoint URLs.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/elasticcache-memcached-nodes.png" alt="Memcached cluster view from Dashboard"></p><p>This will show all the nodes in the cluster. For example.</p><p><img src="https://github.com/ServiceStack/Assets/raw/master/img/aws/elasticcache-memcached-node-urls.png" alt="Listed node endpoints"></p><p>Below is a simple example of a configured self hosting AppHost that uses ElastiCache for caching when deployed and an in memory caching when developing locally.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppSelfHostBase</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;AWS Memcached ElastiCache Example&quot;</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyServices</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">Container</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//Your DB initialization</span>
		<span class="token range operator">..</span><span class="token punctuation">.</span>

        <span class="token comment">// AWS ElastiCache servers are NOT accessible from outside AWS</span>
        <span class="token comment">// Use MemoryCacheClient locally</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>AppSettings<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token string">&quot;Environment&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;Production&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ICacheClient<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MemcachedClientCache</span><span class="token punctuation">(</span>
                AwsElastiCacheConfig<span class="token punctuation">.</span>MemcachedNodes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            container<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Register</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ICacheClient<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">MemoryCacheClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>With configuration provided in your application config.</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Environment<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Production<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>MemcachedNodes<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{MemcachedNodeAddress1},{MemcachedNodeAddress2}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Now that your caching is setup and connecting, you can cache your web service responses easily by returning <code>Request.ToOptimizedResultUsingCache</code> from within a ServiceStack <code>Service</code>. For example, returning a full customers details might be an expensive database query. We can cache the result in the ElastiCache cluster for a faster response and invalidate the cache when the details are updated.</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerService</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Service</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">string</span></span> CacheKey <span class="token operator">=</span> <span class="token string">&quot;customer_details_{0}&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name">GetCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">ToOptimizedResultUsingCache</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Cache<span class="token punctuation">,</span>
            CacheKey<span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token punctuation">{</span>
                Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Long request</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetCustomerResponse</span>
                <span class="token punctuation">{</span>
                    Result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">LoadSingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">Put</span><span class="token punctuation">(</span><span class="token class-name">UpdateCustomer</span> request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> customer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Db<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">LoadSingleById</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        customer <span class="token operator">=</span> customer<span class="token punctuation">.</span><span class="token function">PopulateWith</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">ConvertTo</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Customer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Db<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Invalidate customer details cache</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Cache<span class="token punctuation">.</span><span class="token function">ClearCaches</span><span class="token punctuation">(</span>CacheKey<span class="token punctuation">.</span><span class="token function">Fmt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">UpdateCustomerResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Result <span class="token operator">=</span> customer
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>`,10),b=[c,l,i,u,r,k,d,g,m,h,w,y,S,v,f];function C(q,A,D,_,I,L){return o(),e("div",null,b)}var P=t(p,[["render",C]]);export{x as __pageData,P as default};
