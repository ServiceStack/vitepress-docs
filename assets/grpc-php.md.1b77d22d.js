import{_ as n,c as s,o as a,a as t}from"./app.14440598.js";const f='{"title":"gRPC protoc PHP Client","description":"","frontmatter":{"slug":"grpc-php","title":"gRPC protoc PHP Client"},"headers":[{"level":2,"title":"PHP protoc generated GrpcServiceClient TodoWorld Example","slug":"php-protoc-generated-grpcserviceclient-todoworld-example"},{"level":3,"title":"Prerequisites","slug":"prerequisites"},{"level":2,"title":"Setup for Windows","slug":"setup-for-windows"},{"level":3,"title":"Getting Started","slug":"getting-started"},{"level":3,"title":"PHP protoc gRPC insecure Example","slug":"php-protoc-grpc-insecure-example"},{"level":3,"title":"PHP protoc gRPC SSL Example","slug":"php-protoc-grpc-ssl-example"},{"level":3,"title":"PHP Local Development gRPC SSL CRUD Example","slug":"php-local-development-grpc-ssl-crud-example"}],"relativePath":"grpc-php.md","lastUpdated":1634495307618}',p={},o=t(`<p><a href="https://youtu.be/lRy3qb-x2Yc" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/grpc/php.png" alt=""></a></p><div class="info custom-block"><p class="custom-block-title">YouTube</p><p><a href="https://youtu.be/lRy3qb-x2Yc" target="_blank" rel="noopener noreferrer">youtu.be/lRy3qb-x2Yc</a></p></div><h2 id="php-protoc-generated-grpcserviceclient-todoworld-example" tabindex="-1">PHP protoc generated GrpcServiceClient TodoWorld Example <a class="header-anchor" href="#php-protoc-generated-grpcserviceclient-todoworld-example" aria-hidden="true">#</a></h2><h3 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-hidden="true">#</a></h3><p>This requires <code>php</code> &gt;= 5.5, <code>pecl</code>, <code>composer</code></p><p>Install the <code>grpc</code> extension:</p><div class="language-bash"><pre><code>$ <span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> pecl <span class="token function">install</span> grpc
</code></pre></div><h2 id="setup-for-windows" tabindex="-1">Setup for Windows <a class="header-anchor" href="#setup-for-windows" aria-hidden="true">#</a></h2><h4 id="grpc-pecl-download-for-windows" tabindex="-1">gRPC PECL Download for Windows <a class="header-anchor" href="#grpc-pecl-download-for-windows" aria-hidden="true">#</a></h4><p><a href="https://windows.php.net/downloads/pecl/releases/grpc/" target="_blank" rel="noopener noreferrer">https://windows.php.net/downloads/pecl/releases/grpc/</a></p><p>The PHP extension filename is in the following format:</p><div class="language-"><pre><code>php_grpc-{GRPC_VERSION}-{PHP_VERSION}-{THREAD_SAFETY}-{VC++_RUNTIME}-{CPU_ARCH}.zip
</code></pre></div><p>Select appropriate version for your OS and copy to <code>{PHP_HOME}\\ext</code>, then modify your <strong>php.ini</strong> file to include <code>extension=grpc</code>.</p><h3 id="getting-started" tabindex="-1">Getting Started <a class="header-anchor" href="#getting-started" aria-hidden="true">#</a></h3><p>Install <a href="https://docs.servicestack.net/dotnet-tool" target="_blank" rel="noopener noreferrer">x dotnet tool</a>:</p><div class="language-bash"><pre><code>$ dotnet tool <span class="token function">install</span> --global x 
</code></pre></div><p>Add required dependencies to <strong>composer.json</strong>:</p><div class="language-json"><pre><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;servicestack/grpc-todoworld&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Simple TodoWorld demo of using gRPC from PHP&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;require&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;grpc/grpc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^v1.3.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;google/protobuf&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^v3.3.0&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;autoload&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;psr-4&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;&quot;</span><span class="token operator">:</span> <span class="token string">&quot;route_guide/&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Install dependencies:</p><div class="language-bash"><pre><code>$ <span class="token function">composer</span> <span class="token function">install</span>
</code></pre></div><p>Add protoc generated TodoWorld DTOs and gRPC GrpcServiceClient:</p><div class="language-bash"><pre><code>$ x proto-php https://todoworld.servicestack.net
</code></pre></div><h3 id="php-protoc-grpc-insecure-example" tabindex="-1">PHP protoc gRPC insecure Example <a class="header-anchor" href="#php-protoc-grpc-insecure-example" aria-hidden="true">#</a></h3><p>Use protoc generated DTOs and <code>GrpcServiceClient</code> to call TodoWorld gRPC Service in <code>main.php</code>:</p><div class="language-php"><pre><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">require</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/vendor/autoload.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/GPBMetadata/Services.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/GrpcServicesClient.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/Hello.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/HelloResponse.php&#39;</span><span class="token punctuation">;</span>

<span class="token variable">$client</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>GrpcServicesClient</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;todoworld.servicestack.net:5054&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;credentials&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name class-name-fully-qualified static-context">Grpc<span class="token punctuation">\\</span>ChannelCredentials</span><span class="token operator">::</span><span class="token function">createInsecure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>Hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;gRPC PHP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">GetHello</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$status</span><span class="token operator">-&gt;</span><span class="token property">code</span> <span class="token operator">!==</span> Grpc\\<span class="token constant">STATUS_OK</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;Call did not complete successfully. Status object:\\n&quot;</span><span class="token punctuation">;</span>
    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">echo</span> <span class="token variable">$reply</span><span class="token operator">-&gt;</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p>Override <code>main.php</code> with the above PHP Example:</p><div class="language-bash"><pre><code>$ x mix todoworld-php
</code></pre></div><p>Run example:</p><div class="language-bash"><pre><code>$ php main.php
</code></pre></div><h3 id="php-protoc-grpc-ssl-example" tabindex="-1">PHP protoc gRPC SSL Example <a class="header-anchor" href="#php-protoc-grpc-ssl-example" aria-hidden="true">#</a></h3><p>Download TodoWorld SSL Certificate used for its gRPC HTTP/2 Services:</p><div class="language-bash"><pre><code>$ x get https://todoworld.servicestack.net/grpc.crt 
</code></pre></div><p>Use certificate when initializing <code>GrpcServicesClient</code>:</p><div class="language-php"><pre><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">require</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/vendor/autoload.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/GPBMetadata/Services.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/GrpcServicesClient.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/Hello.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/HelloResponse.php&#39;</span><span class="token punctuation">;</span>

<span class="token variable">$client</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>GrpcServicesClient</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;todoworld.servicestack.net:50051&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;credentials&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name class-name-fully-qualified static-context">Grpc<span class="token punctuation">\\</span>ChannelCredentials</span><span class="token operator">::</span><span class="token function">createSsl</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;grpc.crt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>Hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;gRPC PHP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">GetHello</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$status</span><span class="token operator">-&gt;</span><span class="token property">code</span> <span class="token operator">!==</span> Grpc\\<span class="token constant">STATUS_OK</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;Call did not complete successfully. Status object:\\n&quot;</span><span class="token punctuation">;</span>
    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">echo</span> <span class="token variable">$reply</span><span class="token operator">-&gt;</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p>Override <code>main.php</code> with the above PHP Example:</p><div class="language-bash"><pre><code>$ x mix todoworld-php-ssl
</code></pre></div><p>Run example:</p><div class="language-bash"><pre><code>$ php main.php
</code></pre></div><h3 id="php-local-development-grpc-ssl-crud-example" tabindex="-1">PHP Local Development gRPC SSL CRUD Example <a class="header-anchor" href="#php-local-development-grpc-ssl-crud-example" aria-hidden="true">#</a></h3><div class="language-php"><pre><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">require</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/vendor/autoload.php&#39;</span><span class="token punctuation">;</span>

@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/GPBMetadata/Services.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/GrpcServicesClient.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/EmptyResponse.php&#39;</span><span class="token punctuation">;</span>

@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/Hello.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/HelloResponse.php&#39;</span><span class="token punctuation">;</span>

@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/Todo.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/ResetTodos.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/CreateTodo.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/CreateTodoResponse.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/GetTodo.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/GetTodoResponse.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/GetTodos.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/GetTodosResponse.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/UpdateTodo.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/UpdateTodoResponse.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/DeleteTodo.php&#39;</span><span class="token punctuation">;</span>
@<span class="token keyword">include_once</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;/TodoWorld/DeleteTodoResponse.php&#39;</span><span class="token punctuation">;</span>

<span class="token variable">$client</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>GrpcServicesClient</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;localhost:5001&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">&#39;credentials&#39;</span> <span class="token operator">=&gt;</span> <span class="token class-name class-name-fully-qualified static-context">Grpc<span class="token punctuation">\\</span>ChannelCredentials</span><span class="token operator">::</span><span class="token function">createSsl</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">&#39;dev.crt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">global</span> <span class="token variable">$client</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function-definition function">client</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;client&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-definition function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$status</span><span class="token operator">-&gt;</span><span class="token property">code</span> <span class="token operator">!==</span> Grpc\\<span class="token constant">STATUS_OK</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;Call did not complete successfully. Status object:\\n&quot;</span><span class="token punctuation">;</span>
        <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-definition function">hello</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>Hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetHello</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$reply</span><span class="token operator">-&gt;</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// echo hello(&quot;World&quot;) . &quot;\\n&quot;;</span>

<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">PostResetTodos</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>ResetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//POST /todos</span>
<span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>CreateTodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;ServiceStack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">PostCreateTodo</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$todo</span> <span class="token operator">=</span> <span class="token variable">$reply</span><span class="token operator">-&gt;</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;new todo Id: &quot;</span> <span class="token operator">.</span> <span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;, Title: &quot;</span> <span class="token operator">.</span> <span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;\\n&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//GET /todos</span>
<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">CallGetTodos</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>GetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;todos: &quot;</span> <span class="token operator">.</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token operator">-&gt;</span><span class="token function">getResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;\\n&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//GET /todos/1</span>
<span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>GetTodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">CallGetTodo</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$todo</span> <span class="token operator">=</span> <span class="token variable">$reply</span><span class="token operator">-&gt;</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;get todo Id: &quot;</span> <span class="token operator">.</span> <span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;, Title: &quot;</span> <span class="token operator">.</span> <span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;\\n&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//PUT /todos/1</span>
<span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>UpdateTodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;gRPC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">PutUpdateTodo</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//GET /todos/1</span>
<span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>GetTodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">CallGetTodo</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$todo</span> <span class="token operator">=</span> <span class="token variable">$reply</span><span class="token operator">-&gt;</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;get todo Id: &quot;</span> <span class="token operator">.</span> <span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;, Title: &quot;</span> <span class="token operator">.</span> <span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;\\n&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//DELETE /todos/1</span>
<span class="token variable">$request</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>DeleteTodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token variable">$todo</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">CallDeleteTodo</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//GET /todos</span>
<span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token punctuation">,</span> <span class="token variable">$status</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$client</span><span class="token operator">-&gt;</span><span class="token function">CallGetTodos</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">TodoWorld<span class="token punctuation">\\</span>GetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertStatus</span><span class="token punctuation">(</span><span class="token variable">$status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;todos: &quot;</span> <span class="token operator">.</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$reply</span><span class="token operator">-&gt;</span><span class="token function">getResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;\\n&quot;</span><span class="token punctuation">;</span>
</span></code></pre></div><p>Refer to <a href="https://github.com/NetCoreApps/todo-world/tree/master/src/clients/php" target="_blank" rel="noopener noreferrer">/src/clients/php</a> for a complete example project.</p>`,41),e=[o];function c(l,u,i,r,k,d){return a(),s("div",null,e)}var _=n(p,[["render",c]]);export{f as __pageData,_ as default};
