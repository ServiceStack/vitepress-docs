import{_ as n,c as s,o as a,a as e}from"./app.14440598.js";const g=`{"title":"Swift","description":"","frontmatter":{"slug":"swift-add-servicestack-reference"},"headers":[{"level":2,"title":"Swift","slug":"swift"},{"level":2,"title":"Simple command-line utils for ServiceStack","slug":"simple-command-line-utils-for-servicestack"},{"level":3,"title":"Xcode","slug":"xcode"},{"level":3,"title":"Simple Usage Example","slug":"simple-usage-example"},{"level":3,"title":"Add a new ServiceStack Reference","slug":"add-a-new-servicestack-reference"},{"level":2,"title":"Swift Server Configuration","slug":"swift-server-configuration"},{"level":2,"title":"Swift Configuration","slug":"swift-configuration"},{"level":3,"title":"BaseClass","slug":"baseclass"},{"level":3,"title":"AddModelExtensions","slug":"addmodelextensions"},{"level":3,"title":"AddServiceStackTypes","slug":"addservicestacktypes"},{"level":3,"title":"IncludeTypes","slug":"includetypes"},{"level":3,"title":"ExcludeTypes","slug":"excludetypes"},{"level":3,"title":"ExcludeGenericBaseTypes","slug":"excludegenericbasetypes"},{"level":3,"title":"AddResponseStatus","slug":"addresponsestatus"},{"level":3,"title":"AddImplicitVersion","slug":"addimplicitversion"},{"level":3,"title":"InitializeCollections","slug":"initializecollections"},{"level":3,"title":"DefaultImports","slug":"defaultimports"},{"level":3,"title":"Swift style enums","slug":"swift-style-enums"},{"level":2,"title":"Swift Client Usage","slug":"swift-client-usage"},{"level":3,"title":"JsonServiceClient.swift","slug":"jsonserviceclient-swift"},{"level":3,"title":"JsonServiceClient Usage","slug":"jsonserviceclient-usage"},{"level":3,"title":"Async API Usage","slug":"async-api-usage"},{"level":3,"title":"Typed Error Handling","slug":"typed-error-handling"},{"level":3,"title":"JsonServiceClient Error Handlers","slug":"jsonserviceclient-error-handlers"},{"level":3,"title":"Swift HTTP Marker Interfaces","slug":"swift-http-marker-interfaces"},{"level":3,"title":"Custom Routes","slug":"custom-routes"},{"level":3,"title":"JsonServiceClient Options","slug":"jsonserviceclient-options"},{"level":2,"title":"TechStacks iOS App","slug":"techstacks-ios-app"},{"level":3,"title":"MVC and Key-Value Observables (KVO)","slug":"mvc-and-key-value-observables-kvo"},{"level":3,"title":"Enable Key-Value Observing in Swift DTO's","slug":"enable-key-value-observing-in-swift-dto-s"},{"level":3,"title":"Observing Data Changes","slug":"observing-data-changes"},{"level":3,"title":"Images and Custom Binary Requests","slug":"images-and-custom-binary-requests"},{"level":2,"title":"TechStacks macOS Desktop App","slug":"techstacks-macos-desktop-app"},{"level":3,"title":"Querying Technology Stacks","slug":"querying-technology-stacks"},{"level":3,"title":"Querying Technologies","slug":"querying-technologies"},{"level":3,"title":"TechStacks Console App","slug":"techstacks-console-app"},{"level":2,"title":"Swift Generated DTO Types","slug":"swift-generated-dto-types"},{"level":3,"title":"Swift Code Generation","slug":"swift-code-generation"},{"level":3,"title":"Swift Native Types Limitations","slug":"swift-native-types-limitations"}],"relativePath":"swift-add-servicestack-reference.md","lastUpdated":1634495308450}`,t={},p=e(`__VP_STATIC_START__<p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/swift-logo-banner.jpg" alt="Swift iOS, XCode and macOS Banner"></p><h2 id="swift" tabindex="-1">Swift <a class="header-anchor" href="#swift" aria-hidden="true">#</a></h2><p>ServiceStack&#39;s <strong>Add ServiceStack Reference</strong> feature lets iOS/macOS developers easily generate an native typed Swift API for your ServiceStack Services using the <code>x</code> dotnet command-line tool.</p><h2 id="simple-command-line-utils-for-servicestack" tabindex="-1">Simple command-line utils for ServiceStack <a class="header-anchor" href="#simple-command-line-utils-for-servicestack" aria-hidden="true">#</a></h2><p>The <a href="https://docs.servicestack.net/dotnet-tool" target="_blank" rel="noopener noreferrer">x dotnet tool</a> provides a simple command-line UX to easily Add and Update Swift ServiceStack References.</p><p>Prerequisites: Install <a href="https://dotnet.microsoft.com/download" target="_blank" rel="noopener noreferrer">.NET Core</a>.</p><div class="language-bash"><pre><code>$ dotnet tool <span class="token function">install</span> --global x 
</code></pre></div><p>This will make the <code>x</code> dotnet tool available in your <code>$PATH</code> which can now be used from within a <strong>Terminal window</strong> at your Xcode project folder.</p><p>To use the latest <code>JsonServiceClient</code> you&#39;ll need to add a reference to ServiceStack Swift library using your preferred package manager:</p><h3 id="xcode" tabindex="-1">Xcode <a class="header-anchor" href="#xcode" aria-hidden="true">#</a></h3><p>From Xcode 12 the Swift Package Manager is built into Xcode.</p><p>Go to <strong>File</strong> &gt; <strong>Swift Packages</strong> &gt; <strong>Add Package Dependency</strong>:</p><p><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/dev/xcode-swift-add-package.png" alt=""></p><p>Add a reference to the ServiceStack.Swift GitHub repo:</p><p><a href="https://github.com/ServiceStack/ServiceStack.Swift" target="_blank" rel="noopener noreferrer">https://github.com/ServiceStack/ServiceStack.Swift</a></p><p><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/dev/xcode-add-servicestack-swift.png" alt=""></p><p>After adding the dependency both <a href="https://github.com/ServiceStack/ServiceStack.Swift" target="_blank" rel="noopener noreferrer">ServiceStack.Swift</a> and its <a href="https://github.com/mxcl/PromiseKit" target="_blank" rel="noopener noreferrer">PromiseKit</a> dependency will be added to your project:</p><p><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/dev/xcode-servicestack-swift-added.png" alt=""></p><h4 id="cocoapods" tabindex="-1">CocoaPods <a class="header-anchor" href="#cocoapods" aria-hidden="true">#</a></h4><p>In your <a href="https://guides.cocoapods.org/syntax/podfile.html" target="_blank" rel="noopener noreferrer">Podfile</a>:</p><div class="language-ruby"><pre><code>use_frameworks<span class="token operator">!</span>

<span class="token comment"># Pods for Project</span>
pod <span class="token string">&quot;ServiceStack&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;~&gt; 1.1&#39;</span>
</code></pre></div><h4 id="carthage" tabindex="-1">Carthage <a class="header-anchor" href="#carthage" aria-hidden="true">#</a></h4><div class="language-ruby"><pre><code>github <span class="token string">&quot;ServiceStack/ServiceStack.Swift&quot;</span> <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token number">1.1</span>
</code></pre></div><h4 id="swiftpm" tabindex="-1">SwiftPM <a class="header-anchor" href="#swiftpm" aria-hidden="true">#</a></h4><div class="language-swift"><pre><code>dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token function">package</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;https://github.com/ServiceStack/ServiceStack.Swift&quot;</span></span><span class="token punctuation">,</span> from<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;1.0.0&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="simple-usage-example" tabindex="-1">Simple Usage Example <a class="header-anchor" href="#simple-usage-example" aria-hidden="true">#</a></h3><p>Async usage example:</p><div class="language-swift"><pre><code><span class="token keyword">import</span> <span class="token class-name">ServiceStack</span>

client<span class="token punctuation">.</span><span class="token function">getAsync</span><span class="token punctuation">(</span><span class="token class-name">AppOverview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>done <span class="token punctuation">{</span> r <span class="token keyword">in</span>
        r<span class="token punctuation">.</span>topTechnologies<span class="token punctuation">.</span>count <span class="token comment">//= 100</span>
        <span class="token comment">//... </span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Sync usage example:</p><div class="language-swift"><pre><code><span class="token keyword">import</span> <span class="token class-name">ServiceStack</span>

<span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token class-name">JsonServiceClient</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;https://techstacks.io&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">let</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token class-name">AppOverview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="add-a-new-servicestack-reference" tabindex="-1">Add a new ServiceStack Reference <a class="header-anchor" href="#add-a-new-servicestack-reference" aria-hidden="true">#</a></h3><p>To Add a new ServiceStack Reference, call <code>x swift</code> with the Base URL to a remote ServiceStack instance:</p><div class="language-bash"><pre><code>$ x swift <span class="token punctuation">{</span>BaseUrl<span class="token punctuation">}</span>
$ x swift <span class="token punctuation">{</span>BaseUrl<span class="token punctuation">}</span> <span class="token punctuation">{</span>FileName<span class="token punctuation">}</span>
</code></pre></div><p>Where if no FileName is provided, it&#39;s inferred from the host name of the remote URL, e.g:</p><div class="language-bash"><pre><code>$ x swift https://techstacks.io
</code></pre></div><p>Downloads the Typed Swift DTOs for <a href="https://techstacks.io" target="_blank" rel="noopener noreferrer">techstacks.io</a> and saves them to <code>dtos.swift</code>.</p><p>Alternatively you can have it saved to a different FileName with:</p><div class="language-bash"><pre><code>$ x swift https://techstacks.io TechStacks
</code></pre></div><p>Which instead saves the DTOs to <code>dtos.swift</code>.</p><p><code>x swift</code> also downloads <a href="https://github.com/ServiceStack/ServiceStack.Swift" target="_blank" rel="noopener noreferrer">ServiceStack&#39;s Swift Client</a> and saves it to <code>JsonServiceClient.swift</code> which together with the Server DTOs contains all the dependencies required to consume Typed Web Services in Swift.</p><h4 id="update-an-existing-servicestack-reference" tabindex="-1">Update an existing ServiceStack Reference <a class="header-anchor" href="#update-an-existing-servicestack-reference" aria-hidden="true">#</a></h4><p>The easiest way to update all your Swift Server DTOs is to just call <code>x swift</code> without any arguments:</p><div class="language-bash"><pre><code>$ x swift
</code></pre></div><p>This will go through and update all your <code>*.dtos.swift</code> Service References.</p><p>To Update a specific ServiceStack Reference, call <code>x swift</code> with the Filename:</p><div class="language-bash"><pre><code>$ x swift <span class="token punctuation">{</span>FileName.dtos.swift<span class="token punctuation">}</span>
</code></pre></div><p>As an example, you can Update the Server DTOs added in the previous command with:</p><div class="language-bash"><pre><code>$ x swift dtos.swift
</code></pre></div><p>Which also includes any <a href="https://docs.servicestack.net/swift-add-servicestack-reference#swift-configuration" target="_blank" rel="noopener noreferrer">Customization Options</a> that were manually added.</p><h2 id="swift-server-configuration" tabindex="-1">Swift Server Configuration <a class="header-anchor" href="#swift-server-configuration" aria-hidden="true">#</a></h2><p>The Swift defaults are overridable on the ServiceStack Server by modifying the default config on the <code>NativeTypesFeature</code> Plugin, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> typesConfig <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetPlugin</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NativeTypesFeature<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MetadataTypesConfig<span class="token punctuation">;</span>
typesConfig<span class="token punctuation">.</span>AddResponseStatus <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre></div><p>More Swift-specific configuration is available on the <code>SwiftGenerator</code> class itself, e.g:</p><div class="language-csharp"><pre><code>SwiftGenerator<span class="token punctuation">.</span>DefaultImports<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;UIKit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="swift-configuration" tabindex="-1">Swift Configuration <a class="header-anchor" href="#swift-configuration" aria-hidden="true">#</a></h2><p>The header comments in the generated DTO&#39;s allows for further customization of how the DTO&#39;s are generated which can then be updated with any custom Options provided using the <strong>Update ServiceStack Reference</strong> Menu Item in XCode. Options that are preceded by a Swift single line comment <code>//</code> are defaults from the server that can be overridden, e.g:</p><div class="language-swift"><pre><code><span class="token comment">/* Options:
Date: 2017-02-02 02:41:09
SwiftVersion: 3.0
Version: 4.55
Tip: To override a DTO option, remove &quot;//&quot; prefix before updating
BaseUrl: https://techstacks.io

//BaseClass: 
//AddModelExtensions: True
//AddServiceStackTypes: True
//IncludeTypes: 
//ExcludeTypes: 
//ExcludeGenericBaseTypes: True
//AddResponseStatus: False
//AddImplicitVersion: 
//InitializeCollections: True
//DefaultImports: Foundation
*/</span>
</code></pre></div><p>To override a value, remove the <code>//</code> and specify the value to the right of the <code>:</code>. Any value uncommented will be sent to the server to override any server defaults.</p><p>We&#39;ll go through and cover each of the above options to see how they affect the generated DTO&#39;s:</p><h3 id="baseclass" tabindex="-1">BaseClass <a class="header-anchor" href="#baseclass" aria-hidden="true">#</a></h3><p>Specify a base class that&#39;s inherited by all Swift DTO&#39;s, e.g. to enable <a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html" target="_blank" rel="noopener noreferrer">Key-Value Observing (KVO)</a> in the generated DTO models have all types inherit from <code>NSObject</code>:</p><div class="language-"><pre><code>/* Options:
BaseClass: NSObject
</code></pre></div><p>Will change all DTO types to inherit from <code>NSObject</code>:</p><div class="language-swift"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserInfo</span> <span class="token punctuation">:</span> <span class="token class-name">NSObject</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="addmodelextensions" tabindex="-1">AddModelExtensions <a class="header-anchor" href="#addmodelextensions" aria-hidden="true">#</a></h3><p>Remove the the code-generated type extensions required to support typed JSON serialization of the Swift types and leave only the clean Swift DTO Type definitions.</p><div class="language-"><pre><code>/* Options:
AddModelExtensions: False
</code></pre></div><h3 id="addservicestacktypes" tabindex="-1">AddServiceStackTypes <a class="header-anchor" href="#addservicestacktypes" aria-hidden="true">#</a></h3><p>Don&#39;t generate the types for built-in ServiceStack classes and Services like <code>ResponseStatus</code> and <code>Authenticate</code>, etc.</p><div class="language-"><pre><code>/* Options:
AddServiceStackTypes: False
</code></pre></div><h3 id="includetypes" tabindex="-1">IncludeTypes <a class="header-anchor" href="#includetypes" aria-hidden="true">#</a></h3><p>Is used as a Whitelist that can be used to specify only the types you would like to have code-generated:</p><div class="language-"><pre><code>/* Options:
IncludeTypes: GetTechnology,GetTechnologyResponse
</code></pre></div><p>Will only generate <code>GetTechnology</code> and <code>GetTechnologyResponse</code> DTO&#39;s:</p><div class="language-swift"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetTechnology</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetTechnologyResponse</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="include-request-dto-and-its-dependent-types" tabindex="-1">Include Request DTO and its dependent types <a class="header-anchor" href="#include-request-dto-and-its-dependent-types" aria-hidden="true">#</a></h4><p>You can include a Request DTO and all its dependent types with a <code>.*</code> suffix on the Request DTO, e.g:</p><div class="language-"><pre><code>/* Options:
IncludeTypes: GetTechnology.*
</code></pre></div><p>Which will include the <code>GetTechnology</code> Request DTO, the <code>GetTechnologyResponse</code> Response DTO and all Types that they both reference.</p><h4 id="include-all-types-within-a-c-namespace" tabindex="-1">Include All Types within a C# namespace <a class="header-anchor" href="#include-all-types-within-a-c-namespace" aria-hidden="true">#</a></h4><p>If your DTOs are grouped into different namespaces they can be all included using the <code>/*</code> suffix, e.g:</p><div class="language-"><pre><code>/* Options:
IncludeTypes: MyApp.ServiceModel.Admin/*
</code></pre></div><p>This will include all DTOs within the <code>MyApp.ServiceModel.Admin</code> C# namespace.</p><h4 id="include-all-services-in-a-tag-group" tabindex="-1">Include All Services in a Tag Group <a class="header-anchor" href="#include-all-services-in-a-tag-group" aria-hidden="true">#</a></h4><p>Services <a href="/api-design.html#group-services-by-tag">grouped by Tag</a> can be used in the <code>IncludeTypes</code> where tags can be specified using braces in the format <code>{tag}</code> or <code>{tag1,tag2,tag3}</code>, e.g:</p><div class="language-"><pre><code>/* Options:
IncludeTypes: {web,mobile}
</code></pre></div><p>Or individually:</p><div class="language-"><pre><code>/* Options:
IncludeTypes: {web},{mobile}
</code></pre></div><h3 id="excludetypes" tabindex="-1">ExcludeTypes <a class="header-anchor" href="#excludetypes" aria-hidden="true">#</a></h3><p>Is used as a Blacklist where you can specify which types you would like to exclude from being generated:</p><div class="language-"><pre><code>/* Options:
ExcludeTypes: GetTechnology,GetTechnologyResponse
</code></pre></div><p>Will exclude <code>GetTechnology</code> and <code>GetTechnologyResponse</code> DTO&#39;s from being generated.</p><h3 id="excludegenericbasetypes" tabindex="-1">ExcludeGenericBaseTypes <a class="header-anchor" href="#excludegenericbasetypes" aria-hidden="true">#</a></h3><p>Work around a <a href="https://github.com/ServiceStack/ServiceStack/blob/master/docs/2015/release-notes.md#swift-native-types-upgraded-to-swift-12" target="_blank" rel="noopener noreferrer">regression added in Swift 1.2</a> where the Swift compiler segfaults trying to compile Extensions to Types with a Generic Base Class. You can omit the problematic Generic Base Types from being generated with:</p><div class="language-swift"><pre><code><span class="token class-name">ExcludeGenericBaseTypes</span><span class="token punctuation">:</span> <span class="token class-name">True</span>
</code></pre></div><p>Any types that were omitted from the generated DTO&#39;s will be emitted in comments, using the format:</p><div class="language-swift"><pre><code><span class="token comment">//Excluded: {TypeName}</span>
</code></pre></div><h3 id="addresponsestatus" tabindex="-1">AddResponseStatus <a class="header-anchor" href="#addresponsestatus" aria-hidden="true">#</a></h3><p>Automatically add a <code>ResponseStatus</code> property on all Response DTO&#39;s, regardless if it wasn&#39;t already defined:</p><div class="language-"><pre><code>/* Options:
AddResponseStatus: True
</code></pre></div><p>Will add a <code>ResponseStatus</code> property to all Response DTO&#39;s:</p><div class="language-swift"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetAllTechnologiesResponse</span>
<span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> responseStatus<span class="token punctuation">:</span><span class="token class-name">ResponseStatus</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="addimplicitversion" tabindex="-1">AddImplicitVersion <a class="header-anchor" href="#addimplicitversion" aria-hidden="true">#</a></h3><p>Lets you specify the Version number to be automatically populated in all Request DTO&#39;s sent from the client:</p><div class="language-"><pre><code>/* Options:
AddImplicitVersion: 1
</code></pre></div><p>Will add an initialized <code>version</code> property to all Request DTO&#39;s:</p><div class="language-swift"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetAllTechnologies</span> <span class="token punctuation">:</span> <span class="token class-name">IReturn</span>
<span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> version<span class="token punctuation">:</span><span class="token class-name">Int</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This lets you know what Version of the Service Contract that existing clients are using making it easy to implement ServiceStack&#39;s <a href="http://stackoverflow.com/a/12413091/85785" target="_blank" rel="noopener noreferrer">recommended versioning strategy</a>.</p><h3 id="initializecollections" tabindex="-1">InitializeCollections <a class="header-anchor" href="#initializecollections" aria-hidden="true">#</a></h3><p>Whether enumerables should be initialized with an empty collection (default) or changed to use an Optional type:</p><div class="language-"><pre><code>/* Options:
InitializeCollections: False
</code></pre></div><p>Changes Collection Definitions to be declared as Optional Types instead of being initialized with an empty collection:</p><div class="language-swift"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResponseStatus</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> errors<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">ResponseError</span><span class="token punctuation">]</span><span class="token operator">?</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="defaultimports" tabindex="-1">DefaultImports <a class="header-anchor" href="#defaultimports" aria-hidden="true">#</a></h3><p>Add additional import statements to the generated DTO&#39;s:</p><div class="language-"><pre><code>/* Options:
DefaultImports: UIKit,Foundation
</code></pre></div><p>Will import the <code>UIKit</code> and <code>Foundation</code> frameworks:</p><div class="language-swift"><pre><code><span class="token keyword">import</span> <span class="token class-name">UIKit</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token class-name">Foundation</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="swift-style-enums" tabindex="-1">Swift style enums <a class="header-anchor" href="#swift-style-enums" aria-hidden="true">#</a></h3><p>You can override code-generation to emit Swift Style <strong>camelCase</strong> enums in your AppHost with:</p><div class="language-csharp"><pre><code>SwiftGenerator<span class="token punctuation">.</span>EnumNameStrategy <span class="token operator">=</span> SwiftGenerator<span class="token punctuation">.</span>SwiftStyleEnums<span class="token punctuation">;</span>
</code></pre></div><h2 id="swift-client-usage" tabindex="-1">Swift Client Usage <a class="header-anchor" href="#swift-client-usage" aria-hidden="true">#</a></h2><h3 id="jsonserviceclient-swift" tabindex="-1"><a href="https://github.com/ServiceStack/ServiceStack.Swift/blob/master/dist/JsonServiceClient.swift" target="_blank" rel="noopener noreferrer">JsonServiceClient.swift</a> <a class="header-anchor" href="#jsonserviceclient-swift" aria-hidden="true">#</a></h3><p>The same ideal, high-level API available in <a href="/csharp-client.html">.NET&#39;s ServiceClients</a> have been translated into idiomatic Swift as seen with its <code>ServiceClient</code> protocol definition below:</p><div class="language-swift"><pre><code><span class="token keyword">public</span> <span class="token keyword">protocol</span> <span class="token class-name">ServiceClient</span>
<span class="token punctuation">{</span>
    <span class="token keyword">func</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span>
    <span class="token keyword">func</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span>
    <span class="token keyword">func</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span>
    <span class="token keyword">func</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span>
    <span class="token keyword">func</span> <span class="token function-definition function">getAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">getAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">Void</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">getAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">getAsync</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">post</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span>
    <span class="token keyword">func</span> <span class="token function-definition function">post</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span>
    <span class="token keyword">func</span> <span class="token function-definition function">post</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span><span class="token class-name">Request</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Response</span>
    <span class="token keyword">func</span> <span class="token function-definition function">postAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">postAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">Void</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">postAsync</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span><span class="token class-name">Request</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">Response</span><span class="token operator">&gt;</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">put</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span>
    <span class="token keyword">func</span> <span class="token function-definition function">put</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span>
    <span class="token keyword">func</span> <span class="token function-definition function">put</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span><span class="token class-name">Request</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Response</span>
    <span class="token keyword">func</span> <span class="token function-definition function">putAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">putAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">Void</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">putAsync</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span><span class="token class-name">Request</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">Response</span><span class="token operator">&gt;</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">delete</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span>
    <span class="token keyword">func</span> <span class="token function-definition function">delete</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span>
    <span class="token keyword">func</span> <span class="token function-definition function">delete</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span>
    <span class="token keyword">func</span> <span class="token function-definition function">delete</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span>
    <span class="token keyword">func</span> <span class="token function-definition function">deleteAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">deleteAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">Void</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">deleteAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">,</span> query<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">deleteAsync</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">patch</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span>
    <span class="token keyword">func</span> <span class="token function-definition function">patch</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span>
    <span class="token keyword">func</span> <span class="token function-definition function">patch</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span><span class="token class-name">Request</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Response</span>
    <span class="token keyword">func</span> <span class="token function-definition function">patchAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">patchAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">Void</span><span class="token operator">&gt;</span>
    <span class="token keyword">func</span> <span class="token function-definition function">patchAsync</span><span class="token punctuation">(</span>relativeUrl<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span><span class="token class-name">Request</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">Response</span><span class="token operator">&gt;</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">send</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">.</span><span class="token class-name">Return</span>
    <span class="token keyword">func</span> <span class="token function-definition function">send</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span>
    <span class="token keyword">func</span> <span class="token function-definition function">send</span><span class="token punctuation">(</span>intoResponse<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span><span class="token class-name">NSMutableURLRequest</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span>
    <span class="token keyword">func</span> <span class="token function-definition function">sendAsync</span><span class="token punctuation">(</span>intoResponse<span class="token punctuation">:</span><span class="token class-name">T</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span><span class="token class-name">NSMutableURLRequest</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span>
    
    <span class="token keyword">func</span> <span class="token function-definition function">getData</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">NSData</span>
    <span class="token keyword">func</span> <span class="token function-definition function">getDataAsync</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">NSData</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Generic type constraints omitted for readability</p></blockquote><p>The minor differences are primarily due to differences in Swift which instead of throwing Exceptions uses error codes and <code>Optional</code> return types and its lack of any asynchrony language support led us to embed a lightweight and <a href="http://promisekit.org/introduction/" target="_blank" rel="noopener noreferrer">well-documented Promises</a> implementation in <a href="https://github.com/mxcl/PromiseKit" target="_blank" rel="noopener noreferrer">PromiseKit</a> which closely matches the <code>Task&lt;T&gt;</code> type used in .NET Async API&#39;s.</p><h3 id="jsonserviceclient-usage" tabindex="-1">JsonServiceClient Usage <a class="header-anchor" href="#jsonserviceclient-usage" aria-hidden="true">#</a></h3><p>If you&#39;ve ever had to make HTTP requests using Objective-C&#39;s <code>NSURLConnection</code> or <code>NSURLSession</code> static classes in iOS or macOS, you&#39;ll appreciate the typing benefits and productivity offered by the higher-level API&#39;s in <code>JsonServiceClient</code> - which enable the same ideal client API&#39;s we&#39;ve enjoyed in ServiceStack&#39;s .NET Clients, in Swift Apps!</p><div class="info custom-block"><p class="custom-block-title">Tip</p><p>A nice benefit of using JsonServiceClient over static classes is that Service calls can be easily substituted and mocked with the above <code>ServiceClient</code> protocol, making it easy to test or stub out the external Gateway calls whilst the back-end is under development.</p></div><p>To illustrate its usage we&#39;ll go through some client code to consume <a href="https://github.com/ServiceStackApps/TechStacks" target="_blank" rel="noopener noreferrer">TechStacks</a> Services after adding a <strong>ServiceStack Reference</strong> to <code>http://techstaks.io</code>:</p><div class="language-swift"><pre><code><span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token class-name">JsonServiceClient</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;https://techstacks.io&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">var</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token class-name">AppOverview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>Essentially usage is the same as it is in .NET ServiceClients - where it just needs the <code>baseUrl</code> of the remote ServiceStack instance, which can then be used to consume remote Services by sending typed Request DTO&#39;s that respond in kind with the expected Response DTO.</p><h3 id="async-api-usage" tabindex="-1">Async API Usage <a class="header-anchor" href="#async-api-usage" aria-hidden="true">#</a></h3><p>Whilst the sync API&#39;s are easy to use their usage should be limited in background threads so they&#39;re not blocking the Apps UI whilst waiting for responses. Most of the time when calling services from the Main UI thread you&#39;ll want to use the non-blocking async API&#39;s, which for the same API looks like:</p><div class="language-swift"><pre><code>client<span class="token punctuation">.</span><span class="token function">getAsync</span><span class="token punctuation">(</span><span class="token class-name">AppOverview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>done <span class="token punctuation">{</span> 
        <span class="token short-argument">$0</span><span class="token punctuation">.</span>topTechnologies<span class="token punctuation">.</span>count <span class="token comment">//= 100</span>
        <span class="token comment">//... </span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Swift also lets you continue marking it up with explicit Type Information and optional syntax as preferred, e.g:</p><div class="language-swift"><pre><code>client<span class="token punctuation">.</span><span class="token function">getAsync</span><span class="token punctuation">(</span><span class="token class-name">AppOverview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token punctuation">(</span>r<span class="token punctuation">:</span><span class="token class-name">AppOverviewResponse</span><span class="token punctuation">)</span> <span class="token keyword">in</span>
        r<span class="token punctuation">.</span>topTechnologies<span class="token punctuation">.</span>count <span class="token comment">//= 100</span>
        <span class="token comment">//... </span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Which is very similar to how we&#39;d make async <code>Task&lt;T&gt;</code> calls in C# when not using its async/await language syntax sugar.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Async callbacks are called back on the main thread, ideal for use in iOS Apps. This behavior is also configurable in the Promise&#39;s callback API.</p></div><h3 id="typed-error-handling" tabindex="-1">Typed Error Handling <a class="header-anchor" href="#typed-error-handling" aria-hidden="true">#</a></h3><p>As Swift doesn&#39;t provide <code>try/catch</code> Exception Handling, Error handling is a little different in Swift which for most failable API&#39;s just returns a <code>nil</code> Optional to indicate when the operation didn&#39;t succeed. When more information about the error is required, API&#39;s will typically accept an additional <code>NSError</code> pointer argument to populate with more information about the error. Any additional metadata can be attached to NSError&#39;s <code>userInfo</code> Dictionary. We also follow this same approach to provide our structured error handling in <code>JsonServiceClient</code>.</p><p>To illustrate exception handling we&#39;ll connect to ServiceStack&#39;s Test Services and call the <code>ThrowType</code> Service to intentionally throw the error specified, e.g:</p><h4 id="sync-error-handling" tabindex="-1">Sync Error Handling <a class="header-anchor" href="#sync-error-handling" aria-hidden="true">#</a></h4><p>Handling a Single C# Exception:</p><div class="language-swift"><pre><code><span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token class-name">JsonServiceClient</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;http://test.servicestack.net&quot;</span></span><span class="token punctuation">)</span>

<span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token class-name">ThrowType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
request<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;NotFound&quot;</span></span>
request<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;custom message&quot;</span></span>

<span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token keyword">var</span> error <span class="token keyword">as</span> <span class="token class-name">NSError</span> <span class="token punctuation">{</span>
    error<span class="token punctuation">.</span>code <span class="token comment">//= 404</span>
    <span class="token comment">//Convert into typed ResponseStatus</span>
    <span class="token keyword">var</span> status<span class="token punctuation">:</span><span class="token class-name">ResponseStatus</span> <span class="token operator">=</span> error<span class="token punctuation">.</span><span class="token function">convertUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    status<span class="token punctuation">.</span>message <span class="token comment">//= not here</span>
    status<span class="token punctuation">.</span>stackTrace <span class="token comment">//= Server Stack Trace</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Handling a Validation Exception with multiple field validation errors:</p><div class="language-swift"><pre><code><span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token class-name">JsonServiceClient</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;http://test.servicestack.net&quot;</span></span><span class="token punctuation">)</span>

<span class="token keyword">let</span> request <span class="token operator">=</span> <span class="token class-name">ThrowValidation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
request<span class="token punctuation">.</span>email <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;invalidemail&quot;</span></span>

<span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">try</span> client<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token keyword">let</span> responseError <span class="token keyword">as</span> <span class="token class-name">NSError</span> <span class="token punctuation">{</span>    
    <span class="token keyword">let</span> status<span class="token punctuation">:</span><span class="token class-name">ResponseStatus</span> <span class="token operator">=</span> responseError<span class="token punctuation">.</span><span class="token function">convertUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span>
    status<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>count <span class="token comment">//= 3</span>
    <span class="token keyword">let</span> field1 <span class="token operator">=</span> status<span class="token punctuation">.</span>errors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    
    field1<span class="token punctuation">.</span>errorCode<span class="token operator">!</span> <span class="token comment">//= InclusiveBetween</span>
    field1<span class="token punctuation">.</span>fieldName<span class="token operator">!</span> <span class="token comment">//= Age</span>
    field1<span class="token punctuation">.</span>message<span class="token operator">!</span>   <span class="token comment">//= &#39;Age&#39; must be between 1 and 120. You entered 0.</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="async-error-handling" tabindex="-1">Async Error Handling <a class="header-anchor" href="#async-error-handling" aria-hidden="true">#</a></h4><p>To handle errors in Async API&#39;s we just add a callback on <code>.error()</code> API on the returned Promise, e.g:</p><div class="language-swift"><pre><code><span class="token keyword">let</span> request <span class="token operator">=</span> <span class="token class-name">ThrowValidation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
request<span class="token punctuation">.</span>email <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;invalidemail&quot;</span></span>

client<span class="token punctuation">.</span><span class="token function">postAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>error <span class="token punctuation">{</span> responseError <span class="token keyword">in</span>
        <span class="token keyword">let</span> status<span class="token punctuation">:</span><span class="token class-name">ResponseStatus</span> <span class="token operator">=</span> responseError<span class="token punctuation">.</span><span class="token function">convertUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span>
        status<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>count <span class="token comment">//= 3</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span>

</code></pre></div><h3 id="jsonserviceclient-error-handlers" tabindex="-1">JsonServiceClient Error Handlers <a class="header-anchor" href="#jsonserviceclient-error-handlers" aria-hidden="true">#</a></h3><p>Just like in .NET, we can also attach Global or instance error handlers to be able to generically handle all Service Client errors with a custom handler, e.g:</p><div class="language-swift"><pre><code>client<span class="token punctuation">.</span>onError <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>e<span class="token punctuation">:</span><span class="token class-name">NSError</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token class-name">JsonServiceClient</span><span class="token punctuation">.</span><span class="token class-name">Global</span><span class="token punctuation">.</span>onError <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>e<span class="token punctuation">:</span><span class="token class-name">NSError</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="swift-http-marker-interfaces" tabindex="-1">Swift HTTP Marker Interfaces <a class="header-anchor" href="#swift-http-marker-interfaces" aria-hidden="true">#</a></h3><p>The new <code>send*</code> API&#39;s take advantage of the HTTP Verb Interface Markers described below to send the Request DTO using the annotated HTTP Method, e.g:</p><div class="language-swift"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloByGet</span> <span class="token punctuation">:</span> <span class="token class-name">IReturn</span><span class="token punctuation">,</span> <span class="token class-name">IGet</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">typealias</span> <span class="token class-name">Return</span> <span class="token operator">=</span> <span class="token class-name">HelloResponse</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> name<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token operator">?</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloByPut</span> <span class="token punctuation">:</span> <span class="token class-name">IReturn</span><span class="token punctuation">,</span> <span class="token class-name">IPut</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">typealias</span> <span class="token class-name">Return</span> <span class="token operator">=</span> <span class="token class-name">HelloResponse</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> name<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token operator">?</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">try</span> client<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">HelloByGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//GET</span>

client<span class="token punctuation">.</span><span class="token function">sendAsync</span><span class="token punctuation">(</span><span class="token class-name">HelloByPut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment">//PUT</span>
    <span class="token punctuation">.</span>done <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="custom-routes" tabindex="-1">Custom Routes <a class="header-anchor" href="#custom-routes" aria-hidden="true">#</a></h3><p>As Swift doesn&#39;t support Attributes any exported .NET Attributes are emitted in comments on the Request DTO they apply to, e.g:</p><div class="language-swift"><pre><code><span class="token comment">// @Route(&quot;/technology/{Slug}&quot;)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetTechnology</span> <span class="token punctuation">:</span> <span class="token class-name">IReturn</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre></div><p>This also means that the Custom Routes aren&#39;t used when making Service Requests and instead just uses ServiceStack&#39;s built-in <a href="/routing.html#pre-defined-routes">pre-defined routes</a>.</p><p>But when preferred <code>JsonServiceClient</code> can also be used to call Services using Custom Routes, e.g:</p><div class="language-swift"><pre><code><span class="token keyword">var</span> response<span class="token punctuation">:</span><span class="token class-name">GetTechnologyResponse</span><span class="token operator">?</span> <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;/technology/servicestack&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>the explicit type definition on the return type is required here as Swift uses it as part of the generic method invocation.</p></div><h3 id="jsonserviceclient-options" tabindex="-1">JsonServiceClient Options <a class="header-anchor" href="#jsonserviceclient-options" aria-hidden="true">#</a></h3><p>Other options that can be configured on JsonServiceClient include:</p><div class="language-swift"><pre><code>client<span class="token punctuation">.</span>onError <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>e<span class="token punctuation">:</span><span class="token class-name">NSError</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
client<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token operator">...</span>
client<span class="token punctuation">.</span>cachePolicy <span class="token operator">=</span> <span class="token class-name">NSURLRequestCachePolicy</span><span class="token punctuation">.</span><span class="token class-name">ReloadIgnoringLocalCacheData</span>
client<span class="token punctuation">.</span>requestFilter <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>req<span class="token punctuation">:</span><span class="token class-name">NSMutableURLRequest</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
client<span class="token punctuation">.</span>responseFilter <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>res<span class="token punctuation">:</span><span class="token class-name">NSURLResponse</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">}</span>

<span class="token comment">//static Global configuration</span>
<span class="token class-name">JsonServiceClient</span><span class="token punctuation">.</span><span class="token class-name">Global</span><span class="token punctuation">.</span>onError <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>e<span class="token punctuation">:</span><span class="token class-name">NSError</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token class-name">JsonServiceClient</span><span class="token punctuation">.</span><span class="token class-name">Global</span><span class="token punctuation">.</span>requestFilter <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>req<span class="token punctuation">:</span><span class="token class-name">NSMutableURLRequest</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token class-name">JsonServiceClient</span><span class="token punctuation">.</span><span class="token class-name">Global</span><span class="token punctuation">.</span>responseFilter <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span>res<span class="token punctuation">:</span><span class="token class-name">NSURLResponse</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
</code></pre></div><h2 id="techstacks-ios-app" tabindex="-1"><a href="https://github.com/ServiceStackApps/TechStacksApp" target="_blank" rel="noopener noreferrer">TechStacks iOS App</a> <a class="header-anchor" href="#techstacks-ios-app" aria-hidden="true">#</a></h2><p>To illustrate the ease-of-use and utility of ServiceStack&#39;s new Swift support you can checkout the TechStacks native iOS App for <a href="https://techstacks.io" target="_blank" rel="noopener noreferrer">techstacks.io</a> that has been recently published and is now available to download for free on the AppStore:</p><p><a href="https://itunes.apple.com/us/app/techstacks/id965680615?ls=1&amp;mt=8" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/techstacks-appstore.png" alt="TechStacks on AppStore"></a></p><p>The complete source code for the <a href="https://github.com/ServiceStackApps/TechStacks" target="_blank" rel="noopener noreferrer">TechStacks App is available on GitHub</a> - providing a good example on how easy it is to take advantage of ServiceStack&#39;s Swift support to quickly build a rich and responsive Services-heavy native iOS App.</p><p>All remote Service Calls used by the App are encapsulated into a single <a href="https://github.com/ServiceStackApps/TechStacksApp/blob/master/src/TechStacks/AppData.swift" target="_blank" rel="noopener noreferrer">AppData.swift</a> class and only uses JsonServiceClient&#39;s non-blocking Async API&#39;s to ensure a Responsive UI is maintained throughout the App.</p><h3 id="mvc-and-key-value-observables-kvo" tabindex="-1">MVC and Key-Value Observables (KVO) <a class="header-anchor" href="#mvc-and-key-value-observables-kvo" aria-hidden="true">#</a></h3><p>If you&#39;ve ever had to implement <code>INotifyPropertyChanged</code> in .NET, you&#39;ll find the built-in model binding capabilities in iOS/macOS a refreshing alternative thanks to Objective-C&#39;s underlying <code>NSObject</code> which automatically generates change notifications for its KV-compliant properties. UIKit and Cocoa frameworks both leverage this feature to enable its <a href="https://developer.apple.com/library/mac/documentation/General/Conceptual/DevPedia-CocoaCore/MVC.html" target="_blank" rel="noopener noreferrer">Model-View-Controller Pattern</a>.</p><p>As keeping UI&#39;s updated with Async API callbacks can get unwieldy, we wanted to go through how we&#39;re taking advantage of NSObject&#39;s KVO support in Service Responses to simplify maintaining dynamic UI&#39;s.</p><h3 id="enable-key-value-observing-in-swift-dto-s" tabindex="-1">Enable Key-Value Observing in Swift DTO&#39;s <a class="header-anchor" href="#enable-key-value-observing-in-swift-dto-s" aria-hidden="true">#</a></h3><p>Firstly to enable KVO in your Swift DTO&#39;s we&#39;ll want to have each DTO inherit from <code>NSObject</code> which can be done by uncommenting <code>BaseObject</code> option in the header comments as seen below:</p><div class="language-"><pre><code>/* Options:
Date: 2015-02-19 22:43:04
Version: 1
BaseUrl: https://techstacks.io

BaseClass: NSObject
...
*/
</code></pre></div><p>and click the <strong>Update ServiceStack Reference</strong> Menu Option to fetch the updated DTO&#39;s.</p><p>Then to <a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/BuildingCocoaApps/AdoptingCocoaDesignPatterns.html#//apple_ref/doc/uid/TP40014216-CH7-XID_8" target="_blank" rel="noopener noreferrer">enable Key-Value Observing</a> just mark the response DTO variables with the <code>dynamic</code> modifier, e.g:</p><div class="language-swift"><pre><code><span class="token keyword">public</span> <span class="token keyword">dynamic</span> <span class="token keyword">var</span> allTiers<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">Option</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">dynamic</span> <span class="token keyword">var</span> overview<span class="token punctuation">:</span><span class="token class-name">AppOverviewResponse</span> <span class="token operator">=</span> <span class="token class-name">AppOverviewResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">dynamic</span> <span class="token keyword">var</span> topTechnologies<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">TechnologyInfo</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">dynamic</span> <span class="token keyword">var</span> allTechnologies<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">Technology</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">dynamic</span> <span class="token keyword">var</span> allTechnologyStacks<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">TechnologyStack</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre></div><p>Which is all that&#39;s needed to allow properties to be observed as they&#39;ll automatically issue change notifications when they&#39;re populated in the Service response async callbacks, e.g:</p><div class="language-swift"><pre><code><span class="token keyword">func</span> <span class="token function-definition function">loadOverview</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">AppOverviewResponse</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> client<span class="token punctuation">.</span><span class="token function">getAsync</span><span class="token punctuation">(</span><span class="token class-name">AppOverview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>done <span class="token punctuation">{</span> r <span class="token keyword">in</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>overview <span class="token operator">=</span> r
            <span class="token keyword">self</span><span class="token punctuation">.</span>allTiers <span class="token operator">=</span> r<span class="token punctuation">.</span>allTiers
            <span class="token keyword">self</span><span class="token punctuation">.</span>topTechnologies <span class="token operator">=</span> r<span class="token punctuation">.</span>topTechnologies
            <span class="token keyword">return</span> r
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function-definition function">loadAllTechnologies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">GetAllTechnologiesResponse</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> client<span class="token punctuation">.</span><span class="token function">getAsync</span><span class="token punctuation">(</span><span class="token class-name">GetAllTechnologies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>done <span class="token punctuation">{</span> r <span class="token keyword">in</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>allTechnologies <span class="token operator">=</span> r<span class="token punctuation">.</span>results
            <span class="token keyword">return</span> r
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function-definition function">loadAllTechStacks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">GetAllTechnologyStacksResponse</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> client<span class="token punctuation">.</span><span class="token function">getAsync</span><span class="token punctuation">(</span><span class="token class-name">GetAllTechnologyStacks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>done <span class="token punctuation">{</span> r <span class="token keyword">in</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>allTechnologyStacks <span class="token operator">=</span> r<span class="token punctuation">.</span>results
            <span class="token keyword">return</span> r
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="observing-data-changes" tabindex="-1">Observing Data Changes <a class="header-anchor" href="#observing-data-changes" aria-hidden="true">#</a></h3><p>In your <a href="https://github.com/ServiceStackApps/TechStacksApp/blob/0fca564e8c06fd1b71f81faee93a2e04c70a219b/src/TechStacks/HomeViewController.swift" target="_blank" rel="noopener noreferrer">ViewController</a> have the datasources for your custom views binded to the desired data (which will initially be empty):</p><div class="language-swift"><pre><code><span class="token keyword">func</span> <span class="token function-definition function">pickerView</span><span class="token punctuation">(</span>pickerView<span class="token punctuation">:</span> <span class="token class-name">UIPickerView</span><span class="token punctuation">,</span> numberOfRowsInComponent component<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> appData<span class="token punctuation">.</span>allTiers<span class="token punctuation">.</span>count
<span class="token punctuation">}</span>
<span class="token operator">...</span>
<span class="token keyword">func</span> <span class="token function-definition function">tableView</span><span class="token punctuation">(</span>tableView<span class="token punctuation">:</span> <span class="token class-name">UITableView</span><span class="token punctuation">,</span> numberOfRowsInSection section<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> appData<span class="token punctuation">.</span>topTechnologies<span class="token punctuation">.</span>count
<span class="token punctuation">}</span>
</code></pre></div><p>Then in <code>viewDidLoad()</code> <a href="https://github.com/ServiceStack/ServiceStack.Swift/blob/67c5c092b92927702f33b6a0669e3aa1de0e2cdc/apps/TechStacks/TechStacks/HomeViewController.swift#L31" target="_blank" rel="noopener noreferrer">start observing the properties</a> your UI Controls are bound to, e.g:</p><div class="language-swift"><pre><code><span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">viewDidLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>appData<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> properties<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;topTechnologies&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;allTiers&quot;</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>appData<span class="token punctuation">.</span><span class="token function">loadOverview</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">deinit</span> <span class="token punctuation">{</span> <span class="token keyword">self</span><span class="token punctuation">.</span>appData<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre></div><p>In the example code above we&#39;re using some custom <a href="https://github.com/ServiceStackApps/TechStacksApp/blob/0fca564e8c06fd1b71f81faee93a2e04c70a219b/src/TechStacks/AppData.swift#L159-L183" target="_blank" rel="noopener noreferrer">KVO helpers</a> to keep the code required to a minimum.</p><p>With the observable bindings in place, the change notifications of your observed properties can be handled by overriding <code>observeValueForKeyPath()</code> which passes the name of the property that&#39;s changed in the <code>keyPath</code> argument that can be used to determine the UI Controls to refresh, e.g:</p><div class="language-swift"><pre><code><span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">observeValueForKeyPath</span><span class="token punctuation">(</span>keyPath<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> ofObject object<span class="token punctuation">:</span><span class="token class-name">AnyObject</span><span class="token punctuation">,</span> change<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">NSObject</span><span class="token punctuation">:</span><span class="token class-name">AnyObject</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  context<span class="token punctuation">:</span> <span class="token class-name">UnsafeMutablePointer</span><span class="token operator">&lt;</span><span class="token class-name">Void</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> keyPath <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string-literal"><span class="token string">&quot;allTiers&quot;</span></span><span class="token punctuation">:</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>technologyPicker<span class="token punctuation">.</span><span class="token function">reloadAllComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token string-literal"><span class="token string">&quot;topTechnologies&quot;</span></span><span class="token punctuation">:</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>tblView<span class="token punctuation">.</span><span class="token function">reloadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token keyword">break</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now that everything&#39;s configured, the observables provide an alternative to manually updating UI elements within async callbacks, instead you can now fire-and-forget your async API&#39;s and rely on the pre-configured bindings to automatically update the appropriate UI Controls when their bounded properties are updated, e.g:</p><div class="language-swift"><pre><code><span class="token keyword">self</span><span class="token punctuation">.</span>appData<span class="token punctuation">.</span><span class="token function">loadOverview</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//Ignore response and use configured KVO Bindings</span>
</code></pre></div><h3 id="images-and-custom-binary-requests" tabindex="-1">Images and Custom Binary Requests <a class="header-anchor" href="#images-and-custom-binary-requests" aria-hidden="true">#</a></h3><p>In addition to greatly simplifying Web Service Requests, <code>JsonServiceClient</code> also makes it easy to fetch any custom HTTP response like Images and other Binary data using the generic <code>getData()</code> and <code>getDataAsync()</code> NSData API&#39;s. This is used in TechStacks to <a href="https://github.com/ServiceStackApps/TechStacksApp/blob/0fca564e8c06fd1b71f81faee93a2e04c70a219b/src/TechStacks/AppData.swift#L144" target="_blank" rel="noopener noreferrer">maintain a cache of all loaded images</a>, reducing number of HTTP requests and load times when navigating between screens:</p><div class="language-swift"><pre><code><span class="token keyword">var</span> imageCache<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span><span class="token class-name">UIImage</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token keyword">public</span> <span class="token keyword">func</span> <span class="token function-definition function">loadImageAsync</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">UIImage</span><span class="token operator">?&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> image <span class="token operator">=</span> imageCache<span class="token punctuation">[</span>url<span class="token punctuation">]</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">UIImage</span><span class="token operator">?&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>complete<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token function">complete</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> client<span class="token punctuation">.</span><span class="token function">getDataAsync</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>done <span class="token punctuation">{</span> <span class="token punctuation">(</span>data<span class="token punctuation">:</span><span class="token class-name">NSData</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">UIImage</span><span class="token operator">?</span> <span class="token keyword">in</span>
            <span class="token keyword">if</span> <span class="token keyword">let</span> image <span class="token operator">=</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">self</span><span class="token punctuation">.</span>imageCache<span class="token punctuation">[</span>url<span class="token punctuation">]</span> <span class="token operator">=</span> image
                <span class="token keyword">return</span> image
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token nil constant">nil</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="techstacks-macos-desktop-app" tabindex="-1"><a href="https://github.com/ServiceStackApps/TechStacksDesktopApp" target="_blank" rel="noopener noreferrer">TechStacks macOS Desktop App</a> <a class="header-anchor" href="#techstacks-macos-desktop-app" aria-hidden="true">#</a></h2><p>As <code>JsonServiceClient.swift</code> has no external dependencies and only relies on core <code>Foundation</code> classes it can be used anywhere Swift can including macOS Cocoa Desktop and Command Line Apps and Frameworks.</p><p>Most of the API&#39;s used in TechStacks iOS App are standard typed Web Services calls. There is also a <a href="https://github.com/ServiceStackApps/TechStacksDesktopApp" target="_blank" rel="noopener noreferrer">TechStacks macOS Desktop</a> available which showcases how easy it is to call ServiceStack&#39;s dynamic <a href="/autoquery.html">AutoQuery Services</a> and how much auto-querying functionality they can provide for free.</p><p>E.g. The TechStacks Desktop app is essentially powered with these 2 AutoQuery Services:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Query</span><span class="token attribute-arguments"><span class="token punctuation">(</span>QueryTerm<span class="token punctuation">.</span>Or<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span> <span class="token comment">//change from filtering (default) to combinatory semantics</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FindTechStacks</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryBase<span class="token punctuation">&lt;</span>TechnologyStack<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Query</span><span class="token attribute-arguments"><span class="token punctuation">(</span>QueryTerm<span class="token punctuation">.</span>Or<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FindTechnologies</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">QueryBase<span class="token punctuation">&lt;</span>Technology<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>Basically just a Request DTO telling AutoQuery what Table we want to Query and that we want to <a href="/autoquery.html#changing-querying-behavior">change the default Search behavior</a> to have <strong>OR</strong> semantics. We don&#39;t need to specify which properties we can query as the <a href="/autoquery.html#implicit-conventions">implicit conventions</a> automatically infer it from the table being queried.</p><p>The TechStacks Desktop UI is then built around these 2 AutoQuery Services allowing querying against each field and utilizing a subset of the implicit conventions supported:</p><h3 id="querying-technology-stacks" tabindex="-1">Querying Technology Stacks <a class="header-anchor" href="#querying-technology-stacks" aria-hidden="true">#</a></h3><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/techstacks-desktop-field.png" alt="TechStack Desktop Search Fields"></p><h3 id="querying-technologies" tabindex="-1">Querying Technologies <a class="header-anchor" href="#querying-technologies" aria-hidden="true">#</a></h3><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/techstacks-desktop-type.png" alt="TechStack Desktop Search Type"></p><p>Like the TechStacks iOS App all Service Calls are maintained in a single <a href="https://github.com/ServiceStackApps/TechStacksDesktopApp/blob/master/src/TechStacksDesktop/AppData.swift" target="_blank" rel="noopener noreferrer">AppData.swift</a> class and uses KVO bindings to update its UI which is populated from these 2 services below:</p><div class="language-swift"><pre><code><span class="token keyword">func</span> <span class="token function-definition function">searchTechStacks</span><span class="token punctuation">(</span>query<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> field<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token nil constant">nil</span><span class="token punctuation">,</span> operand<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span>
  <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">QueryResponse</span><span class="token operator">&lt;</span><span class="token class-name">TechnologyStack</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>search <span class="token operator">=</span> query
    
    <span class="token keyword">let</span> queryString <span class="token operator">=</span> query<span class="token punctuation">.</span>count <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> field <span class="token operator">!=</span> <span class="token nil constant">nil</span> <span class="token operator">&amp;&amp;</span> operand <span class="token operator">!=</span> <span class="token nil constant">nil</span>
        <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token function">createAutoQueryParam</span><span class="token punctuation">(</span>field<span class="token operator">!</span><span class="token punctuation">,</span> operand<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span> query<span class="token punctuation">]</span>
        <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;NameContains&quot;</span></span><span class="token punctuation">:</span>query<span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;DescriptionContains&quot;</span></span><span class="token punctuation">:</span>query<span class="token punctuation">]</span>
    
    <span class="token keyword">let</span> request <span class="token operator">=</span> <span class="token class-name">FindTechStacks</span><span class="token operator">&lt;</span><span class="token class-name">TechnologyStack</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> client<span class="token punctuation">.</span><span class="token function">getAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> query<span class="token punctuation">:</span>queryString<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>done <span class="token punctuation">{</span> <span class="token punctuation">(</span>r<span class="token punctuation">:</span><span class="token class-name">QueryResponse</span><span class="token operator">&lt;</span><span class="token class-name">TechnologyStack</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">QueryResponse</span><span class="token operator">&lt;</span><span class="token class-name">TechnologyStack</span><span class="token operator">&gt;</span> <span class="token keyword">in</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>filteredTechStacks <span class="token operator">=</span> r<span class="token punctuation">.</span>results
            <span class="token keyword">return</span> r
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function-definition function">searchTechnologies</span><span class="token punctuation">(</span>query<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> field<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token nil constant">nil</span><span class="token punctuation">,</span> operand<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token nil constant">nil</span><span class="token punctuation">)</span>
  <span class="token operator">-&gt;</span> <span class="token class-name">Promise</span><span class="token operator">&lt;</span><span class="token class-name">QueryResponse</span><span class="token operator">&lt;</span><span class="token class-name">Technology</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>search <span class="token operator">=</span> query

    <span class="token keyword">let</span> queryString <span class="token operator">=</span> query<span class="token punctuation">.</span>count <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> field <span class="token operator">!=</span> <span class="token nil constant">nil</span> <span class="token operator">&amp;&amp;</span> operand <span class="token operator">!=</span> <span class="token nil constant">nil</span>
        <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token function">createAutoQueryParam</span><span class="token punctuation">(</span>field<span class="token operator">!</span><span class="token punctuation">,</span> operand<span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span> query<span class="token punctuation">]</span>
        <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;NameContains&quot;</span></span><span class="token punctuation">:</span>query<span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;DescriptionContains&quot;</span></span><span class="token punctuation">:</span>query<span class="token punctuation">]</span>
    
    <span class="token keyword">let</span> request <span class="token operator">=</span> <span class="token class-name">FindTechnologies</span><span class="token operator">&lt;</span><span class="token class-name">Technology</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> client<span class="token punctuation">.</span><span class="token function">getAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> query<span class="token punctuation">:</span>queryString<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>done <span class="token punctuation">{</span> <span class="token punctuation">(</span>r<span class="token punctuation">:</span><span class="token class-name">QueryResponse</span><span class="token operator">&lt;</span><span class="token class-name">Technology</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">QueryResponse</span><span class="token operator">&lt;</span><span class="token class-name">Technology</span><span class="token operator">&gt;</span> <span class="token keyword">in</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>filteredTechnologies <span class="token operator">=</span> r<span class="token punctuation">.</span>results
            <span class="token keyword">return</span> r
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function-definition function">createAutoQueryParam</span><span class="token punctuation">(</span>field<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token omit keyword">_</span> operand<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> template <span class="token operator">=</span> autoQueryOperandsMap<span class="token punctuation">[</span>operand<span class="token punctuation">]</span><span class="token operator">!</span>
    <span class="token keyword">let</span> mergedField <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;%&quot;</span></span><span class="token punctuation">,</span> withString<span class="token punctuation">:</span>field<span class="token punctuation">)</span>
    <span class="token keyword">return</span> mergedField
<span class="token punctuation">}</span>
</code></pre></div><p>Essentially employing the same strategy for both AutoQuery Services where it builds a query String parameter to send with the request. For incomplete queries, the default search queries both <code>NameContains</code> and <code>DescriptionContains</code> field conventions returning results where the Search Text is either in <code>Name</code> <strong>OR</strong> <code>Description</code> fields.</p><h3 id="techstacks-console-app" tabindex="-1"><a href="https://github.com/ServiceStackApps/swift-techstacks-console" target="_blank" rel="noopener noreferrer">TechStacks Console App</a> <a class="header-anchor" href="#techstacks-console-app" aria-hidden="true">#</a></h3><p>In its quest to become a popular mainstream language, Swift includes a built-in Package Manager to simplify the maintenance, distribution and building of Swift code. Swift Package Manager can be used to build native statically-linked modules or Console Apps but currently has no support for iOS, watchOS, or tvOS platforms.</p><p>Nevertheless it&#39;s simple console and text-based programming model provides a great way to quickly develop prototypes or Console-based Swift Apps like <a href="https://github.com/ServiceStack/swiftref" target="_blank" rel="noopener noreferrer">swiftref</a> using your favorite text editor. To support this environment we&#39;ve packaged ServiceStack&#39;s Swift Service clients into a <strong>ServiceStackClient</strong> package so it can be easily referenced in Swift PM projects.</p><p>Together with <strong>Swift Add ServiceStack Reference</strong> we now have a productive development workflow for building statically-linked native executables that consume Typed ServiceStack Services as seen in the new step-by-step guide below showing how to create a simple <a href="https://github.com/ServiceStackApps/swift-techstacks-console" target="_blank" rel="noopener noreferrer">Swift TechStacks Console App</a>.</p><h2 id="swift-generated-dto-types" tabindex="-1">Swift Generated DTO Types <a class="header-anchor" href="#swift-generated-dto-types" aria-hidden="true">#</a></h2><p>With Swift support our goal was to ensure a high-fidelity, idiomatic translation within the constraints of Swift language and built-in libraries, where the .NET Server DTO&#39;s are translated into clean Swift POSO&#39;s (Plain Old Swift Objects \u{1F603} having their .NET built-in types mapped to their equivalent Swift data type.</p><p>To see what this ended up looking like, we&#39;ll peel back behind the covers and look at a couple of the <a href="http://test.servicestack.net/types/swift" target="_blank" rel="noopener noreferrer">Generated Swift Test Models</a> to see how they&#39;re translated in Swift:</p><div class="language-swift"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AllTypes</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token keyword">public</span> <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> id<span class="token punctuation">:</span><span class="token class-name">Int</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> nullableId<span class="token punctuation">:</span><span class="token class-name">Int</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> byte<span class="token punctuation">:</span><span class="token class-name">Int8</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> short<span class="token punctuation">:</span><span class="token class-name">Int16</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> int<span class="token punctuation">:</span><span class="token class-name">Int</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> long<span class="token punctuation">:</span><span class="token class-name">Int64</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> uShort<span class="token punctuation">:</span><span class="token class-name">UInt16</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> uInt<span class="token punctuation">:</span><span class="token class-name">UInt32</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> uLong<span class="token punctuation">:</span><span class="token class-name">UInt64</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> float<span class="token punctuation">:</span><span class="token class-name">Float</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> double<span class="token punctuation">:</span><span class="token class-name">Double</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> decimal<span class="token punctuation">:</span><span class="token class-name">Double</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> string<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> dateTime<span class="token punctuation">:</span><span class="token class-name">NSDate</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> timeSpan<span class="token punctuation">:</span><span class="token class-name">NSTimeInterval</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> dateTimeOffset<span class="token punctuation">:</span><span class="token class-name">NSDate</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> guid<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> char<span class="token punctuation">:</span><span class="token class-name">Character</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> nullableDateTime<span class="token punctuation">:</span><span class="token class-name">NSDate</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> nullableTimeSpan<span class="token punctuation">:</span><span class="token class-name">NSTimeInterval</span><span class="token operator">?</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> stringList<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> stringArray<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> stringMap<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> intStringMap<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> subType<span class="token punctuation">:</span><span class="token class-name">SubType</span><span class="token operator">?</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AllCollectionTypes</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token keyword">public</span> <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> intArray<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> intList<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> stringArray<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> stringList<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> pocoArray<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">Poco</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> pocoList<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">Poco</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> pocoLookup<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">Poco</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">var</span> pocoLookupMap<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span><span class="token class-name">Poco</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">EnumType</span> <span class="token punctuation">:</span> <span class="token class-name">Int</span>
<span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token class-name">Value1</span>
    <span class="token keyword">case</span> <span class="token class-name">Value2</span>
<span class="token punctuation">}</span>
</code></pre></div><p>As seen above, properties are essentially mapped to their optimal Swift equivalent. As DTO&#39;s can be partially complete all properties are <code>Optional</code> except for enumerables which default to an empty collection - making them easier to work with and despite their semantic differences, .NET enums are translated into typed Swift enums.</p><h3 id="swift-code-generation" tabindex="-1">Swift Code Generation <a class="header-anchor" href="#swift-code-generation" aria-hidden="true">#</a></h3><p>As we were already using code-gen to generate the Swift types we could extend it without impacting the Developer UX has been expanded to also include what&#39;s essentially an <strong>explicit Reflection API</strong> for each type with API&#39;s to support serializing to and from JSON. Thanks to Swift&#39;s rich support for extending types we were able to leverage its Type extensions so the implementation details could remain disconnected from the clean Swift type definitions allowing improved readability when inspecting the remote DTO schema&#39;s.</p><p>We can look at <code>AllCollectionTypes</code> to see an example of the code-gen that&#39;s generated for each type, essentially emitting explicit readable/writable closures for each property:</p><div class="language-swift"><pre><code><span class="token keyword">extension</span> <span class="token class-name">AllCollectionTypes</span> <span class="token punctuation">:</span> <span class="token class-name">JsonSerializable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> typeName<span class="token punctuation">:</span><span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string-literal"><span class="token string">&quot;AllCollectionTypes&quot;</span></span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">var</span> metadata <span class="token operator">=</span> <span class="token class-name">Metadata</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token keyword">Type</span><span class="token operator">&lt;</span><span class="token class-name">AllCollectionTypes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">arrayProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;intArray&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>intArray <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>intArray <span class="token operator">=</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">Type</span><span class="token operator">&lt;</span><span class="token class-name">AllCollectionTypes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">arrayProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;intList&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>intList <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>intList <span class="token operator">=</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">Type</span><span class="token operator">&lt;</span><span class="token class-name">AllCollectionTypes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">arrayProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;stringArray&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>stringArray <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>stringArray <span class="token operator">=</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">Type</span><span class="token operator">&lt;</span><span class="token class-name">AllCollectionTypes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">arrayProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;stringList&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>stringList <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>stringList <span class="token operator">=</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">Type</span><span class="token operator">&lt;</span><span class="token class-name">AllCollectionTypes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">arrayProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;pocoArray&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>pocoArray <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>pocoArray <span class="token operator">=</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">Type</span><span class="token operator">&lt;</span><span class="token class-name">AllCollectionTypes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">arrayProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;pocoList&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>pocoList <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>pocoList <span class="token operator">=</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">Type</span><span class="token operator">&lt;</span><span class="token class-name">AllCollectionTypes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">objectProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;pocoLookup&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>pocoLookup <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>pocoLookup <span class="token operator">=</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">Type</span><span class="token operator">&lt;</span><span class="token class-name">AllCollectionTypes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">objectProperty</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;pocoLookupMap&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>pocoLookupMap <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>pocoLookupMap <span class="token operator">=</span> <span class="token short-argument">$1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="swift-native-types-limitations" tabindex="-1">Swift Native Types Limitations <a class="header-anchor" href="#swift-native-types-limitations" aria-hidden="true">#</a></h3><p>Due to the semantic differences and limitations in Swift there are some limitations of what&#39;s not supported. Luckily these limitations are mostly <a href="http://stackoverflow.com/a/10759250/85785" target="_blank" rel="noopener noreferrer">highly-discouraged bad practices</a> which is another reason not to use them. Specifically what&#39;s not supported:</p><h4 id="no-object-or-interface-properties" tabindex="-1">No <code>object</code> or <code>Interface</code> properties <a class="header-anchor" href="#no-object-or-interface-properties" aria-hidden="true">#</a></h4><p>When emitting code we&#39;ll generate a comment when ignoring these properties, e.g:</p><div class="language-swift"><pre><code><span class="token comment">//emptyInterface:IEmptyInterface ignored. Swift doesn&#39;t support interface properties</span>
</code></pre></div><h4 id="base-types-must-be-marked-abstract" tabindex="-1">Base types must be marked abstract <a class="header-anchor" href="#base-types-must-be-marked-abstract" aria-hidden="true">#</a></h4><p>As Swift doesn&#39;t support extension inheritance, when using inheritance in DTO&#39;s any Base types must be marked abstract.</p><h4 id="all-dto-type-names-must-be-unique" tabindex="-1">All DTO Type Names must be unique <a class="header-anchor" href="#all-dto-type-names-must-be-unique" aria-hidden="true">#</a></h4><p>Required as there are no namespaces in Swift (Also required for F# and TypeScript). ServiceStack only requires Request DTO&#39;s to be unique, but our recommendation is for all DTO names to be unique.</p><h4 id="ireturn-not-added-for-array-responses" tabindex="-1">IReturn not added for Array Responses <a class="header-anchor" href="#ireturn-not-added-for-array-responses" aria-hidden="true">#</a></h4><p>As Swift doesn&#39;t allow extending generic Arrays with public protocols, the <code>IReturn</code> marker that enables the typed ServiceClient API isn&#39;t available for Requests returning Array responses. You can workaround this limitation by wrapping the array in a Response DTO whilst we look at other solutions to support this in future.</p>__VP_STATIC_END__`,234),o=[p];function c(l,i,r,u,k,d){return a(),s("div",null,o)}var m=n(t,[["render",c]]);export{g as __pageData,m as default};
