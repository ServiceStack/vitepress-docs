import{_ as t,c as e,o as p,a as s,b as n,e as a}from"./app.14440598.js";const S=`{"title":"JSON Format","description":"","frontmatter":{"title":"JSON Format"},"headers":[{"level":3,"title":"Try out ServiceStack.Text Live","slug":"try-out-servicestack-text-live"},{"level":2,"title":"Install ServiceStack.Text","slug":"install-servicestack-text"},{"level":2,"title":"Simple API","slug":"simple-api"},{"level":3,"title":"Convenience Serialization Extension Methods","slug":"convenience-serialization-extension-methods"},{"level":3,"title":"Typed JSON","slug":"typed-json"},{"level":3,"title":"Dynamic JSON parsing API","slug":"dynamic-json-parsing-api"},{"level":3,"title":"Supports Dynamic JSON","slug":"supports-dynamic-json"},{"level":3,"title":"JS Utils","slug":"js-utils"},{"level":3,"title":"Pretty Print JSON","slug":"pretty-print-json"},{"level":2,"title":"ServiceStack's JsonSerializer","slug":"servicestack-s-jsonserializer"},{"level":3,"title":"Serialization API","slug":"serialization-api"},{"level":3,"title":"Deserialization API","slug":"deserialization-api"},{"level":3,"title":"Extension methods","slug":"extension-methods"},{"level":2,"title":"JSON Format","slug":"json-format"},{"level":3,"title":"number, true, false types","slug":"number-true-false-types"},{"level":3,"title":"null type","slug":"null-type"},{"level":3,"title":"string type","slug":"string-type"},{"level":3,"title":"C# Structs and Value Types","slug":"c-structs-and-value-types"},{"level":3,"title":"array type","slug":"array-type"},{"level":3,"title":"object type","slug":"object-type"},{"level":3,"title":"Parsing JSON Dates","slug":"parsing-json-dates"},{"level":2,"title":"Global Default JSON Configuration","slug":"global-default-json-configuration"},{"level":3,"title":"DateHandler (dh)","slug":"datehandler-dh"},{"level":3,"title":"TimeSpanHandler (tsh)","slug":"timespanhandler-tsh"},{"level":3,"title":"TextCase (tc)","slug":"textcase-tc"},{"level":3,"title":"PropertyConvention (pc)","slug":"propertyconvention-pc"},{"level":3,"title":"Custom Config Scopes","slug":"custom-config-scopes"},{"level":3,"title":"Type Configuration","slug":"type-configuration"},{"level":2,"title":"Strict Parsing","slug":"strict-parsing"},{"level":2,"title":"Custom Serialization","slug":"custom-serialization"},{"level":3,"title":"Using Structs to Customize JSON","slug":"using-structs-to-customize-json"},{"level":3,"title":"Using Custom IEnumerable class to serialize a JSON array","slug":"using-custom-ienumerable-class-to-serialize-a-json-array"},{"level":2,"title":"Custom Deserialization","slug":"custom-deserialization"},{"level":2,"title":"Late-bound Object and Interface Runtime Types","slug":"late-bound-object-and-interface-runtime-types"},{"level":3,"title":"Runtime Type Whitelist","slug":"runtime-type-whitelist"},{"level":3,"title":"Custom Enum Serialization","slug":"custom-enum-serialization"}],"relativePath":"json-format.md","lastUpdated":1634495308422}`,o={},c=s('<p><a href="https://github.com/ServiceStack/ServiceStack.Text" target="_blank" rel="noopener noreferrer">ServiceStack.Text</a> is an <strong>independent, dependency-free</strong> serialization library containing ServiceStack&#39;s core high-performance utils and text processing functionality, including its premier support for JSON.</p><h3 id="try-out-servicestack-text-live" tabindex="-1">Try out <a href="https://gist.cafe/c71b3f0123b3d9d08c1b11c98c2ff379" target="_blank" rel="noopener noreferrer">ServiceStack.Text Live</a> <a class="header-anchor" href="#try-out-servicestack-text-live" aria-hidden="true">#</a></h3><p>A great way to try out ServiceStack.Text is on <a href="https://gist.cafe" target="_blank" rel="noopener noreferrer">gist.cafe</a> which lets you immediately run and explore all ServiceStack.Text features from the comfort of your browser with zero software install:</p>',3),i=n("iframe",{src:"https://gist.cafe/embed?gist=c71b3f0123b3d9d08c1b11c98c2ff379",frameborder:"0",style:{height:"750px",width:"100%",border:"1px solid #ddd"}},null,-1),l=n("h2",{id:"install-servicestack-text",tabindex:"-1"},[a("Install ServiceStack.Text "),n("a",{class:"header-anchor",href:"#install-servicestack-text","aria-hidden":"true"},"#")],-1),r=n("div",{class:"package-reference-box"},[n("div",{class:"flex"},[n("div",{class:"flex-grow pre-container",style:{background:"#002440"}},[n("pre",{class:"sh copy m-0 p-0 pl-2 py-1 align-middle",style:{background:"#002440"}},[n("p",null,[n("code",null,'<PackageReference Include="ServiceStack.Text" Version="5.*" />')]),a(`
`)])]),n("div",{class:"flex-shrink"},[n("i",{class:"svg-copy inline-block w-8 h-full",title:"copy",onclick:"copy(this)"}),n("b")])]),n("div",{class:"copy-text w-full text-right h-6"})],-1),u=s(`<h2 id="simple-api" tabindex="-1">Simple API <a class="header-anchor" href="#simple-api" aria-hidden="true">#</a></h2><p>Like most of the interfaces in ServiceStack, the API is simple. Methods that you would commonly use include:</p><h3 id="convenience-serialization-extension-methods" tabindex="-1">Convenience Serialization Extension Methods <a class="header-anchor" href="#convenience-serialization-extension-methods" aria-hidden="true">#</a></h3><div class="language-csharp"><pre><code><span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToJson</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span>
<span class="token return-type class-name">T</span> <span class="token function">FromJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToJsv</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span>
<span class="token return-type class-name">T</span> <span class="token function">FromJsv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToCsv</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span>
<span class="token return-type class-name">T</span> <span class="token function">FromCsv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToXml</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span>
<span class="token return-type class-name">T</span> <span class="token function">FromXml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="typed-json" tabindex="-1">Typed JSON <a class="header-anchor" href="#typed-json" aria-hidden="true">#</a></h3><div class="language-csharp"><pre><code><span class="token return-type class-name"><span class="token keyword">string</span></span> JsonSerializer<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SerializeToString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">T</span> <span class="token keyword">value</span><span class="token punctuation">)</span>
<span class="token return-type class-name"><span class="token keyword">void</span></span> JsonSerializer<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">SerializeToWriter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">T</span> <span class="token keyword">value</span><span class="token punctuation">,</span> <span class="token class-name">TextWriter</span> writer<span class="token punctuation">)</span>

<span class="token return-type class-name">T</span> JsonSerializer<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DeserializeFromString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>
<span class="token return-type class-name">T</span> JsonSerializer<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DeserializeFromReader</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">TextReader</span> reader<span class="token punctuation">)</span>
</code></pre></div><p>Where <em>T</em> can be any .NET POCO type. That&#39;s all there is - the API was intentionally left simple \u{1F603}</p><h3 id="dynamic-json-parsing-api" tabindex="-1">Dynamic JSON parsing API <a class="header-anchor" href="#dynamic-json-parsing-api" aria-hidden="true">#</a></h3><div class="language-csharp"><pre><code>JsonObject<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
JsonArrayObjects<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="supports-dynamic-json" tabindex="-1">Supports Dynamic JSON <a class="header-anchor" href="#supports-dynamic-json" aria-hidden="true">#</a></h3><p>Although usually used to (de)serialize C#/.NET POCO types, it also includes a flexible API allowing you to deserialize any JSON payload without it&#39;s concrete type, see these real-world examples:</p><ul><li><a href="https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/UseCases/GithubV3ApiTests.cs" target="_blank" rel="noopener noreferrer">Parsing GitHub&#39;s v3 API with typed DTOs</a></li><li><a href="https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/UseCases/GitHubRestTests.cs" target="_blank" rel="noopener noreferrer">Parsing GitHub&#39;s JSON response</a></li><li><a href="https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/UseCases/GMapDirectionsTests.cs" target="_blank" rel="noopener noreferrer">Parsing Google Maps JSON Response</a></li><li><a href="https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/UseCases/CentroidTests.cs" target="_blank" rel="noopener noreferrer">Parsing Centroid</a></li></ul><p>Also a thin <strong>.NET 4.0 Dynamic JSON</strong> wrapper around ServiceStack&#39;s JSON library is included in the <a href="https://github.com/ServiceStack/ServiceStack.Text/blob/master/src/ServiceStack.Text/Pcl.Dynamic.cs" target="_blank" rel="noopener noreferrer">ServiceStack.Razor</a> project. It provides a dynamic, but more succinct API than the above options.</p><h3 id="js-utils" tabindex="-1">JS Utils <a class="header-anchor" href="#js-utils" aria-hidden="true">#</a></h3><p>ServiceStack.Text APIs for deserializing arbitrary JSON requires specifying the Type to deserialize into. An alternative flexible approach to read any arbitrary JavaScript or JSON data structures is to use the high-performance and memory efficient JSON utils in <a href="https://sharpscript.net/" target="_blank" rel="noopener noreferrer">#Script</a> implementation of JavaScript.</p><div class="language-csharp"><pre><code>JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span>       <span class="token comment">//= int 1 </span>
JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span>     <span class="token comment">//= double 1.1</span>
JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;&#39;a&#39;&quot;</span><span class="token punctuation">)</span>     <span class="token comment">//= string &quot;a&quot;</span>
JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;{a:1}&quot;</span><span class="token punctuation">)</span>   <span class="token comment">//= new Dictionary&lt;string, object&gt; { {&quot;a&quot;, 1 } }</span>
JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;[{a:1}]&quot;</span><span class="token punctuation">)</span> <span class="token comment">//= new List&lt;object&gt; { new Dictionary&lt;string, object&gt; { { &quot;a&quot;, 1 } } }</span>
</code></pre></div><h4 id="eval" tabindex="-1">Eval <a class="header-anchor" href="#eval" aria-hidden="true">#</a></h4><p>Since JS Utils is an essential part of <a href="https://sharpscript.net/" target="_blank" rel="noopener noreferrer">#Script</a> it allows for advanced scenarios like implementing a text DSL or scripting language for executing custom logic or business rules you want to be able to change without having to compile or redeploy your App. It uses <a href="https://sharpscript.net/docs/methods" target="_blank" rel="noopener noreferrer">#Script Context</a> which lets you evaluate the script within a custom scope that defines what functions and arguments it has access to, e.g.:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomMethods</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptMethods</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> text<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">Reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name"><span class="token keyword">var</span></span> scope <span class="token operator">=</span> JS<span class="token punctuation">.</span><span class="token function">CreateScope</span><span class="token punctuation">(</span>
         <span class="token named-parameter punctuation">args</span><span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token punctuation">{</span> <span class="token string">&quot;arg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token named-parameter punctuation">functions</span><span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CustomMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

JS<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;arg&quot;</span><span class="token punctuation">,</span> scope<span class="token punctuation">)</span>                                        <span class="token comment">//= &quot;value&quot;</span>
JS<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;reverse(arg)&quot;</span><span class="token punctuation">,</span> scope<span class="token punctuation">)</span>                               <span class="token comment">//= &quot;eulav&quot;</span>
JS<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;3.itemsOf(arg.reverse().padRight(8, &#39;_&#39;))&quot;</span><span class="token punctuation">,</span> scope<span class="token punctuation">)</span> <span class="token comment">//= [&quot;eulav___&quot;, &quot;eulav___&quot;, &quot;eulav___&quot;]</span>

<span class="token comment">//= { a: [&quot;eulav___&quot;, &quot;eulav___&quot;, &quot;eulav___&quot;] }</span>
JS<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;{a: 3.itemsOf(arg.reverse().padRight(8, &#39;_&#39;)) }&quot;</span><span class="token punctuation">,</span> scope<span class="token punctuation">)</span>
</code></pre></div><p>ServiceStack&#39;s JS Utils is available in the <a href="https://www.nuget.org/packages/ServiceStack.Common" target="_blank" rel="noopener noreferrer">ServiceStack.Common</a> NuGet package.</p><h3 id="pretty-print-json" tabindex="-1">Pretty Print JSON <a class="header-anchor" href="#pretty-print-json" aria-hidden="true">#</a></h3><p>You can format JSON into a more readable format with the <code>IndentJson()</code> extension method, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> prettyJson <span class="token operator">=</span> dto<span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">IndentJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="servicestack-s-jsonserializer" tabindex="-1">ServiceStack&#39;s JsonSerializer <a class="header-anchor" href="#servicestack-s-jsonserializer" aria-hidden="true">#</a></h2><p>ServiceStack&#39;s JsonSerializer is optimized for serializing C# POCO types in and out of JSON as fast, compact and cleanly as possible. In most cases C# objects serializes as you would expect them to without added json extensions or serializer-specific artefacts.</p><p>JsonSerializer provides a simple API that allows you to serialize any .NET generic or runtime type into a string, TextWriter/TextReader or Stream.</p><h3 id="serialization-api" tabindex="-1">Serialization API <a class="header-anchor" href="#serialization-api" aria-hidden="true">#</a></h3><div class="language-csharp"><pre><code><span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">SerializeToString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>T<span class="token punctuation">)</span>
<span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token generic-method"><span class="token function">SerializeToWriter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> TextWriter<span class="token punctuation">)</span>
<span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token generic-method"><span class="token function">SerializeToStream</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> Stream<span class="token punctuation">)</span>
<span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">SerializeToString</span><span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">,</span> Type<span class="token punctuation">)</span>
<span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SerializeToWriter</span><span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">,</span> Type<span class="token punctuation">,</span> TextWriter<span class="token punctuation">)</span>
<span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SerializeToStream</span><span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">,</span> Type<span class="token punctuation">,</span> Stream<span class="token punctuation">)</span>
</code></pre></div><h3 id="deserialization-api" tabindex="-1">Deserialization API <a class="header-anchor" href="#deserialization-api" aria-hidden="true">#</a></h3><div class="language-csharp"><pre><code><span class="token return-type class-name">T</span> <span class="token generic-method"><span class="token function">DeserializeFromString</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">)</span>
<span class="token return-type class-name">T</span> <span class="token generic-method"><span class="token function">DeserializeFromReader</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>TextReader<span class="token punctuation">)</span>
<span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">DeserializeFromString</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">,</span> Type<span class="token punctuation">)</span>
<span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">DeserializeFromReader</span><span class="token punctuation">(</span>reader<span class="token punctuation">,</span> Type<span class="token punctuation">)</span>
<span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">DeserializeFromStream</span><span class="token punctuation">(</span>Type<span class="token punctuation">,</span> Stream<span class="token punctuation">)</span>
<span class="token return-type class-name">T</span> <span class="token generic-method"><span class="token function">DeserializeFromStream</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>Stream<span class="token punctuation">)</span>
</code></pre></div><h3 id="extension-methods" tabindex="-1">Extension methods <a class="header-anchor" href="#extension-methods" aria-hidden="true">#</a></h3><div class="language-csharp"><pre><code><span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token generic-method"><span class="token function">ToJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> T<span class="token punctuation">)</span>
<span class="token return-type class-name">T</span> <span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">string</span><span class="token punctuation">)</span>
</code></pre></div><p>Convenient <strong>ToJson/FromJson</strong> extension methods are also included reducing the amount of code required, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">new</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//= [1,2,3]</span>
<span class="token string">&quot;[1,2,3]&quot;</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//= int []{ 1, 2, 3 }</span>
</code></pre></div><h2 id="json-format" tabindex="-1">JSON Format <a class="header-anchor" href="#json-format" aria-hidden="true">#</a></h2><p>JSON is a lightweight text serialization format with a spec that&#39;s so simple that it fits on one page: <a href="https://www.json.org" target="_blank" rel="noopener noreferrer">https://www.json.org</a>.</p><p>The only valid values in JSON are:</p><ul><li>string</li><li>number</li><li>object</li><li>array</li><li>true</li><li>false</li><li>null</li></ul><p>Where most allowed values are scalar and the only complex types available are objects and arrays. Although limited, the above set of types make a good fit and can express most programming data structures.</p><h3 id="number-true-false-types" tabindex="-1">number, true, false types <a class="header-anchor" href="#number-true-false-types" aria-hidden="true">#</a></h3><p>All C# boolean and numeric data types are stored as-is without quotes.</p><h3 id="null-type" tabindex="-1">null type <a class="header-anchor" href="#null-type" aria-hidden="true">#</a></h3><p>For the most compact output null values are omitted from the serialized by default. If you want to include null values set the global configuration:</p><div class="language-csharp"><pre><code>JsConfig<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Config</span> <span class="token punctuation">{</span> IncludeNullValues <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="string-type" tabindex="-1">string type <a class="header-anchor" href="#string-type" aria-hidden="true">#</a></h3><p>All other scalar values are stored as strings that are surrounded with double quotes.</p><h3 id="c-structs-and-value-types" tabindex="-1">C# Structs and Value Types <a class="header-anchor" href="#c-structs-and-value-types" aria-hidden="true">#</a></h3><p>Because a C# struct is a value type whose public properties are normally just convenience properties around a single scalar value, they are ignored instead the <strong>TStruct.ToString()</strong> method is used to serialize and either the <strong>static TStruct.Parse()</strong> method or <strong>new TStruct(string)</strong> constructor will be used to deserialize the value type if it exists.</p><h3 id="array-type" tabindex="-1">array type <a class="header-anchor" href="#array-type" aria-hidden="true">#</a></h3><p>Any List, Queue, Stack, Array, Collection, Enumerables including custom enumerable types are stored in exactly the same way as a JavaScript array literal, i.e:</p><div class="language-json"><pre><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
</code></pre></div><p>All elements in an array must be of the same type. If a custom type is both an IEnumerable and has properties it will be treated as an array and the extra properties will be ignored.</p><h3 id="object-type" tabindex="-1">object type <a class="header-anchor" href="#object-type" aria-hidden="true">#</a></h3><p>The JSON object type is the most flexible and is how most complex .NET types are serialized. The JSON object type is a key-value pair JavaScript object literal where the key is always a double-quoted string.</p><p>Any IDictionary is serialized into a standard JSON object, i.e:</p><div class="language-json"><pre><code><span class="token punctuation">{</span><span class="token property">&quot;A&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;B&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token property">&quot;C&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;D&quot;</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">}</span>
</code></pre></div><p>Which happens to be the same as C# POCO types (inc. Interfaces) with the values:</p><div class="language-cs"><pre><code><span class="token keyword">new</span> <span class="token constructor-invocation class-name">MyClass</span> <span class="token punctuation">{</span> A<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> B<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> D<span class="token operator">=</span><span class="token number">4</span> <span class="token punctuation">}</span>
</code></pre></div><div class="language-json"><pre><code><span class="token punctuation">{</span><span class="token property">&quot;A&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;B&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token property">&quot;C&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;D&quot;</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">}</span>
</code></pre></div><p>Only public properties on reference types are serialized with the C# Property Name used for object key and the Property Value as the value. At the moment it is not possible to customize the Property Name.</p><p>JsonSerializer also supports serialization of anonymous types in much the same way:</p><div class="language-cs"><pre><code><span class="token keyword">new</span> <span class="token punctuation">{</span> A<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> B<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> D<span class="token operator">=</span><span class="token number">4</span> <span class="token punctuation">}</span>
</code></pre></div><div class="language-json"><pre><code><span class="token punctuation">{</span><span class="token property">&quot;A&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;B&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token property">&quot;C&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;D&quot;</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="parsing-json-dates" tabindex="-1">Parsing JSON Dates <a class="header-anchor" href="#parsing-json-dates" aria-hidden="true">#</a></h3><p>The default WCF Date that&#39;s returned in ServiceStack.Text can be converted with:</p><div class="language-js"><pre><code><span class="token keyword">function</span> <span class="token function">todate</span> <span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Date\\(([^)]+)\\)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Which if you&#39;re using the <a href="/servicestack-client-umd.html">servicestack-client</a> npm package can be resolved with:</p><div class="language-ts"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> todate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;servicestack-client&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token function">todate</span><span class="token punctuation">(</span>wcfDateString<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Or if using <a href="/ss-utils-js.html">ss-utils.js</a> that&#39;s built into ServiceStack:</p><div class="language-js"><pre><code><span class="token keyword">var</span> date <span class="token operator">=</span> $<span class="token punctuation">.</span>ss<span class="token punctuation">.</span><span class="token function">todate</span><span class="token punctuation">(</span>wcfDateString<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If you change ServiceStack.Text default serialization of Date to either use the ISO8601 date format:</p><div class="language-csharp"><pre><code>JsConfig<span class="token punctuation">.</span>DateHandler <span class="token operator">=</span> DateHandler<span class="token punctuation">.</span>ISO8601<span class="token punctuation">;</span>
</code></pre></div><p>It can be parsed natively with:</p><div class="language-js"><pre><code><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>dateString<span class="token punctuation">)</span>
</code></pre></div><p>Likewise when configured to return:</p><div class="language-csharp"><pre><code>JsConfig<span class="token punctuation">.</span>DateHandler <span class="token operator">=</span> DateHandler<span class="token punctuation">.</span>UnixTimeMs<span class="token punctuation">;</span>
</code></pre></div><p>It can also be converted natively with:</p><div class="language-js"><pre><code><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>unixTimeMs<span class="token punctuation">)</span>
</code></pre></div><h2 id="global-default-json-configuration" tabindex="-1">Global Default JSON Configuration <a class="header-anchor" href="#global-default-json-configuration" aria-hidden="true">#</a></h2><p>The JSON/JSV and CSV serialization can be customized globally by configuring the <code>JsConfig</code> or type-specific <code>JsConfig&lt;T&gt;</code> static classes with your preferred defaults. Global static configuration can be configured once on <strong>Startup</strong> using <code>JsConfig.Init()</code>, e.g:</p><div class="language-csharp"><pre><code>JsConfig<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Config</span> <span class="token punctuation">{</span>
    DateHandler <span class="token operator">=</span> DateHandler<span class="token punctuation">.</span>ISO8601<span class="token punctuation">,</span>
    AlwaysUseUtc <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    TextCase <span class="token operator">=</span> TextCase<span class="token punctuation">.</span>CamelCase<span class="token punctuation">,</span>
    ExcludeDefaultValues <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The following is a list of <code>bool</code> options you can use to configure many popular preferences:</p><table><thead><tr><th>Name</th><th>Alias</th></tr></thead><tr><td>IncludeNullValues</td><td>inv</td></tr><tr><td>IncludeNullValuesInDictionaries</td><td>invid</td></tr><tr><td>IncludeDefaultEnums</td><td>ide</td></tr><tr><td>IncludePublicFields</td><td>ipf</td></tr><tr><td>IncludeTypeInfo</td><td>iti</td></tr><tr><td>ExcludeTypeInfo</td><td>eti</td></tr><tr><td>ExcludeDefaultValues</td><td>edv</td></tr><tr><td>ConvertObjectTypesIntoStringDictionary</td><td>cotisd</td></tr><tr><td>TreatEnumAsInteger</td><td>teai</td></tr><tr><td>TryToParsePrimitiveTypeValues</td><td>ttpptv</td></tr><tr><td>TryToParseNumericType</td><td>ttpnt</td></tr><tr><td>ThrowOnDeserializationError</td><td>tode</td></tr><tr><td>EscapeUnicode</td><td>eu</td></tr><tr><td>EscapeHtmlChars</td><td>ehc</td></tr><tr><td>PreferInterfaces</td><td>pi</td></tr><tr><td>SkipDateTimeConversion</td><td>sdtc</td></tr><tr><td>AlwaysUseUtc</td><td>auu</td></tr><tr><td>AssumeUtc</td><td>au</td></tr><tr><td>AppendUtcOffset</td><td>auo</td></tr><tr><td>EscapeHtmlChars</td><td>ehc</td></tr><tr><td>EscapeUnicode</td><td>eu</td></tr><tr><td>EmitCamelCaseNames</td><td>eccn</td></tr><tr><td>EmitLowercaseUnderscoreNames</td><td>elun</td></tr></table><h3 id="datehandler-dh" tabindex="-1">DateHandler (dh) <a class="header-anchor" href="#datehandler-dh" aria-hidden="true">#</a></h3><table><tr><td>TimestampOffset</td><td>to</td></tr><tr><td>DCJSCompatible</td><td>dcjsc</td></tr><tr><td>ISO8601</td><td>iso8601</td></tr><tr><td>ISO8601DateOnly</td><td>iso8601do</td></tr><tr><td>ISO8601DateTime</td><td>iso8601dt</td></tr><tr><td>RFC1123</td><td>rfc1123</td></tr><tr><td>UnixTime</td><td>ut</td></tr><tr><td>UnixTimeMs</td><td>utm</td></tr></table><h3 id="timespanhandler-tsh" tabindex="-1">TimeSpanHandler (tsh) <a class="header-anchor" href="#timespanhandler-tsh" aria-hidden="true">#</a></h3><table><tr><td>DurationFormat</td><td>df</td></tr><tr><td>StandardFormat</td><td>sf</td></tr></table><h3 id="textcase-tc" tabindex="-1">TextCase (tc) <a class="header-anchor" href="#textcase-tc" aria-hidden="true">#</a></h3><table><tr><td>Default</td><td>d</td></tr><tr><td>PascalCase</td><td>pc</td></tr><tr><td>CamelCase</td><td>cc</td></tr><tr><td>SnakeCase</td><td>sc</td></tr></table><h3 id="propertyconvention-pc" tabindex="-1">PropertyConvention (pc) <a class="header-anchor" href="#propertyconvention-pc" aria-hidden="true">#</a></h3><table><tr><td>Strict</td><td>s</td></tr><tr><td>Lenient</td><td>l</td></tr></table><h3 id="custom-config-scopes" tabindex="-1">Custom Config Scopes <a class="header-anchor" href="#custom-config-scopes" aria-hidden="true">#</a></h3><p>If you need to use different serialization settings from the global static defaults you can use <code>JsConfig.With()</code> to create a scoped configuration using property initializers:</p><div class="language-csharp"><pre><code><span class="token keyword">using</span> <span class="token punctuation">(</span>JsConfig<span class="token punctuation">.</span><span class="token function">With</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Config</span> <span class="token punctuation">{</span> 
    TextCase <span class="token operator">==</span> TextCase<span class="token punctuation">.</span>CamelCase<span class="token punctuation">,</span> 
    PropertyConvention <span class="token operator">=</span> PropertyConvention<span class="token punctuation">.</span>Lenient
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> text<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="create-custom-scopes-using-string-config" tabindex="-1">Create Custom Scopes using String config <a class="header-anchor" href="#create-custom-scopes-using-string-config" aria-hidden="true">#</a></h4><p>You can also create a custom config scope from a string manually using <code>JsConfig.CreateScope()</code> where you can use the full config name or their aliases, e.g:</p><div class="language-csharp"><pre><code><span class="token keyword">using</span> <span class="token punctuation">(</span>JsConfig<span class="token punctuation">.</span><span class="token function">CreateScope</span><span class="token punctuation">(</span><span class="token string">&quot;IncludeNullValues,EDV,dh:ut&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> json <span class="token operator">=</span> dto<span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This feature is used to provide a number of different <a href="/customize-json-responses.html">JSON customizations in ServiceStack Services</a>.</p><h3 id="type-configuration" tabindex="-1">Type Configuration <a class="header-anchor" href="#type-configuration" aria-hidden="true">#</a></h3><p>If you can&#39;t change the definition of a Type (e.g. because its in the BCL), you can specify a custom serialization / deserialization routine to use instead. E.g. here&#39;s how you can add support for <code>System.Drawing.Color</code> and customize how <code>Guid</code> and <code>TimeSpan</code> Types are serialized:</p><div class="language-csharp"><pre><code>JsConfig<span class="token operator">&lt;</span>System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token operator">&gt;</span><span class="token punctuation">.</span>SerializeFn <span class="token operator">=</span> c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">&quot;Color &quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">&quot;[&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
JsConfig<span class="token operator">&lt;</span>System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token operator">&gt;</span><span class="token punctuation">.</span>DeSerializeFn <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>FromName<span class="token punctuation">;</span>

JsConfig<span class="token operator">&lt;</span>Guid<span class="token operator">&gt;</span><span class="token punctuation">.</span>SerializeFn <span class="token operator">=</span> guid <span class="token operator">=&gt;</span> guid<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
JsConfig<span class="token operator">&lt;</span>TimeSpan<span class="token operator">&gt;</span><span class="token punctuation">.</span>SerializeFn <span class="token operator">=</span> time <span class="token operator">=&gt;</span> 
    <span class="token punctuation">(</span>time<span class="token punctuation">.</span>Ticks <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">?</span> <span class="token string">&quot;-&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> time<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;hh&#39;:&#39;mm&#39;:&#39;ss&#39;.&#39;fffffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="strict-parsing" tabindex="-1">Strict Parsing <a class="header-anchor" href="#strict-parsing" aria-hidden="true">#</a></h2><p>By default ServiceStack Serializers will try to deserialize as much as possible without error, if you prefer you can opt-in to stricter parsing with:</p><div class="language-csharp"><pre><code>Env<span class="token punctuation">.</span>StrictMode <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre></div><p>Where it will instead fail fast and throw Exceptions on deserialization errors.</p><h2 id="custom-serialization" tabindex="-1">Custom Serialization <a class="header-anchor" href="#custom-serialization" aria-hidden="true">#</a></h2><p>Although JsonSerializer is optimized for serializing .NET POCO types, it still provides some options to change the convention-based serialization routine.</p><h3 id="using-structs-to-customize-json" tabindex="-1">Using Structs to Customize JSON <a class="header-anchor" href="#using-structs-to-customize-json" aria-hidden="true">#</a></h3><p>This makes it possible to customize the serialization routine and provide an even more compact wire format.</p><p>E.g. Instead of using a JSON object to represent a point</p><div class="language-cs"><pre><code><span class="token punctuation">{</span> Width<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> Height<span class="token operator">=</span><span class="token number">10</span> <span class="token punctuation">}</span>
</code></pre></div><p>You could use a struct and reduce it to just:</p><div class="language-cs"><pre><code><span class="token string">&quot;20x10&quot;</span>
</code></pre></div><p>By overriding <strong>ToString()</strong> and providing a static <strong>Size ParseJson()</strong> method:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">struct</span> <span class="token class-name">Size</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> Width <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> Height <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Width <span class="token operator">+</span> <span class="token string">&quot;x&quot;</span> <span class="token operator">+</span> Height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">Size</span> <span class="token function">ParseJson</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> json<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> size <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token string character">&#39;x&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span> <span class="token punctuation">{</span> 
            Width <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
            Height <span class="token operator">=</span> <span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Which would change it to the more compact JSON output:</p><div class="language-csharp"><pre><code>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span> <span class="token punctuation">{</span> Width <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> Height <span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// = &quot;20x10&quot;</span>
</code></pre></div><p>That allows you to deserialize it back in the same way:</p><div class="language-csharp"><pre><code>    <span class="token class-name"><span class="token keyword">var</span></span> size <span class="token operator">=</span> <span class="token string">&quot;20x10&quot;</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Size<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><h3 id="using-custom-ienumerable-class-to-serialize-a-json-array" tabindex="-1">Using Custom IEnumerable class to serialize a JSON array <a class="header-anchor" href="#using-custom-ienumerable-class-to-serialize-a-json-array" aria-hidden="true">#</a></h3><p>In addition to using a Struct you can optionally use a custom C# IEnumerable type to provide a strong-typed wrapper around a JSON array:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IEnumerable</span></span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> points <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">double</span></span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> X 
    <span class="token punctuation">{</span>
        <span class="token keyword">get</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> points<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">set</span> <span class="token punctuation">{</span> points<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> Y
    <span class="token punctuation">{</span>
        <span class="token keyword">get</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> points<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">set</span> <span class="token punctuation">{</span> points<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name">IEnumerator</span> <span class="token function">GetEnumerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> point <span class="token keyword">in</span> points<span class="token punctuation">)</span> 
            <span class="token keyword">yield</span> <span class="token keyword">return</span> point<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Which serializes the Point into a compact JSON array:</p><div class="language-csharp"><pre><code>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span> <span class="token punctuation">{</span> X <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Y <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// = [1,2]</span>
</code></pre></div><h2 id="custom-deserialization" tabindex="-1">Custom Deserialization <a class="header-anchor" href="#custom-deserialization" aria-hidden="true">#</a></h2><p>Because the same wire format shared between Dictionaries, POCOs and anonymous types, in most cases what you serialize with one type can be deserialized with another, i.e. an Anonymous type can be deserialized back into a Dictionary&lt;string,string&gt; which can be deserialized into a strong-typed POCO and vice-versa.</p><p>Although the JSON Serializer is best optimized for serializing and deserializing .NET types, it&#39;s flexible enough to consume 3rd party JSON apis although this generally requires custom de-serialization to convert it into an idiomatic .NET type.</p><p><a href="https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/UseCases/GitHubRestTests.cs" target="_blank" rel="noopener noreferrer">GitHubRestTests.cs</a></p><ol><li>Using <a href="https://github.com/ServiceStack/ServiceStack.Text/blob/master/src/ServiceStack.Text/JsonObject.cs" target="_blank" rel="noopener noreferrer">JsonObject</a></li><li>Using Generic .NET Collection classes</li><li>Using Customized DTO&#39;s in the shape of the 3rd party JSON response</li></ol><p><a href="https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/UseCases/CentroidTests.cs" target="_blank" rel="noopener noreferrer">CentroidTests</a> is another example that uses the JsonObject to parse a complex custom JSON response.</p><h2 id="late-bound-object-and-interface-runtime-types" tabindex="-1">Late-bound Object and Interface Runtime Types <a class="header-anchor" href="#late-bound-object-and-interface-runtime-types" aria-hidden="true">#</a></h2><p>In order to be able to deserialize late-bound objects like <code>object</code>, <code>interface</code> properties or <code>abstract</code> classes ServiceStack needs to emit type information in the JSON payload. By default it uses <code>__type</code> property name, but can be customized with:</p><div class="language-csharp"><pre><code>JsConfig<span class="token punctuation">.</span>TypeAttr <span class="token operator">=</span> <span class="token string">&quot;$type&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>You can also configure what Type Information is emitted with:</p><div class="language-csharp"><pre><code>JsConfig<span class="token punctuation">.</span>TypeWriter <span class="token operator">=</span> type <span class="token operator">=&gt;</span> type<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
</code></pre></div><p>Which will just emit the name of the Type (e.g <code>Dog</code>) instead of the full Type Name.</p><p>By default ServiceStack will scan all loaded Assemblies to find the Type, but you can tell it to use your own Type Resolver implementation by overriding <code>TypeFinder</code>, e.g:</p><div class="language-csharp"><pre><code>JsConfig<span class="token punctuation">.</span>TypeFinder <span class="token operator">=</span> typeInfo <span class="token operator">=&gt;</span>  <span class="token operator">=&gt;</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> regex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Regex</span><span class="token punctuation">(</span><span class="token string">@&quot;^(?&lt;type&gt;[^:]+):#(?&lt;namespace&gt;.*)$&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> match <span class="token operator">=</span> regex<span class="token punctuation">.</span><span class="token function">Match</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> typeName <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">&quot;{0}.{1}&quot;</span><span class="token punctuation">,</span> match<span class="token punctuation">.</span>Groups<span class="token punctuation">[</span><span class="token string">&quot;namespace&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">,</span> match<span class="token punctuation">.</span>Groups<span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;+&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">MyFindType</span><span class="token punctuation">(</span>typeName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="runtime-type-whitelist" tabindex="-1">Runtime Type Whitelist <a class="header-anchor" href="#runtime-type-whitelist" aria-hidden="true">#</a></h3><p>ServiceStack only allows you to serialize &quot;known safe Types&quot; in late-bound properties which uses a whitelist that&#39;s pre-populated with a safe-list of popular Data Types, DTOs and Request DTOs with the default configuration below:</p><div class="language-csharp"><pre><code><span class="token comment">// Allow deserializing types with [DataContract] or [RuntimeSerializable] attributes</span>
JsConfig<span class="token punctuation">.</span>AllowRuntimeTypeWithAttributesNamed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HashSet<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">nameof</span><span class="token punctuation">(</span>DataContractAttribute<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">nameof</span><span class="token punctuation">(</span>RuntimeSerializableAttribute<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// new in ServiceStack.Text</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// Allow deserializing types implementing any of the interfaces below</span>
JsConfig<span class="token punctuation">.</span>AllowRuntimeTypeWithInterfacesNamed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HashSet<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;IConvertible&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;ISerializable&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;IRuntimeSerializable&quot;</span><span class="token punctuation">,</span> <span class="token comment">// new in ServiceStack.Text</span>
    <span class="token string">&quot;IMeta&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;IReturn\`1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;IReturnVoid&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// Allow object property in ServiceStack.Messaging MQ classes</span>
JsConfig<span class="token punctuation">.</span>AllowRuntimeTypeInTypesWithNamespaces <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HashSet<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;ServiceStack.Messaging&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The above rules can be extended to allow your own conventions. If you just need to allow a specific Type you can instead just implement:</p><div class="language-csharp"><pre><code>JsConfig<span class="token punctuation">.</span>AllowRuntimeType <span class="token operator">=</span> type <span class="token operator">=&gt;</span> type <span class="token operator">==</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyType</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If you\u2019re in a trusted intranet environment this can also be used to disable the whitelist completely by allowing all Types to be deserialized into object properties with:</p><div class="language-csharp"><pre><code>JsConfig<span class="token punctuation">.</span>AllowRuntimeType <span class="token operator">=</span> _ <span class="token operator">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="custom-enum-serialization" tabindex="-1">Custom Enum Serialization <a class="header-anchor" href="#custom-enum-serialization" aria-hidden="true">#</a></h3><p>You can use <code>[EnumMember]</code> to change what Enum value gets serialized, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DataContract</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Day</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EnumMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Value <span class="token operator">=</span> <span class="token string">&quot;MON&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    Monday<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EnumMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Value <span class="token operator">=</span> <span class="token string">&quot;TUE&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    Tuesday<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EnumMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Value <span class="token operator">=</span> <span class="token string">&quot;WED&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    Wednesday<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EnumMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Value <span class="token operator">=</span> <span class="token string">&quot;THU&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    Thursday<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EnumMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Value <span class="token operator">=</span> <span class="token string">&quot;FRI&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    Friday<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EnumMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Value <span class="token operator">=</span> <span class="token string">&quot;SAT&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    Saturday<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">EnumMember</span><span class="token attribute-arguments"><span class="token punctuation">(</span>Value <span class="token operator">=</span> <span class="token string">&quot;SUN&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    Sunday<span class="token punctuation">,</span>            
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">EnumMemberDto</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">Day</span> Day <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name"><span class="token keyword">var</span></span> dto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EnumMemberDto</span> <span class="token punctuation">{</span>Day <span class="token operator">=</span> Day<span class="token punctuation">.</span>Sunday<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> json <span class="token operator">=</span> dto<span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//= {&quot;Day&quot;:&quot;SUN&quot;}</span>

<span class="token class-name"><span class="token keyword">var</span></span> fromDto <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>EnumMemberDto<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fromDto<span class="token punctuation">.</span>Day               <span class="token comment">//= Day.Sunday</span>
</code></pre></div>`,148),k=[c,i,l,r,u];function d(m,h,g,y,f,b){return p(),e("div",null,k)}var w=t(o,[["render",d]]);export{S as __pageData,w as default};
