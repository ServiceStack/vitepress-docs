import{_ as n,c as s,o as a,a as t}from"./app.14440598.js";const m='{"title":"Smart Generic C# / F# / VB.NET Service Client","description":"","frontmatter":{"slug":"grpc-generic","title":"Smart Generic C# / F# / VB.NET Service Client"},"headers":[{"level":2,"title":"C# Generic GrpcServiceClient TodoWorld Example","slug":"c-generic-grpcserviceclient-todoworld-example"},{"level":3,"title":"C# gRPC insecure Example","slug":"c-grpc-insecure-example"},{"level":3,"title":"C# gRPC SSL Example","slug":"c-grpc-ssl-example"},{"level":3,"title":"C# Local Development gRPC SSL CRUD Example","slug":"c-local-development-grpc-ssl-crud-example"},{"level":2,"title":"More Examples","slug":"more-examples"},{"level":2,"title":"VB.NET Generic GrpcServiceClient TodoWorld Example","slug":"vb-net-generic-grpcserviceclient-todoworld-example"},{"level":3,"title":"VB.NET gRPC insecure Example","slug":"vb-net-grpc-insecure-example"},{"level":3,"title":"VB.NET gRPC SSL Example","slug":"vb-net-grpc-ssl-example"},{"level":3,"title":"VB.NET Local Development gRPC SSL CRUD Example","slug":"vb-net-local-development-grpc-ssl-crud-example"},{"level":2,"title":"F# Generic GrpcServiceClient TodoWorld Example","slug":"f-generic-grpcserviceclient-todoworld-example"},{"level":3,"title":"F# gRPC insecure Example","slug":"f-grpc-insecure-example"},{"level":3,"title":"F# gRPC SSL Example","slug":"f-grpc-ssl-example"},{"level":3,"title":"F# Local Development gRPC SSL CRUD Example","slug":"f-local-development-grpc-ssl-crud-example"}],"relativePath":"grpc-generic.md","lastUpdated":1634495307618}',p={},e=t(`__VP_STATIC_START__<h2 id="c-generic-grpcserviceclient-todoworld-example" tabindex="-1">C# Generic GrpcServiceClient TodoWorld Example <a class="header-anchor" href="#c-generic-grpcserviceclient-todoworld-example" aria-hidden="true">#</a></h2><p><a href="https://youtu.be/K0QAUQPJNtM" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/grpc/csharp-generic.png" alt=""></a></p><div class="info custom-block"><p class="custom-block-title">YouTube</p><p><a href="https://youtu.be/K0QAUQPJNtM" target="_blank" rel="noopener noreferrer">youtu.be/K0QAUQPJNtM</a></p></div><p>Install <a href="/web-tool.html">x dotnet tool</a>:</p><div class="language-bash"><pre><code>$ dotnet tool <span class="token function">install</span> --global x 
</code></pre></div><p>Create a new C# App:</p><div class="language-bash"><pre><code>$ dotnet new console
</code></pre></div><p>Add <a href="https://www.nuget.org/packages/ServiceStack.GrpcClient" target="_blank" rel="noopener noreferrer">ServiceStack.GrpcClient</a> NuGet Package:</p><div class="language-bash"><pre><code>$ dotnet <span class="token function">add</span> package ServiceStack.GrpcClient
</code></pre></div><p>Add TodoWorld DTOs:</p><div class="language-bash"><pre><code>$ x csharp https://todoworld.servicestack.net
</code></pre></div><p>Use TodoWorld DTOs with generic <code>GrpcServiceClient</code> to call TodoWorld gRPC Service:</p><h3 id="c-grpc-insecure-example" tabindex="-1">C# gRPC insecure Example <a class="header-anchor" href="#c-grpc-insecure-example" aria-hidden="true">#</a></h3><div class="language-csharp"><pre><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">ServiceStack</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">TodoWorld<span class="token punctuation">.</span>ServiceModel</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">TodoWorld</span>
<span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            ProtoBuf<span class="token punctuation">.</span>Grpc<span class="token punctuation">.</span>Client<span class="token punctuation">.</span>GrpcClientFactory<span class="token punctuation">.</span>AllowUnencryptedHttp2 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcServiceClient</span><span class="token punctuation">(</span><span class="token string">&quot;http://todoworld.servicestack.net:5054&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Hello</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;gRPC C#&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>Result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Override <code>Program.cs</code> with the above C# Example:</p><div class="language-bash"><pre><code>$ x mix todoworld-cs
</code></pre></div><p>Run example:</p><div class="language-bash"><pre><code>$ dotnet run
</code></pre></div><h3 id="c-grpc-ssl-example" tabindex="-1">C# gRPC SSL Example <a class="header-anchor" href="#c-grpc-ssl-example" aria-hidden="true">#</a></h3><div class="language-csharp"><pre><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Cryptography<span class="token punctuation">.</span>X509Certificates</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">ServiceStack</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">TodoWorld<span class="token punctuation">.</span>ServiceModel</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">TodoWorld</span>
<span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcServiceClient</span><span class="token punctuation">(</span><span class="token string">&quot;https://todoworld.servicestack.net:50051&quot;</span><span class="token punctuation">,</span> 
                <span class="token keyword">new</span> <span class="token constructor-invocation class-name">X509Certificate2</span><span class="token punctuation">(</span><span class="token string">&quot;https://todoworld.servicestack.net/grpc.crt&quot;</span><span class="token punctuation">.</span><span class="token function">GetBytesFromUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                GrpcUtils<span class="token punctuation">.</span><span class="token function">AllowSelfSignedCertificatesFrom</span><span class="token punctuation">(</span><span class="token string">&quot;todoworld.servicestack.net&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Hello</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;gRPC C#&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>Result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Override <code>Program.cs</code> with the above C# Example:</p><div class="language-bash"><pre><code>$ x mix todoworld-cs-ssl
</code></pre></div><p>Run example:</p><div class="language-bash"><pre><code>$ dotnet run
</code></pre></div><h3 id="c-local-development-grpc-ssl-crud-example" tabindex="-1">C# Local Development gRPC SSL CRUD Example <a class="header-anchor" href="#c-local-development-grpc-ssl-crud-example" aria-hidden="true">#</a></h3><div class="language-csharp"><pre><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">ServiceStack</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">ServiceStack<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">TodoWorld<span class="token punctuation">.</span>ServiceModel</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">CSharpGeneric</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Certificate registration not required when using trusted local development certificate  </span>
            <span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GrpcServiceClient</span><span class="token punctuation">(</span><span class="token string">&quot;https://localhost:5001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">PostAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ResetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//POST /todos</span>
            <span class="token class-name"><span class="token keyword">var</span></span> todo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">PostAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">CreateTodo</span> <span class="token punctuation">{</span> Title <span class="token operator">=</span> <span class="token string">&quot;ServiceStack&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
            <span class="token interpolation-string"><span class="token string">$&quot;new todo Id: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">todo<span class="token punctuation">.</span>Id</span><span class="token punctuation">}</span></span><span class="token string">, Title: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">todo<span class="token punctuation">.</span>Title</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">//GET /todos</span>
            <span class="token class-name"><span class="token keyword">var</span></span> all <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token interpolation-string"><span class="token string">$&quot;todos: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">all<span class="token punctuation">.</span>Results<span class="token punctuation">?.</span>Count <span class="token operator">??</span> <span class="token number">0</span></span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//GET /todos/1</span>
            todo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetTodo</span> <span class="token punctuation">{</span> Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
            <span class="token interpolation-string"><span class="token string">$&quot;get todo Id: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">todo<span class="token punctuation">.</span>Id</span><span class="token punctuation">}</span></span><span class="token string">, Title: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">todo<span class="token punctuation">.</span>Title</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//GET /todos</span>
            all <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token interpolation-string"><span class="token string">$&quot;todos: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">all<span class="token punctuation">.</span>Results<span class="token punctuation">?.</span>Count <span class="token operator">??</span> <span class="token number">0</span></span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//PUT /todos/1</span>
            <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">PutAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">UpdateTodo</span> <span class="token punctuation">{</span> Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> Title <span class="token operator">=</span> <span class="token string">&quot;gRPC&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//GET /todos/1</span>
            todo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetTodo</span> <span class="token punctuation">{</span> Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
            <span class="token interpolation-string"><span class="token string">$&quot;updated todo Title: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">todo<span class="token punctuation">.</span>Title</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//DELETE /todos/1</span>
            <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">DeleteAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">DeleteTodo</span> <span class="token punctuation">{</span> Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//GET /todos</span>
            all <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token interpolation-string"><span class="token string">$&quot;todos: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">all<span class="token punctuation">.</span>Results<span class="token punctuation">?.</span>Count <span class="token operator">??</span> <span class="token number">0</span></span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Refer to <a href="https://github.com/NetCoreApps/todo-world/tree/master/src/clients/csharp-generic" target="_blank" rel="noopener noreferrer">/src/clients/csharp-generic</a> for a complete example project.</p><h2 id="more-examples" tabindex="-1">More Examples <a class="header-anchor" href="#more-examples" aria-hidden="true">#</a></h2><p>For more C# <code>GrpcServiceClient</code> examples check out the integration tests at:</p><ul><li><a href="https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.Extensions.Tests/GrpcTests.cs" target="_blank" rel="noopener noreferrer">GrpcTests.cs</a></li><li><a href="https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.Extensions.Tests/GrpcTodoTests.cs" target="_blank" rel="noopener noreferrer">GrpcTodoTests.cs</a></li><li><a href="https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.Extensions.Tests/GrpcAuthTests.cs" target="_blank" rel="noopener noreferrer">GrpcAuthTests.cs</a></li><li><a href="https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.Extensions.Tests/GrpcAutoQueryTests.cs" target="_blank" rel="noopener noreferrer">GrpcAutoQueryTests.cs</a></li><li><a href="https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.Extensions.Tests/GrpcServerEventsTests.cs" target="_blank" rel="noopener noreferrer">GrpcServerEventsTests.cs</a></li></ul><h2 id="vb-net-generic-grpcserviceclient-todoworld-example" tabindex="-1"><a href="http://VB.NET" target="_blank" rel="noopener noreferrer">VB.NET</a> Generic GrpcServiceClient TodoWorld Example <a class="header-anchor" href="#vb-net-generic-grpcserviceclient-todoworld-example" aria-hidden="true">#</a></h2><p><a href="https://youtu.be/9XTy3eOdpHw" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/grpc/vb-generic.png" alt=""></a></p><div class="info custom-block"><p class="custom-block-title">YouTube</p><p><a href="https://youtu.be/9XTy3eOdpHw" target="_blank" rel="noopener noreferrer">youtu.be/9XTy3eOdpHw</a></p></div><p>Install <a href="https://docs.servicestack.net/dotnet-tool" target="_blank" rel="noopener noreferrer">x dotnet tool</a>:</p><div class="language-bash"><pre><code>$ dotnet tool <span class="token function">install</span> --global x 
</code></pre></div><p>Create a new <a href="http://VB.NET" target="_blank" rel="noopener noreferrer">VB.NET</a> App:</p><div class="language-bash"><pre><code>$ dotnet new console -lang vb
</code></pre></div><p>Add <a href="https://www.nuget.org/packages/ServiceStack.GrpcClient" target="_blank" rel="noopener noreferrer">ServiceStack.GrpcClient</a> NuGet Package:</p><div class="language-bash"><pre><code>$ dotnet <span class="token function">add</span> package ServiceStack.GrpcClient
</code></pre></div><p>Add TodoWorld DTOs:</p><div class="language-bash"><pre><code>$ x vb https://todoworld.servicestack.net
</code></pre></div><p>Use TodoWorld DTOs with generic <code>GrpcServiceClient</code> to call TodoWorld gRPC Service:</p><h3 id="vb-net-grpc-insecure-example" tabindex="-1"><a href="http://VB.NET" target="_blank" rel="noopener noreferrer">VB.NET</a> gRPC insecure Example <a class="header-anchor" href="#vb-net-grpc-insecure-example" aria-hidden="true">#</a></h3><div class="language-vb"><pre><code><span class="token keyword">Imports</span> System
<span class="token keyword">Imports</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic
<span class="token keyword">Imports</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks
<span class="token keyword">Imports</span> ServiceStack
<span class="token keyword">Imports</span> TodoWorld<span class="token punctuation">.</span>ServiceModel

<span class="token keyword">Module</span> Program

    Async <span class="token keyword">Function</span> Todo<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Task
        ProtoBuf<span class="token punctuation">.</span>Grpc<span class="token punctuation">.</span>Client<span class="token punctuation">.</span>GrpcClientFactory<span class="token punctuation">.</span>AllowUnencryptedHttp2 <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token keyword">Dim</span> client <span class="token operator">=</span> <span class="token keyword">new</span> GrpcServiceClient<span class="token punctuation">(</span><span class="token string">&quot;http://todoworld.servicestack.net:5054&quot;</span><span class="token punctuation">)</span>
        
        <span class="token keyword">Dim</span> response <span class="token operator">=</span> Await client<span class="token punctuation">.</span>GetAsync<span class="token punctuation">(</span><span class="token keyword">New</span> Hello <span class="token keyword">With</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;gRPC VB.NET&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

        Console<span class="token punctuation">.</span>WriteLine<span class="token punctuation">(</span>response<span class="token punctuation">.</span>Result<span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">Function</span>

    <span class="token keyword">Sub</span> Main<span class="token punctuation">(</span>args <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        Task<span class="token punctuation">.</span>WaitAll<span class="token punctuation">(</span>Todo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">End</span> <span class="token keyword">Module</span>
</code></pre></div><p>Override <code>Program.vb</code> with the above <a href="http://VB.NET" target="_blank" rel="noopener noreferrer">VB.NET</a> Example:</p><div class="language-bash"><pre><code>$ x mix todoworld-vb
</code></pre></div><p>Run example:</p><div class="language-bash"><pre><code>$ dotnet run
</code></pre></div><h3 id="vb-net-grpc-ssl-example" tabindex="-1"><a href="http://VB.NET" target="_blank" rel="noopener noreferrer">VB.NET</a> gRPC SSL Example <a class="header-anchor" href="#vb-net-grpc-ssl-example" aria-hidden="true">#</a></h3><div class="language-vb"><pre><code><span class="token keyword">Imports</span> System
<span class="token keyword">Imports</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic
<span class="token keyword">Imports</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks
<span class="token keyword">Imports</span> System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Cryptography<span class="token punctuation">.</span>X509Certificates
<span class="token keyword">Imports</span> ServiceStack
<span class="token keyword">Imports</span> TodoWorld<span class="token punctuation">.</span>ServiceModel

<span class="token keyword">Module</span> Program

    Async <span class="token keyword">Function</span> Todo<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Task
        <span class="token keyword">Dim</span> client <span class="token operator">=</span> <span class="token keyword">new</span> GrpcServiceClient<span class="token punctuation">(</span><span class="token string">&quot;https://todoworld.servicestack.net:50051&quot;</span><span class="token punctuation">,</span> 
                <span class="token keyword">new</span> X509Certificate2<span class="token punctuation">(</span><span class="token string">&quot;https://todoworld.servicestack.net/grpc.crt&quot;</span><span class="token punctuation">.</span>GetBytesFromUrl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                GrpcUtils<span class="token punctuation">.</span>AllowSelfSignedCertificatesFrom<span class="token punctuation">(</span><span class="token string">&quot;todoworld.servicestack.net&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token keyword">Dim</span> response <span class="token operator">=</span> Await client<span class="token punctuation">.</span>GetAsync<span class="token punctuation">(</span><span class="token keyword">New</span> Hello <span class="token keyword">With</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;gRPC VB.NET&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

        Console<span class="token punctuation">.</span>WriteLine<span class="token punctuation">(</span>response<span class="token punctuation">.</span>Result<span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">Function</span>

    <span class="token keyword">Sub</span> Main<span class="token punctuation">(</span>args <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        Task<span class="token punctuation">.</span>WaitAll<span class="token punctuation">(</span>Todo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">End</span> <span class="token keyword">Module</span>
</code></pre></div><p>Override <code>Program.vb</code> with the above <a href="http://VB.NET" target="_blank" rel="noopener noreferrer">VB.NET</a> Example:</p><div class="language-bash"><pre><code>$ x mix todoworld-vb-ssl
</code></pre></div><p>Run example:</p><div class="language-bash"><pre><code>$ dotnet run
</code></pre></div><h3 id="vb-net-local-development-grpc-ssl-crud-example" tabindex="-1"><a href="http://VB.NET" target="_blank" rel="noopener noreferrer">VB.NET</a> Local Development gRPC SSL CRUD Example <a class="header-anchor" href="#vb-net-local-development-grpc-ssl-crud-example" aria-hidden="true">#</a></h3><div class="language-vb"><pre><code><span class="token keyword">Imports</span> System
<span class="token keyword">Imports</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic
<span class="token keyword">Imports</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks
<span class="token keyword">Imports</span> ServiceStack
<span class="token keyword">Imports</span> TodoWorld<span class="token punctuation">.</span>ServiceModel
<span class="token keyword">Imports</span> TodoWorld<span class="token punctuation">.</span>ServiceModel<span class="token punctuation">.</span>Types

<span class="token keyword">Module</span> Program
    <span class="token keyword">Function</span> SeqCount<span class="token punctuation">(</span>c <span class="token keyword">As</span> List<span class="token punctuation">(</span><span class="token keyword">Of</span> Todo<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Integer</span>
        <span class="token keyword">Return</span> <span class="token keyword">IF</span><span class="token punctuation">(</span>c <span class="token keyword">Is</span> <span class="token boolean">Nothing</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>Count<span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">Function</span>
    
    Async <span class="token keyword">Function</span> TodoExample<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> Task
        <span class="token comment">&#39; Certificate registration not required when using trusted local development certificate  </span>
        <span class="token keyword">Dim</span> client <span class="token operator">=</span> <span class="token keyword">new</span> GrpcServiceClient<span class="token punctuation">(</span><span class="token string">&quot;https://localhost:5001&quot;</span><span class="token punctuation">)</span>
        Await client<span class="token punctuation">.</span>PostAsync<span class="token punctuation">(</span><span class="token keyword">New</span> ResetTodos<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">&#39;GET /todos</span>
        <span class="token keyword">Dim</span> all <span class="token operator">=</span> Await client<span class="token punctuation">.</span>GetAsync<span class="token punctuation">(</span><span class="token keyword">New</span> GetTodos<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        Console<span class="token punctuation">.</span>WriteLine<span class="token punctuation">(</span><span class="token string">$&quot;todos: {SeqCount(all.Results)}&quot;</span><span class="token punctuation">)</span>

        <span class="token comment">&#39;POST /todos</span>
        <span class="token keyword">Dim</span> todo <span class="token keyword">As</span> Todo <span class="token operator">=</span> <span class="token punctuation">(</span>Await client<span class="token punctuation">.</span>PostAsync<span class="token punctuation">(</span><span class="token keyword">New</span> CreateTodo <span class="token keyword">With</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>Title <span class="token operator">=</span> <span class="token string">&quot;ServiceStack&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result
        Console<span class="token punctuation">.</span>WriteLine<span class="token punctuation">(</span><span class="token string">$&quot;new todo Id: {todo.Id}, Title: {todo.Title}&quot;</span><span class="token punctuation">)</span>
            
        <span class="token comment">&#39;GET /todos/1</span>
        todo <span class="token operator">=</span> <span class="token punctuation">(</span>Await client<span class="token punctuation">.</span>GetAsync<span class="token punctuation">(</span><span class="token keyword">New</span> GetTodo <span class="token keyword">With</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result
        Console<span class="token punctuation">.</span>WriteLine<span class="token punctuation">(</span><span class="token string">$&quot;get todo Id: {todo.Id}, Title: {todo.Title}&quot;</span><span class="token punctuation">)</span>

        <span class="token comment">&#39;GET /todos</span>
        all <span class="token operator">=</span> await client<span class="token punctuation">.</span>GetAsync<span class="token punctuation">(</span><span class="token keyword">new</span> GetTodos<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        Console<span class="token punctuation">.</span>WriteLine<span class="token punctuation">(</span><span class="token string">$&quot;todos: {SeqCount(all.Results)}&quot;</span><span class="token punctuation">)</span>

        <span class="token comment">&#39;PUT /todos/1</span>
        Await client<span class="token punctuation">.</span>PutAsync<span class="token punctuation">(</span><span class="token keyword">New</span> UpdateTodo <span class="token keyword">With</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> <span class="token punctuation">.</span>Title <span class="token operator">=</span> <span class="token string">&quot;gRPC&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token comment">&#39;GET /todos/1</span>
        todo <span class="token operator">=</span> <span class="token punctuation">(</span>Await client<span class="token punctuation">.</span>GetAsync<span class="token punctuation">(</span><span class="token keyword">New</span> GetTodo <span class="token keyword">With</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result
        Console<span class="token punctuation">.</span>WriteLine<span class="token punctuation">(</span><span class="token string">&quot;updated todo Title: {todo.Title}&quot;</span><span class="token punctuation">)</span>

        <span class="token comment">&#39;DELETE /todos/1</span>
        Await client<span class="token punctuation">.</span>DeleteAsync<span class="token punctuation">(</span><span class="token keyword">new</span> DeleteTodo <span class="token keyword">With</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token comment">&#39;GET /todos</span>
        all <span class="token operator">=</span> Await client<span class="token punctuation">.</span>GetAsync<span class="token punctuation">(</span><span class="token keyword">new</span> GetTodos<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        Console<span class="token punctuation">.</span>WriteLine<span class="token punctuation">(</span><span class="token string">$&quot;todos: {SeqCount(all.Results)}&quot;</span><span class="token punctuation">)</span>
        
    <span class="token keyword">End</span> <span class="token keyword">Function</span>
    
    <span class="token keyword">Sub</span> Main<span class="token punctuation">(</span>args <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        Task<span class="token punctuation">.</span>WaitAll<span class="token punctuation">(</span>TodoExample<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">Sub</span>
    
<span class="token keyword">End</span> <span class="token keyword">Module</span>
</code></pre></div><p>Refer to <a href="https://github.com/NetCoreApps/todo-world/tree/master/src/clients/vb-generic" target="_blank" rel="noopener noreferrer">/src/clients/vb-generic</a> for a complete example project.</p><h2 id="f-generic-grpcserviceclient-todoworld-example" tabindex="-1">F# Generic GrpcServiceClient TodoWorld Example <a class="header-anchor" href="#f-generic-grpcserviceclient-todoworld-example" aria-hidden="true">#</a></h2><p><a href="https://youtu.be/y3MBaapcN-0" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/grpc/fsharp-generic.png" alt=""></a></p><div class="info custom-block"><p class="custom-block-title">YouTube</p><p><a href="https://youtu.be/y3MBaapcN-0" target="_blank" rel="noopener noreferrer">youtu.be/y3MBaapcN-0</a></p></div><p>Install <a href="https://docs.servicestack.net/dotnet-tool" target="_blank" rel="noopener noreferrer">x dotnet tool</a>:</p><div class="language-bash"><pre><code>$ dotnet tool <span class="token function">install</span> --global x
</code></pre></div><p>Create a new F# App:</p><div class="language-bash"><pre><code>$ dotnet new console -lang f<span class="token comment">#</span>
\`\`<span class="token variable"><span class="token variable">\`</span><span class="token function">bash</span>


Add <span class="token punctuation">[</span>ServiceStack.GrpcClient<span class="token punctuation">]</span><span class="token punctuation">(</span>https://www.nuget.org/packages/ServiceStack.GrpcClient<span class="token punctuation">)</span> NuGet Package:

<span class="token variable">\`</span></span>\`\`bash
$ dotnet <span class="token function">add</span> package ServiceStack.GrpcClient
</code></pre></div><p>Add <a href="https://www.nuget.org/packages/TaskBuilder.fs" target="_blank" rel="noopener noreferrer">TaskBuilder.fs</a> NuGet Package</p><div class="language-bash"><pre><code>$ dotnet <span class="token function">add</span> package TaskBuilder.fs
</code></pre></div><p>Add TodoWorld DTOs:</p><div class="language-bash"><pre><code>$ x fsharp https://todoworld.servicestack.net
</code></pre></div><p>Register <code>dto.fs</code> source file to <code>*.fsproj</code>:</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ItemGroup</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Compile</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dtos.fs<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Compile</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Program.fs<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ItemGroup</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Use TodoWorld DTOs with generic <code>GrpcServiceClient</code> to call TodoWorld gRPC Service:</p><h3 id="f-grpc-insecure-example" tabindex="-1">F# gRPC insecure Example <a class="header-anchor" href="#f-grpc-insecure-example" aria-hidden="true">#</a></h3><div class="language-fsharp"><pre><code><span class="token keyword">open</span> System
<span class="token keyword">open</span> System<span class="token punctuation">.</span>Threading
<span class="token keyword">open</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks
<span class="token keyword">open</span> ServiceStack
<span class="token keyword">open</span> TodoWorld<span class="token punctuation">.</span>ServiceModel
<span class="token keyword">open</span> FSharp<span class="token punctuation">.</span>Control<span class="token punctuation">.</span>Tasks<span class="token punctuation">.</span>V2

<span class="token keyword">let</span> todo <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> 
    <span class="token computation-expression keyword">task</span> <span class="token punctuation">{</span>
        ProtoBuf<span class="token punctuation">.</span>Grpc<span class="token punctuation">.</span>Client<span class="token punctuation">.</span>GrpcClientFactory<span class="token punctuation">.</span>AllowUnencryptedHttp2 <span class="token operator">=</span> <span class="token keyword">true</span>
        <span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GrpcServiceClient</span><span class="token punctuation">(</span><span class="token string">&quot;http://todoworld.servicestack.net:5054&quot;</span><span class="token punctuation">)</span>
        
        <span class="token keyword">let!</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Hello</span><span class="token punctuation">(</span>Name <span class="token operator">=</span> <span class="token string">&quot;gRPC F#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        printfn <span class="token string">&quot;%s&quot;</span> response<span class="token punctuation">.</span>Result
    <span class="token punctuation">}</span>

<span class="token annotation"><span class="token punctuation">[&lt;</span><span class="token class-name">EntryPoint</span><span class="token punctuation">&gt;]</span></span>
<span class="token keyword">let</span> main argv <span class="token operator">=</span>
    <span class="token function">todo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token number">0</span>
</code></pre></div><p>Override <code>Program.fs</code> with the above F# Example:</p><pre><code>$ x mix todoworld-fs
</code></pre><p>Run example:</p><pre><code>$ dotnet run
</code></pre><h3 id="f-grpc-ssl-example" tabindex="-1">F# gRPC SSL Example <a class="header-anchor" href="#f-grpc-ssl-example" aria-hidden="true">#</a></h3><div class="language-fsharp"><pre><code><span class="token keyword">open</span> System
<span class="token keyword">open</span> System<span class="token punctuation">.</span>Threading
<span class="token keyword">open</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks
<span class="token keyword">open</span> System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Cryptography<span class="token punctuation">.</span>X509Certificates
<span class="token keyword">open</span> ServiceStack
<span class="token keyword">open</span> TodoWorld<span class="token punctuation">.</span>ServiceModel
<span class="token keyword">open</span> FSharp<span class="token punctuation">.</span>Control<span class="token punctuation">.</span>Tasks<span class="token punctuation">.</span>V2

<span class="token keyword">let</span> todo <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> 
    <span class="token computation-expression keyword">task</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GrpcServiceClient</span><span class="token punctuation">(</span><span class="token string">&quot;https://todoworld.servicestack.net:50051&quot;</span><span class="token punctuation">,</span> 
                <span class="token keyword">new</span> <span class="token class-name">X509Certificate2</span><span class="token punctuation">(</span><span class="token string">&quot;https://todoworld.servicestack.net/grpc.crt&quot;</span><span class="token punctuation">.</span><span class="token function">GetBytesFromUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                GrpcUtils<span class="token punctuation">.</span><span class="token function">AllowSelfSignedCertificatesFrom</span><span class="token punctuation">(</span><span class="token string">&quot;todoworld.servicestack.net&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token keyword">let!</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Hello</span><span class="token punctuation">(</span>Name <span class="token operator">=</span> <span class="token string">&quot;gRPC F#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        printfn <span class="token string">&quot;%s&quot;</span> response<span class="token punctuation">.</span>Result
    <span class="token punctuation">}</span>

<span class="token annotation"><span class="token punctuation">[&lt;</span><span class="token class-name">EntryPoint</span><span class="token punctuation">&gt;]</span></span>
<span class="token keyword">let</span> main argv <span class="token operator">=</span>
    <span class="token function">todo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token number">0</span>
</code></pre></div><p>Override <code>Program.fs</code> with the above F# Example:</p><div class="language-bash"><pre><code>$ x mix todoworld-fs-ssl
</code></pre></div><p>Run example:</p><div class="language-bash"><pre><code>$ dotnet run
</code></pre></div><h3 id="f-local-development-grpc-ssl-crud-example" tabindex="-1">F# Local Development gRPC SSL CRUD Example <a class="header-anchor" href="#f-local-development-grpc-ssl-crud-example" aria-hidden="true">#</a></h3><div class="language-fsharp"><pre><code><span class="token keyword">open</span> System
<span class="token keyword">open</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic
<span class="token keyword">open</span> System<span class="token punctuation">.</span>Threading
<span class="token keyword">open</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks
<span class="token keyword">open</span> ServiceStack
<span class="token keyword">open</span> TodoWorld<span class="token punctuation">.</span>ServiceModel
<span class="token keyword">open</span> FSharp<span class="token punctuation">.</span>Control<span class="token punctuation">.</span>Tasks<span class="token punctuation">.</span>V2

<span class="token keyword">let</span> todo <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> 
    <span class="token keyword">let</span> seqCount <span class="token punctuation">(</span>c<span class="token punctuation">:</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>Todo<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">if</span> c <span class="token operator">&lt;&gt;</span> <span class="token keyword">null</span> <span class="token keyword">then</span> c<span class="token punctuation">.</span>Count <span class="token keyword">else</span> <span class="token number">0</span>    
    <span class="token computation-expression keyword">task</span> <span class="token punctuation">{</span>
        <span class="token comment">// Certificate registration not required when using trusted local development certificate  </span>
        <span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GrpcServiceClient</span><span class="token punctuation">(</span><span class="token string">&quot;https://localhost:5001&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">do</span><span class="token operator">!</span> client<span class="token punctuation">.</span><span class="token function">PostAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ResetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">//POST /todos</span>
        <span class="token keyword">let!</span> t <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">PostAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CreateTodo</span><span class="token punctuation">(</span>Title <span class="token operator">=</span> <span class="token string">&quot;ServiceStack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> todo <span class="token operator">=</span> t<span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
        printfn <span class="token string">&quot;new todo Id: %i, Title: %s&quot;</span> todo<span class="token punctuation">.</span>Id todo<span class="token punctuation">.</span>Title

        <span class="token comment">//GET /todos</span>
        <span class="token keyword">let!</span> all <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        printfn <span class="token string">&quot;todos: %i&quot;</span> <span class="token punctuation">(</span>seqCount all<span class="token punctuation">.</span>Results<span class="token punctuation">)</span>
        
        <span class="token comment">//GET /todos/1</span>
        <span class="token keyword">let!</span> t <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetTodo</span><span class="token punctuation">(</span>Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> todo <span class="token operator">=</span> t<span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
        printfn <span class="token string">&quot;get todo Id: %i, Title: %s&quot;</span> todo<span class="token punctuation">.</span>Id todo<span class="token punctuation">.</span>Title

        <span class="token comment">//GET /todos</span>
        <span class="token keyword">let!</span> all <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        printfn <span class="token string">&quot;todos: %i&quot;</span> <span class="token punctuation">(</span>seqCount all<span class="token punctuation">.</span>Results<span class="token punctuation">)</span>
        
        <span class="token comment">//PUT /todos/1</span>
        <span class="token keyword">do</span><span class="token operator">!</span> client<span class="token punctuation">.</span><span class="token function">PutAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UpdateTodo</span><span class="token punctuation">(</span>Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> Title <span class="token operator">=</span> <span class="token string">&quot;gRPC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">//GET /todos/1</span>
        <span class="token keyword">let!</span> t <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetTodo</span><span class="token punctuation">(</span>Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> todo <span class="token operator">=</span> t<span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
        printfn <span class="token string">&quot;updated todo Title: %s&quot;</span> todo<span class="token punctuation">.</span>Title

        <span class="token comment">//DELETE /todos/1</span>
        <span class="token keyword">do</span><span class="token operator">!</span> client<span class="token punctuation">.</span><span class="token function">DeleteAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeleteTodo</span><span class="token punctuation">(</span>Id <span class="token operator">=</span> todo<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">//GET /todos</span>
        <span class="token keyword">let!</span> all <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        printfn <span class="token string">&quot;todos: %i&quot;</span> <span class="token punctuation">(</span>seqCount all<span class="token punctuation">.</span>Results<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token annotation"><span class="token punctuation">[&lt;</span><span class="token class-name">EntryPoint</span><span class="token punctuation">&gt;]</span></span>
<span class="token keyword">let</span> main argv <span class="token operator">=</span>
    <span class="token function">todo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token number">0</span>
</code></pre></div><p>Refer to <a href="https://github.com/NetCoreApps/todo-world/tree/master/src/clients/fsharp-generic" target="_blank" rel="noopener noreferrer">/src/clients/fsharp-generic</a> for a complete example project.</p>__VP_STATIC_END__`,86),o=[e];function c(l,u,k,r,i,d){return a(),s("div",null,o)}var w=n(p,[["render",c]]);export{m as __pageData,w as default};
